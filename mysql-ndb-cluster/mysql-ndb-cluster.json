{"status":{},"spec":{"description":"MySQL NDB distributed database cluster","resources":{"client_attrs":{"None":{"y":600,"x":500},"6a4e617b_deployment_cloned_1":{"y":185,"x":-171},"6a4e617b_deployment":{"y":204,"x":197},"6a4e617b_deployment_cloned_1_cloned_1":{"y":-261,"x":26},"6a4e617b_deployment_cloned_1_cloned_2":{"y":-177,"x":-336}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Management"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ConfigureBaseManageServer"},{"kind":"app_task","name":"InstallMySQLOnManagementServer"}],"name":"6a1654d7_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"ConfigureBaseManageServer"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"InstallMySQLOnManagementServer"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Management"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ConfigureBaseManageServer","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# set the VM's hostname\nsudo hostnamectl set-hostname @@{MANAGEMENT_HOSTNAME}@@\n\n# make sure all packages are upgraded to the latest versions\nsudo yum -y update\nsudo yum -y upgrade\n\n# install some useful packages\nsudo yum -y install vim bash-completion net-tools bind-utils wget\n\n# remove the firewall\n# this isn't recommended in production but is not required for a demo environment\nsudo yum -y remove firewalld","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Management"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"InstallMySQLOnManagementServer","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# download and extract the MySQL installation files\ncd ~\nwget http:\/\/dev.mysql.com\/get\/Downloads\/MySQL-Cluster-7.4\/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\ntar -xvf MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\n\n# configure required packages and make sure no MariaDB packages are left installed\nsudo yum -y install perl-Data-Dumper\nsudo yum -y remove mariadb-libs\n\n# install the required MySQL packages\n# these are part of the .tar file downloaded earlier\ncd ~\nrpm -Uvh MySQL-Cluster-client-gpl-7.4.10-1.el7.x86_64.rpm\nrpm -Uvh MySQL-Cluster-server-gpl-7.4.10-1.el7.x86_64.rpm\nrpm -Uvh MySQL-Cluster-shared-gpl-7.4.10-1.el7.x86_64.rpm\n\n# create the MySQL directory structure\nsudo mkdir -p \/var\/lib\/mysql-cluster\ncd \/var\/lib\/mysql-cluster\n\n# at this point the base VM is created and MySQL is installed but we haven't configured anything\n# this will be done in a later step, after the SQL and data nodes have been deployed","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"27c1d51a_runbook","main_task_local_reference":{"kind":"app_task","name":"6a1654d7_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Management"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"189ced94_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"82b6ef7e_runbook","main_task_local_reference":{"kind":"app_task","name":"189ced94_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Management"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"CreateManagerConfig"},{"kind":"app_task","name":"StartManager"}],"name":"2a3ca2f8_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"CreateManagerConfig"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"StartManager"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Management"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CreateManagerConfig","attrs":{"exit_status":[],"script":"# create the basic configuration file\necho \"[ndb_mgmd default]\n# Directory for MGM node log files\nDataDir=\/var\/lib\/mysql-cluster\n \n[ndb_mgmd]\nHostName=@@{address}@@\n \n[ndbd default]\nNoOfReplicas=@@{NUMBER_OF_REPLICAS}@@\nDataMemory=256M\nIndexMemory=128M\n\n#Directory for Data Node\nDataDir=\/var\/lib\/mysql-cluster\n\" | sudo tee \/var\/lib\/mysql-cluster\/config.ini\n\n# grab an array of IP addresses for the SQL nodes\nsqlnodes=$(echo \"@@{SQLNodeSubstrate.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\n\n# grab an array of IP addresses for the data nodes\ndatanodes=$(echo \"@@{DataNodeSubstrate.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\n\nfor datanode in $datanodes\ndo\n   echo \"[ndbd]\nHostName=$datanode\n# the following 2 lines can be required for large data imports\n# for e.g. the 'employees' sample database available online\n# set to a reasonable setting for your environment\n#MaxNoOfConcurrentOperations=100000\n#MaxNoOfLocalOperations=110000\n\" | sudo tee -a \/var\/lib\/mysql-cluster\/config.ini\ndone\n\nfor sqlnode in $sqlnodes\ndo\n   echo \"[mysqld]\nHostName=$sqlnode\n\" | sudo tee -a \/var\/lib\/mysql-cluster\/config.ini\ndone","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Management"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"StartManager","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\nsudo \/usr\/sbin\/ndb_mgmd --config-file=\/var\/lib\/mysql-cluster\/config.ini --daemon\nsleep 30","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"81e4fd93_runbook","main_task_local_reference":{"kind":"app_task","name":"2a3ca2f8_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Management"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"df8ceb20_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"003cb897_runbook","main_task_local_reference":{"kind":"app_task","name":"df8ceb20_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Management"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3d1a4e20_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6cd931de_runbook","main_task_local_reference":{"kind":"app_task","name":"3d1a4e20_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"Management","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ConfigureBaseSQLNode"},{"kind":"app_task","name":"InstallMySQLOnSQLNode"}],"name":"6a1654d7_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"ConfigureBaseSQLNode"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"InstallMySQLOnSQLNode"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ConfigureBaseSQLNode","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# set the VM's hostname\nsudo hostnamectl set-hostname @@{SQL_NODE_HOSTNAME}@@-@@{calm_array_index}@@\n\n# make sure all packages are upgraded to the latest versions\nsudo yum -y update\nsudo yum -y upgrade\n\n# install some useful packages\nsudo yum -y install vim bash-completion net-tools bind-utils wget\n\n# remove the firewall\n# this isn't recommended in production but is not required for a demo environment\nsudo yum -y remove firewalld","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"InstallMySQLOnSQLNode","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# download and extract the MySQL installation files\ncd ~\nwget http:\/\/dev.mysql.com\/get\/Downloads\/MySQL-Cluster-7.4\/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\ntar -xvf MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\n\n# configure required packages and make sure no MariaDB packages are left installed\nsudo yum -y install perl-Data-Dumper\nsudo yum -y remove mariadb-libs\n\n# install the required MySQL packages\n# these are part of the .tar file downloaded earlier\ncd ~\nrpm -Uvh MySQL-Cluster-client-gpl-7.4.10-1.el7.x86_64.rpm\nrpm -Uvh MySQL-Cluster-server-gpl-7.4.10-1.el7.x86_64.rpm\nrpm -Uvh MySQL-Cluster-shared-gpl-7.4.10-1.el7.x86_64.rpm\n\necho \"[mysqld]\nndbcluster\nndb-connectstring=@@{Management.address}@@\ndefault_storage_engine=ndbcluster\n \n[mysql_cluster]\nndb-connectstring=@@{Management.address}@@\" | sudo tee \/etc\/my.cnf","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"27c1d51a_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"6a1654d7_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"189ced94_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"82b6ef7e_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"189ced94_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"StartMySQLOnSQLNode"},{"kind":"app_task","name":"SetRootPasswordOnSQLNode"},{"kind":"app_task","name":"CreateProxySQLMonitoringUser"},{"kind":"app_task","name":"AddMySQLAppUser"},{"kind":"app_task","name":"SetMySQLRemoteAccess"},{"kind":"app_task","name":"CreateAppDBAndTable"}],"name":"2a3ca2f8_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"StartMySQLOnSQLNode"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"SetRootPasswordOnSQLNode"}},{"from_task_reference":{"kind":"app_task","name":"SetRootPasswordOnSQLNode"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"CreateProxySQLMonitoringUser"}},{"from_task_reference":{"kind":"app_task","name":"CreateProxySQLMonitoringUser"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"AddMySQLAppUser"}},{"from_task_reference":{"kind":"app_task","name":"AddMySQLAppUser"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"SetMySQLRemoteAccess"}},{"from_task_reference":{"kind":"app_task","name":"SetMySQLRemoteAccess"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"CreateAppDBAndTable"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"StartMySQLOnSQLNode","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\nsudo \/usr\/share\/mysql\/mysql.server start\nsleep 30","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"SetRootPasswordOnSQLNode","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# set the MySQL password\n\/usr\/bin\/mysql --user=root --password=`cat ~\/.mysql_secret | awk '{ print $18; }'` --connect-expired-password <<-EOF\nSET PASSWORD = PASSWORD('@@{ROOT_PASSWORD}@@');\nFLUSH PRIVILEGES;\nEOF","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CreateProxySQLMonitoringUser","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n#\/usr\/bin\/mysql --user=root --password=@@{ROOT_PASSWORD}@@ <<-EOF\n#CREATE USER IF NOT EXISTS '@@{MONITORING_USERNAME}@@'@'%' IDENTIFIED BY '@@{MONITORING_PASSWORD}@@';\n#FLUSH PRIVILEGES;\n#EOF","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"AddMySQLAppUser","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n#\/usr\/bin\/mysql --user=root --password=@@{ROOT_PASSWORD}@@ <<-EOF\n#CREATE USER IF NOT EXISTS '@@{APP_DB_USERNAME}@@'@'%' IDENTIFIED BY '@@{APP_DB_PASSWORD}@@';\n#FLUSH PRIVILEGES;\n#EOF","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"SetMySQLRemoteAccess","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n\/usr\/bin\/mysql --user=root --password=@@{ROOT_PASSWORD}@@ <<-EOF\nDELETE FROM mysql.user WHERE User='root' AND Host NOT IN ('localhost', '127.0.0.1', '::1');\nDELETE FROM mysql.user WHERE User='@@{APP_DB_USERNAME}@@' AND Host NOT IN ('localhost', '127.0.0.1', '::1');\nDELETE FROM mysql.user WHERE User='@@{MONITORING_USERNAME}@@' AND Host NOT IN ('localhost', '127.0.0.1', '::1');\nDELETE FROM mysql.user WHERE User='';\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '@@{ROOT_PASSWORD}@@';\nGRANT ALL PRIVILEGES ON *.* TO '@@{APP_DB_USERNAME}@@'@'%' WITH GRANT OPTION;\nGRANT ALL PRIVILEGES ON *.* TO '@@{APP_DB_USERNAME}@@'@'%' IDENTIFIED BY '@@{APP_DB_PASSWORD}@@';\nGRANT SELECT on sys.* to '@@{MONITORING_USERNAME}@@'@'%';\nGRANT SELECT on sys.* to '@@{MONITORING_USERNAME}@@'@'%' IDENTIFIED BY '@@{MONITORING_PASSWORD}@@';\nFLUSH PRIVILEGES;\nEOF","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CreateAppDBAndTable","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# create the database specified at app launch\n\/usr\/bin\/mysql --user=@@{APP_DB_USERNAME}@@ --password=@@{APP_DB_PASSWORD}@@ --host=127.0.0.1 <<-EOF\nCREATE DATABASE IF NOT EXISTS @@{DATABASE_NAME}@@;\nGRANT ALL PRIVILEGES ON @@{DATABASE_NAME}@@ TO '@@{APP_DB_USERNAME}@@'@'%' IDENTIFIED BY '@@{APP_DB_PASSWORD}@@';\nFLUSH PRIVILEGES;\nEOF\nsleep 10\n\n# create the database specified at app launch\n\/usr\/bin\/mysql --user=@@{APP_DB_USERNAME}@@ --password=@@{APP_DB_PASSWORD}@@ --host=127.0.0.1 <<-EOF\nUSE @@{DATABASE_NAME}@@;\nCREATE TABLE @@{DATABASE_NAME}@@.people (id INT(11) auto_increment, first_name char(50) NOT NULL, last_name char(50) NOT NULL, PRIMARY KEY (id)) ENGINE=NDBCLUSTER;\nEOF\nsleep 10","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"81e4fd93_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"2a3ca2f8_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"df8ceb20_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"003cb897_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"df8ceb20_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"SQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3d1a4e20_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6cd931de_runbook_cloned_1","main_task_local_reference":{"kind":"app_task","name":"3d1a4e20_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"SQLNode","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"DataNode"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ConfigureBaseDataNode"},{"kind":"app_task","name":"InstallMySQLOnDataNode"}],"name":"6a1654d7_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"ConfigureBaseDataNode"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"InstallMySQLOnDataNode"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"DataNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ConfigureBaseDataNode","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# set the VM's hostname\nsudo hostnamectl set-hostname @@{DATA_NODE_HOSTNAME}@@-@@{calm_array_index}@@\n\n# make sure all packages are upgraded to the latest versions\nsudo yum -y update\nsudo yum -y upgrade\n\n# install some useful packages\nsudo yum -y install vim bash-completion net-tools bind-utils wget\n\n# remove the firewall\n# this isn't recommended in production but is not required for a demo environment\nsudo yum -y remove firewalld","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"DataNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"InstallMySQLOnDataNode","attrs":{"script":"#!\/bin\/sh\n\n# download and extract the MySQL installation files\ncd ~\nwget http:\/\/dev.mysql.com\/get\/Downloads\/MySQL-Cluster-7.4\/MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\ntar -xvf MySQL-Cluster-gpl-7.4.10-1.el7.x86_64.rpm-bundle.tar\n\n# configure required packages and make sure no MariaDB packages are left installed\nsudo yum -y install perl-Data-Dumper\nsudo yum -y remove mariadb-libs\n\n# install the required MySQL packages\n# these are part of the .tar file downloaded earlier\ncd ~\nrpm -Uvh MySQL-Cluster-client-gpl-7.4.10-1.el7.x86_64.rpm\nrpm -Uvh MySQL-Cluster-server-gpl-7.4.10-1.el7.x86_64.rpm\nrpm -Uvh MySQL-Cluster-shared-gpl-7.4.10-1.el7.x86_64.rpm\n\necho \"[mysqld]\nndbcluster\nndb-connectstring=@@{Management.address}@@\n \n[mysql_cluster]\nndb-connectstring=@@{Management.address}@@\" | sudo tee \/etc\/my.cnf\n\nsudo mkdir -p \/var\/lib\/mysql-cluster","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"27c1d51a_runbook_cloned_1_cloned_1","main_task_local_reference":{"kind":"app_task","name":"6a1654d7_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"DataNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"189ced94_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"82b6ef7e_runbook_cloned_1_cloned_1","main_task_local_reference":{"kind":"app_task","name":"189ced94_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"DataNode"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"StartMySQLOnDataNode"}],"name":"2a3ca2f8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"DataNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"StartMySQLOnDataNode","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\nsudo ndbd\nsleep 30","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"81e4fd93_runbook_cloned_1_cloned_1","main_task_local_reference":{"kind":"app_task","name":"2a3ca2f8_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"DataNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"df8ceb20_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"003cb897_runbook_cloned_1_cloned_1","main_task_local_reference":{"kind":"app_task","name":"df8ceb20_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"DataNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3d1a4e20_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6cd931de_runbook_cloned_1_cloned_1","main_task_local_reference":{"kind":"app_task","name":"3d1a4e20_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"DataNode","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"ProxySQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"ConfigureBaseProxySQLNode"},{"kind":"app_task","name":"InstallProxySQL"}],"name":"6a1654d7_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"ConfigureBaseProxySQLNode"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"InstallProxySQL"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"ProxySQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ConfigureBaseProxySQLNode","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# set the VM's hostname\nsudo hostnamectl set-hostname @@{PROXYSQL_HOSTNAME}@@-@@{calm_array_index}@@\n\n# make sure all packages are upgraded to the latest versions\nsudo yum -y update\nsudo yum -y upgrade\n\n# install some useful packages\nsudo yum -y install vim bash-completion net-tools bind-utils wget\n\n# remove the firewall\n# this isn't recommended in production but is not required for a demo environment\nsudo yum -y remove firewalld","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"ProxySQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"InstallProxySQL","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# install the Percona repository, required for ProxySQL install\nsudo yum -y install http:\/\/www.percona.com\/downloads\/percona-release\/redhat\/0.1-4\/percona-release-0.1-4.noarch.rpm\nsudo yum -y update\n\n# install ProxySQL\nsudo yum -y install proxysql\n\n# start ProxySQL\nsudo service proxysql start\n\n# install the MySQL client binaries\nsudo yum -y install mysql-client","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"27c1d51a_runbook_cloned_1_cloned_2","main_task_local_reference":{"kind":"app_task","name":"6a1654d7_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"ProxySQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"189ced94_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"82b6ef7e_runbook_cloned_1_cloned_2","main_task_local_reference":{"kind":"app_task","name":"189ced94_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"ProxySQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"SetProxySQLRootPassword"},{"kind":"app_task","name":"SetProxySQLMonitorUsername"},{"kind":"app_task","name":"AddMySQLNodesToPool"},{"kind":"app_task","name":"CreateProxySQLUser"}],"name":"2a3ca2f8_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"SetProxySQLRootPassword"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"SetProxySQLMonitorUsername"}},{"from_task_reference":{"kind":"app_task","name":"SetProxySQLMonitorUsername"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"AddMySQLNodesToPool"}},{"from_task_reference":{"kind":"app_task","name":"AddMySQLNodesToPool"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"CreateProxySQLUser"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"ProxySQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"SetProxySQLRootPassword","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# set the ProxySQL admin password\n\/usr\/bin\/mysql --user=admin --password=admin --host=127.0.0.1 --port=6032 --prompt='ProxySQLAdmin> ' <<-EOF\nUPDATE global_variables SET variable_value='admin:@@{PROXYSQL_ADMIN_PASSWORD}@@' WHERE variable_name='admin-admin_credentials';\nLOAD ADMIN VARIABLES TO RUNTIME;\nSAVE ADMIN VARIABLES TO DISK;\nEOF\nsleep 10","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"ProxySQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"SetProxySQLMonitorUsername","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# set the username that will be used when monitoring nodes in the pool\n\/usr\/bin\/mysql --user=admin --password=@@{PROXYSQL_ADMIN_PASSWORD}@@ --host=127.0.0.1 --port=6032 --prompt='ProxySQLAdmin> ' <<-EOF\nUPDATE global_variables SET variable_value='@@{MONITORING_USERNAME}@@' WHERE variable_name = 'mysql-monitor-username';\nLOAD ADMIN VARIABLES TO RUNTIME;\nSAVE ADMIN VARIABLES TO DISK;\nEOF\nsleep 10","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"ProxySQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"AddMySQLNodesToPool","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# tell ProxySQL which identifiers it should use for each state (host group)\n# 1 = offline\n# 2 = writer\n# 3 = reader\n# 4 = backup writer\n\/usr\/bin\/mysql --user=admin --password=@@{PROXYSQL_ADMIN_PASSWORD}@@ --host=127.0.0.1 --port=6032 --prompt='ProxySQLAdmin> ' <<-EOF\nINSERT INTO mysql_group_replication_hostgroups (writer_hostgroup, backup_writer_hostgroup, reader_hostgroup, offline_hostgroup, active, max_writers, writer_is_also_reader, max_transactions_behind) VALUES (2, 4, 3, 1, 1, @@{SQL_NODES}@@, 1, 100);\nLOAD MYSQL SERVERS TO RUNTIME;\nSAVE MYSQL SERVERS TO DISK;\nEOF\n\n# add our MySQL nodes to the pool\n# grab an array of IP addresses for the SQL nodes\nsqlnodes=$(echo \"@@{SQLNodeSubstrate.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\n\nfor sqlnode in $sqlnodes\ndo\n\/usr\/bin\/mysql --user=admin --password=@@{PROXYSQL_ADMIN_PASSWORD}@@ --host=127.0.0.1 --port=6032 --prompt='ProxySQLAdmin> ' <<-EOF\nINSERT INTO mysql_servers(hostgroup_id, hostname, port) VALUES (2, '$sqlnode', 3306);\nLOAD MYSQL SERVERS TO RUNTIME;\nSAVE MYSQL SERVERS TO DISK;\nEOF\nsleep 10\ndone","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"ProxySQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"CreateProxySQLUser","attrs":{"exit_status":[],"script":"#!\/bin\/sh\n\n# set the username that will be used when monitoring nodes in the pool\n\/usr\/bin\/mysql --user=admin --password=@@{PROXYSQL_ADMIN_PASSWORD}@@ --host=127.0.0.1 --port=6032 --prompt='ProxySQLAdmin> ' <<-EOF\nINSERT INTO mysql_users(username, password, default_hostgroup) VALUES ('@@{APP_DB_USERNAME}@@', '@@{APP_DB_PASSWORD}@@', 2);\nLOAD MYSQL USERS TO RUNTIME;\nSAVE MYSQL USERS TO DISK;\nEOF\nsleep 10","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"root"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"81e4fd93_runbook_cloned_1_cloned_2","main_task_local_reference":{"kind":"app_task","name":"2a3ca2f8_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"ProxySQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"df8ceb20_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"003cb897_runbook_cloned_1_cloned_2","main_task_local_reference":{"kind":"app_task","name":"df8ceb20_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"ProxySQLNode"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"3d1a4e20_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6cd931de_runbook_cloned_1_cloned_2","main_task_local_reference":{"kind":"app_task","name":"3d1a4e20_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"ProxySQLNode","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"AHV_VM","name":"ManagementSubstrate","readiness_probe":{"connection_type":"SSH","disable_readiness_probe":false,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"root"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{calm_application_name}@@-MySQL-NDB-Cluster-Management-VM","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"5cbccfaa-9277-4d7c-9d78-36f48f8982d0"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":null,"power_state":"ON","type":"","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS7-Base-Sept2018","uuid":"989fe412-3aea-4376-9da2-e7ea8eca5330"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"SQLNodeSubstrate","readiness_probe":{"connection_type":"SSH","disable_readiness_probe":false,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"root"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{calm_application_name}@@-MySQL-NDB-Cluster-SQLNode-VM","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"5cbccfaa-9277-4d7c-9d78-36f48f8982d0"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":null,"power_state":"ON","type":"","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS7-Base-Sept2018","uuid":"989fe412-3aea-4376-9da2-e7ea8eca5330"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"DataNodeSubstrate","readiness_probe":{"connection_type":"SSH","disable_readiness_probe":false,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"root"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{calm_application_name}@@-MySQL-NDB-Cluster-DataNode-VM-@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"5cbccfaa-9277-4d7c-9d78-36f48f8982d0"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":null,"power_state":"ON","type":"","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS7-Base-Sept2018","uuid":"989fe412-3aea-4376-9da2-e7ea8eca5330"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"ProxySQLNodeSubstrate","readiness_probe":{"connection_type":"SSH","disable_readiness_probe":false,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"0","connection_port":22,"login_credential_local_reference":{"kind":"app_credential","name":"root"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"@@{calm_application_name}@@-MySQL-NDB-Cluster-ProxySQL-VM","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"5cbccfaa-9277-4d7c-9d78-36f48f8982d0"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":null,"power_state":"ON","type":"","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"CentOS7-Base-Sept2018","uuid":"989fe412-3aea-4376-9da2-e7ea8eca5330"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"root","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"root"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Management"}],"name":"ManagementPackage","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"ManagementPackage"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"e02b9dba_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"aee71baa_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"e02b9dba_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"ManagementPackage"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"aef7a7b3_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a676b60f_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"aef7a7b3_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"SQLNode"}],"name":"SQLNodePackage","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"SQLNodePackage"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"e02b9dba_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"aee71baa_runbook_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"e02b9dba_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"SQLNodePackage"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"aef7a7b3_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a676b60f_runbook_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"aef7a7b3_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"DataNode"}],"name":"DataNodePackage","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"DataNodePackage"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"e02b9dba_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"aee71baa_runbook_cloned_1_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"e02b9dba_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"DataNodePackage"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"aef7a7b3_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a676b60f_runbook_cloned_1_cloned_1","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"aef7a7b3_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"ProxySQLNode"}],"name":"SQLNodePackage_cloned_1","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"SQLNodePackage_cloned_1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"e02b9dba_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"aee71baa_runbook_cloned_1_cloned_2","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"e02b9dba_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"SQLNodePackage_cloned_1"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"aef7a7b3_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a676b60f_runbook_cloned_1_cloned_2","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"aef7a7b3_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","description":"","action_list":[],"name":"6a4e617b_deployment","max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"ManagementPackage"}],"substrate_local_reference":{"kind":"app_substrate","name":"ManagementSubstrate"},"min_replicas":"1","variable_list":[]},{"type":"GREENFIELD","description":"","action_list":[],"editables":{"min_replicas":true,"max_replicas":true},"name":"6a4e617b_deployment_cloned_1","max_replicas":"2","package_local_reference_list":[{"kind":"app_package","name":"SQLNodePackage"}],"substrate_local_reference":{"kind":"app_substrate","name":"SQLNodeSubstrate"},"min_replicas":"2","variable_list":[]},{"type":"GREENFIELD","description":"","action_list":[],"editables":{"min_replicas":true,"max_replicas":true},"name":"6a4e617b_deployment_cloned_1_cloned_1","max_replicas":"2","package_local_reference_list":[{"kind":"app_package","name":"DataNodePackage"}],"substrate_local_reference":{"kind":"app_substrate","name":"DataNodeSubstrate"},"min_replicas":"2","variable_list":[]},{"type":"GREENFIELD","description":"","action_list":[],"name":"6a4e617b_deployment_cloned_1_cloned_2","max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"SQLNodePackage_cloned_1"}],"substrate_local_reference":{"kind":"app_substrate","name":"ProxySQLNodeSubstrate"},"min_replicas":"1","variable_list":[]}],"description":"","action_list":[],"name":"AHV","variable_list":[{"val_type":"STRING","description":"","name":"MANAGEMENT_HOSTNAME","type":"LOCAL","value":"MySQL-NDB-Manager","label":"","attrs":{"type":""},"editables":{"value":true}},{"val_type":"STRING","description":"","name":"SQL_NODE_HOSTNAME","type":"LOCAL","value":"MySQL-NDB-SQL","label":"","attrs":{"type":""},"editables":{"value":true}},{"val_type":"STRING","description":"","name":"DATA_NODE_HOSTNAME","type":"LOCAL","value":"MySQL-NDB-Data","label":"","attrs":{"type":""},"editables":{"value":true}},{"val_type":"STRING","description":"","name":"ROOT_PASSWORD","type":"SECRET","value":"","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true}},{"val_type":"STRING","description":"","name":"NUMBER_OF_REPLICAS","type":"LOCAL","value":"2","label":"","attrs":{"type":""}},{"val_type":"STRING","description":"","name":"SQL_NODES","type":"LOCAL","value":"2","label":"","attrs":{"type":""}},{"val_type":"STRING","description":"","name":"DATA_NODES","type":"LOCAL","value":"2","label":"","attrs":{"type":""}},{"val_type":"STRING","description":"","name":"DATABASE_NAME","type":"LOCAL","value":"appdb","label":"","attrs":{"type":""},"editables":{"value":true}},{"val_type":"STRING","description":"","name":"PROXYSQL_HOSTNAME","type":"LOCAL","value":"MySQL-NDB-ProxySQL","label":"","attrs":{"type":""},"editables":{"value":true}},{"val_type":"STRING","description":"","name":"PROXYSQL_ADMIN_PASSWORD","type":"SECRET","value":"","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true}},{"val_type":"STRING","description":"","name":"MONITORING_USERNAME","type":"LOCAL","value":"monitor","label":"","attrs":{"type":""},"editables":{"value":true}},{"val_type":"STRING","description":"","name":"MONITORING_PASSWORD","type":"SECRET","value":"","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true}},{"val_type":"STRING","description":"","name":"APP_DB_USERNAME","type":"LOCAL","value":"appuser","label":"","attrs":{"type":""},"editables":{"value":true}},{"val_type":"STRING","description":"","name":"APP_DB_PASSWORD","type":"SECRET","value":"","label":"","attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"editables":{"value":true}}]}],"default_credential_local_reference":{"kind":"app_credential","name":"root"},"type":"USER"},"name":"MySQL-NDB-Cluster-02"},"api_version":"3.0","metadata":{"last_update_time":"1536024834365721","kind":"blueprint","spec_version":7,"creation_time":"1530254872559577","name":"MySQL-NDB-Cluster-02"}}