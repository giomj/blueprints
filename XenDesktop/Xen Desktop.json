{"status": {"state": "ACTIVE", "message_list": [], "description": "", "resources": {"service_definition_list": [{"singleton": false, "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2", "action_list": [{"description": "System action for creating an application", "type": "system", "uuid": "dd41e73b-e3c4-4571-88d0-84b26a05a070", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "98f8161b_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "dbb8d109-ca7f-448b-a753-20b58d6fc3ca"}], "description": "", "name": "dade7481_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "98f8161b_dag", "uuid": "dbb8d109-ca7f-448b-a753-20b58d6fc3ca"}, "message_list": [], "variable_list": [], "uuid": "58135bbb-91b0-4e42-8f9d-8bdfb261eaad"}, "message_list": [], "name": "action_create"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "a51b6b4e-35ea-4903-b520-880a9e9301b4", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "02628fa5_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "b555b6dd-0bec-467f-b5c8-85194c4bcc52"}], "description": "", "name": "59afb4f4_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "02628fa5_dag", "uuid": "b555b6dd-0bec-467f-b5c8-85194c4bcc52"}, "message_list": [], "variable_list": [], "uuid": "ce606f1a-cd67-4456-8823-df98e0d20936"}, "message_list": [], "name": "action_delete"}, {"description": "System action for starting an application", "type": "system", "uuid": "e036cd29-4699-4929-aaa6-126aa78c6ab7", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "8e5f51b4_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "083023b8-2c24-41a0-9099-3c914cdf4268"}], "description": "", "name": "11876906_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "8e5f51b4_dag", "uuid": "083023b8-2c24-41a0-9099-3c914cdf4268"}, "message_list": [], "variable_list": [], "uuid": "e822e828-353d-4651-ad6a-f7d60355913a"}, "message_list": [], "name": "action_start"}, {"description": "System action for stopping an application", "type": "system", "uuid": "30476336-eb2a-4c94-ac30-378d8fa4996a", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "1a17e568_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "8124488f-b8ea-4da2-937f-0f8cc6e1666d"}], "description": "", "name": "d2728354_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "1a17e568_dag", "uuid": "8124488f-b8ea-4da2-937f-0f8cc6e1666d"}, "message_list": [], "variable_list": [], "uuid": "2227c943-6a01-4b4f-b5f9-d748009e7ff1"}, "message_list": [], "name": "action_stop"}, {"description": "System action for restarting an application", "type": "system", "uuid": "0931266f-00fe-491f-aa2e-b91ab0d8f81e", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "27dfdc04_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "f40ac025-240f-4f75-9aae-d736b8162bff"}], "description": "", "name": "4150545e_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "27dfdc04_dag", "uuid": "f40ac025-240f-4f75-9aae-d736b8162bff"}, "message_list": [], "variable_list": [], "uuid": "525f4db7-9369-478a-a1c9-99518e03e93e"}, "message_list": [], "name": "action_restart"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "466d3c41-9283-49aa-9a76-1f2c94830a8f", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Service_Element_Delete_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "994097bf-f5b6-43e9-857e-7b49519d5c29"}], "name": "SYS_GEN__DAG_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "717920da-c661-4e24-8e69-53feb02956c3"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Service_Element_Delete_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "994097bf-f5b6-43e9-857e-7b49519d5c29"}], "description": "", "name": "SYS_GEN__Runbook_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "717920da-c661-4e24-8e69-53feb02956c3"}, "message_list": [], "variable_list": [], "uuid": "0942c9ef-1ecf-4cca-bca2-be37bb12790a"}, "message_list": [], "name": "action_soft_delete"}], "depends_on_list": [], "name": "MSSQL", "state": "ACTIVE", "port_list": [], "editables": {}, "tier": "", "message_list": [], "variable_list": [{"val_type": "STRING", "description": "", "name": "EXECUTION_MODE", "type": "LOCAL", "value": "", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {}, "message_list": [], "uuid": "89f9cdb5-d4f9-475f-b17a-a8ac25d8b27a"}], "description": ""}, {"singleton": false, "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3", "action_list": [{"description": "System action for creating an application", "type": "system", "uuid": "20323e47-b7f0-4e56-8511-ebf7d210f138", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SiteCreation", "uuid": "e5fe84de-997b-47cb-9e05-140128cf2451"}, {"kind": "app_task", "name": "EnableLocalMode", "uuid": "d87a05ff-f264-4880-84f4-aca6764e4bbd"}, {"kind": "app_task", "name": "JoinRemainingNodes", "uuid": "7f17bffe-b51e-4817-869d-014f2fc889e7"}, {"kind": "app_task", "name": "DIsableLocalMode", "uuid": "504451d2-4cf8-48cd-9480-1931a9c903c6"}, {"kind": "app_task", "name": "CreateResources", "uuid": "da5badba-4c7d-48d6-abe9-60c366b10afe"}, {"kind": "app_task", "name": "GetFQDN", "uuid": "ee88d081-2ed6-41da-bb59-701b029348b0"}, {"kind": "app_task", "name": "EnableLocalMode1", "uuid": "7d7575b5-c8fd-0b49-59ee-a64feb328ec8"}, {"kind": "app_task", "name": "Post MSSQL tasks", "uuid": "2d2e8ac0-8b62-0ea7-1d37-add6bf8b82c3"}, {"kind": "app_task", "name": "CreateUsers", "uuid": "76e2daff-6441-accf-c9c2-64f3467b6d3b"}], "name": "aaa51f8e_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SiteCreation", "uuid": "e5fe84de-997b-47cb-9e05-140128cf2451"}, "edge_type": "user_defined", "type": "", "uuid": "fdab8b8f-613b-472c-a6b3-afecb6cc624f", "to_task_reference": {"kind": "app_task", "name": "EnableLocalMode", "uuid": "d87a05ff-f264-4880-84f4-aca6764e4bbd"}}, {"from_task_reference": {"kind": "app_task", "name": "EnableLocalMode", "uuid": "d87a05ff-f264-4880-84f4-aca6764e4bbd"}, "edge_type": "user_defined", "type": "", "uuid": "7d335efe-6020-42d0-bee9-fbc0d204a3dd", "to_task_reference": {"kind": "app_task", "name": "JoinRemainingNodes", "uuid": "7f17bffe-b51e-4817-869d-014f2fc889e7"}}, {"from_task_reference": {"kind": "app_task", "name": "JoinRemainingNodes", "uuid": "7f17bffe-b51e-4817-869d-014f2fc889e7"}, "edge_type": "user_defined", "type": "", "uuid": "8e085918-dbf3-4af3-b510-491f584b84e3", "to_task_reference": {"kind": "app_task", "name": "DIsableLocalMode", "uuid": "504451d2-4cf8-48cd-9480-1931a9c903c6"}}, {"from_task_reference": {"kind": "app_task", "name": "DIsableLocalMode", "uuid": "504451d2-4cf8-48cd-9480-1931a9c903c6"}, "edge_type": "user_defined", "type": "", "uuid": "8901fd94-ffb4-469e-9729-352cfc16eff6", "to_task_reference": {"kind": "app_task", "name": "CreateResources", "uuid": "da5badba-4c7d-48d6-abe9-60c366b10afe"}}, {"from_task_reference": {"kind": "app_task", "name": "CreateResources", "uuid": "da5badba-4c7d-48d6-abe9-60c366b10afe"}, "edge_type": "user_defined", "type": "", "uuid": "4f5d16b7-14e4-4c03-bf7e-a14e83ba1746", "to_task_reference": {"kind": "app_task", "name": "GetFQDN", "uuid": "ee88d081-2ed6-41da-bb59-701b029348b0"}}, {"from_task_reference": {"kind": "app_task", "name": "GetFQDN", "uuid": "ee88d081-2ed6-41da-bb59-701b029348b0"}, "edge_type": "user_defined", "type": "", "uuid": "b88f5997-c285-4c8e-cdaa-0d4ed1302d06", "to_task_reference": {"kind": "app_task", "name": "EnableLocalMode1", "uuid": "7d7575b5-c8fd-0b49-59ee-a64feb328ec8"}}, {"from_task_reference": {"kind": "app_task", "name": "EnableLocalMode1", "uuid": "7d7575b5-c8fd-0b49-59ee-a64feb328ec8"}, "edge_type": "user_defined", "type": "", "uuid": "684e7ae6-c769-dd20-4e7b-e8e8ab0876a9", "to_task_reference": {"kind": "app_task", "name": "Post MSSQL tasks", "uuid": "2d2e8ac0-8b62-0ea7-1d37-add6bf8b82c3"}}, {"from_task_reference": {"kind": "app_task", "name": "Post MSSQL tasks", "uuid": "2d2e8ac0-8b62-0ea7-1d37-add6bf8b82c3"}, "edge_type": "user_defined", "type": "", "uuid": "893325f2-b9e5-9893-5fde-ed26af17f177", "to_task_reference": {"kind": "app_task", "name": "CreateUsers", "uuid": "76e2daff-6441-accf-c9c2-64f3467b6d3b"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "57532d47-0cd6-4633-8794-5ead278ebcb6"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SiteCreation", "state": "NOT_VALIDATED", "attrs": {"script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n  echo exiting\n  exit\n}\necho \"@@{MSSQL.address}@@\"\n$DatabaseServer = \"@@{SQL_CLUSTER_NAME}@@\"\n$DatabaseName_Site = \"@@{XD_SITE_NAME}@@\" + \"_Site\"\n$DatabaseName_Logging = \"@@{XD_SITE_NAME}@@\" + \"_Logging\"\n$DatabaseName_Monitor = \"@@{XD_SITE_NAME}@@\" + \"_Monitor\"\n\n# Database user must be sysadmin on db server\n#$DatabaseUser = \"@@{SQL_CREDS.username}@@\"\n$DatabaseUser = \"sqlservice@nucalm.com\"\n$DatabasePassword = \"@@{SQL_CREDS.secret}@@\"\n\n$XD7Site = \"@@{XD_SITE_NAME}@@\"\n\n$DatabasePassword = $DatabasePassword | ConvertTo-SecureString -asPlainText -Force\n$Database_CredObject = New-Object System.Management.Automation.PSCredential($DatabaseUser,$DatabasePassword)\n\nAdd-PSSnapin Citrix.*\nNew-XDDatabase -AdminAddress $env:COMPUTERNAME -SiteName $XD7Site -DataStore Site -DatabaseServer $DatabaseServer -DatabaseName $DatabaseName_Site -DatabaseCredentials $Database_CredObject\nNew-XDDatabase -AdminAddress $env:COMPUTERNAME -SiteName $XD7Site -DataStore Logging -DatabaseServer $DatabaseServer -DatabaseName $DatabaseName_Logging -DatabaseCredentials $Database_CredObject\nNew-XDDatabase -AdminAddress $env:COMPUTERNAME -SiteName $XD7Site -DataStore Monitor -DatabaseServer $DatabaseServer -DatabaseName $DatabaseName_Monitor -DatabaseCredentials $Database_CredObject\n\nNew-XDSite -DatabaseServer $DatabaseServer -LoggingDatabaseName $DatabaseName_Logging -MonitorDatabaseName $DatabaseName_Monitor -SiteDatabaseName $DatabaseName_Site -SiteName $XD7Site -AdminAddress $env:COMPUTERNAME \n\nSet-XDLicensing -LicenseServerAddress $ENV:COMPUTERNAME -LicenseServerPort 27000\n$netbios = \"@@{DOMAIN}@@\".Split(\".\")[0].ToUpper()\n$FullAdminGroup = \"$netbios\\Domain Admins\"\n\nNew-AdminAdministrator -AdminAddress $env:COMPUTERNAME -Name $FullAdminGroup\nAdd-AdminRight -AdminAddress $env:COMPUTERNAME -Administrator $FullAdminGroup -Role 'Full Administrator' -All", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "e5fe84de-997b-47cb-9e05-140128cf2451"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "EnableLocalMode", "state": "NOT_VALIDATED", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=LOCAL\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "uuid": "d87a05ff-f264-4880-84f4-aca6764e4bbd"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "JoinRemainingNodes", "state": "NOT_VALIDATED", "attrs": {"exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -eq \"0\"){\n  echo \"exiting\"\n  exit\n}\n$script = {\n\t$DatabaseUser = \"@@{SQL_CREDS.username}@@\"\n\t$DatabasePassword = \"@@{SQL_CREDS.secret}@@\"\n    $DatabasePassword = $DatabasePassword | ConvertTo-SecureString -asPlainText -Force\n    $Database_CredObject = New-Object System.Management.Automation.PSCredential($DatabaseUser,$DatabasePassword)\n\n    Add-XDController -AdminAddress @@{address}@@ -SiteControllerAddress @@{calm_array_address[0]}@@ -DatabaseCredentials $Database_CredObject\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "7f17bffe-b51e-4817-869d-014f2fc889e7"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "DIsableLocalMode", "state": "NOT_VALIDATED", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "uuid": "504451d2-4cf8-48cd-9480-1931a9c903c6"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "CreateResources", "state": "NOT_VALIDATED", "attrs": {"exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n  exit\n}\n[string]$ConnectionName = \"NutanixAcropolis\"\n[string]$HostingUnitName = \"NutanixResources\"\n[string]$AHVIP = \"@@{PE_IP}@@\"\n[string]$Username = \"@@{PE_CREDS.username}@@\"\n[string]$Password = \"@@{PE_CREDS.secret}@@\"\n[string]$NetworkId = \"@@{CVM_NETWORK}@@\"\n[string]$ConnectionType = \"Custom\"\n[string]$PluginId = \"AcropolisFactory\"\n\n\n$ErrorActionPreference = \"Stop\"\nAdd-PSSnapin -Name Citrix.*\n\n$connection = Get-Item -Path \"xdhyp:\\Connections\\*\" | Where-Object {$_.PSChildName -eq $ConnectionName}\nif ($connection -eq $null) {\n\n   $connection = New-Item -Path \"xdhyp:\\Connections\" -Name $ConnectionName -ConnectionType $ConnectionType -PluginId $PluginId -HypervisorAddress $AHVIP -UserName $Username -Password $Password -Persist\n\n   New-BrokerHypervisorConnection -HypHypervisorConnectionUid $connection.HypervisorConnectionUid\n\n   $hupath = \"xdhyp:\\HostingUnits\\$HostingUnitName\"\n\n   $rootpath = \"$($connection | select -ExpandProperty FullPath)\" + '\\'\n\n   New-Item -Path $hupath -HypervisorConnectionName $ConnectionName -NetworkPath \"XDHyp:\\Connections\\Nutanix\\$($NetworkId).network\" -RootPath $rootpath\n\n} else {\n    Write-Output \"Connection $ConnectionName already exists\"\n}", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "DOMAIN_CRED", "uuid": "8b73012b-d702-4380-a533-71791b76c719"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "da5badba-4c7d-48d6-abe9-60c366b10afe"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "GetFQDN", "state": "NOT_VALIDATED", "attrs": {"exit_status": [], "script": "Write-Output \"FQDN=$env:computername.$env:userdnsdomain\"\nWrite-Output \"HOSTNAME=$env:computername\"", "eval_variables": ["FQDN", "HOSTNAME"], "eval_scope": "local", "script_type": "sh", "type": "", "login_credential_local_reference": {"kind": "app_credential", "name": "DOMAIN_CRED", "uuid": "8b73012b-d702-4380-a533-71791b76c719"}}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "uuid": "ee88d081-2ed6-41da-bb59-701b029348b0"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "EnableLocalMode1", "state": "NOT_VALIDATED", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=LOCAL\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "uuid": "7d7575b5-c8fd-0b49-59ee-a64feb328ec8"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Post MSSQL tasks", "state": "NOT_VALIDATED", "attrs": {"script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n  echo exiting\n  exit\n}\n\n$MSSQL_NODES = \"@@{MSSQL.address}@@\".Split(',')\n\n$script={\n\t\n  if (\"$(Get-ClusterNode | where {$_.Id -eq 1} | select -ExpandProperty Name)\" -ne \"$(hostname)\"){\n      exit\n  }\n  $AGName = '@@{SQL_CLUSTER_NAME}@@' # change listener name\n  $PrimaryNode = $(hostname)\n  $cname = (Get-Cluster -name $PrimaryNode).name\n  $nodes = (get-clusternode -Cluster $cname).name\n\n  New-Item -Path \"C:\\DbShare\" -ItemType \"directory\"\n  New-SmbShare -Name \"DbShare\" -Path \"C:\\DbShare\" -FullAccess \"Everyone\"\n\n  Import-Module SQLASCmdlets,Sqlps,SQLPS\n\n  foreach ($db in @(\"BLR_Site\",\"BLR_Monitor\",\"BLR_Logging\")){\n     Get-ChildItem -Path SQLSERVER:\\SQL\\$PrimaryNode\\DEFAULT\\Databases |\n     Where-Object Name -eq $db |\n     ForEach-Object {\n         $_.RecoveryModel = 'Full'\n         $_.Alter()\n         $_.Refresh()\n     }\n  }\n\n  Backup-SqlDatabase -Database \"BLR_Site\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Site.bak\" -ServerInstance \"$PrimaryNode\"\n  Backup-SqlDatabase -Database \"BLR_Monitor\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Monitor.bak\" -ServerInstance \"$PrimaryNode\"  \n  Backup-SqlDatabase -Database \"BLR_Logging\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Logging.bak\" -ServerInstance \"$PrimaryNode\"  \n\n  Backup-SqlDatabase -Database \"BLR_Site\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Site.log\" -ServerInstance \"$PrimaryNode\" -BackupAction Log \n  Backup-SqlDatabase -Database \"BLR_Monitor\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Monitor.log\" -ServerInstance \"$PrimaryNode\" -BackupAction Log \n  Backup-SqlDatabase -Database \"BLR_Logging\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Logging.log\" -ServerInstance \"$PrimaryNode\" -BackupAction Log \n\n  foreach($node in $nodes)\n  {\n     if ($node -ne $PrimaryNode){\n        Restore-SqlDatabase -Database \"BLR_Site\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Site.bak\" -ServerInstance \"$node\" -NoRecovery \n        Restore-SqlDatabase -Database \"BLR_Monitor\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Monitor.bak\" -ServerInstance \"$node\" -NoRecovery \n        Restore-SqlDatabase -Database \"BLR_Logging\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Logging.bak\" -ServerInstance \"$node\" -NoRecovery \n\n        Restore-SqlDatabase -Database \"BLR_Site\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Site.log\" -ServerInstance \"$node\" -RestoreAction Log -NoRecovery\n        Restore-SqlDatabase -Database \"BLR_Monitor\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Monitor.log\" -ServerInstance \"$node\" -RestoreAction Log -NoRecovery\n        Restore-SqlDatabase -Database \"BLR_Logging\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Logging.log\" -ServerInstance \"$node\" -RestoreAction Log -NoRecovery\n     }\n  }\n\n  Add-SqlAvailabilityDatabase -Path \"SQLSERVER:\\SQL\\$PrimaryNode\\DEFAULT\\AvailabilityGroups\\$AGName\" -Database @(\"BLR_Site\",\"BLR_Monitor\",\"BLR_Logging\")\n\n  $nodes | Where-Object {$_ -ne $PrimaryNode} | ForEach-Object {Add-SqlAvailabilityDatabase -Path \"SQLSERVER:\\SQL\\$_\\DEFAULT\\AvailabilityGroups\\$AGName\" -Database @(\"BLR_Site\",\"BLR_Monitor\",\"BLR_Logging\")}\n\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\nforeach($MSSQL_NODE in $MSSQL_NODES)\n{\nInvoke-Command -ComputerName $MSSQL_NODE -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "2d2e8ac0-8b62-0ea7-1d37-add6bf8b82c3"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "CreateUsers", "state": "NOT_VALIDATED", "attrs": {"script": "$MSSQL_NODES = \"@@{MSSQL.address}@@\".Split(',')\n\n$script = {\n  if (\"$(Get-ClusterNode | where {$_.Id -eq 1} | select -ExpandProperty Name)\" -eq \"$(hostname)\"){\n  exit\n  }\n  $netbios = \"@@{DOMAIN}@@\".Split(\".\")[0].ToUpper()\n  $hostname=\"@@{HOSTNAME}@@\"\n  $username=\"$($netbios)\\$($hostname)\"\n  $createNodeLogin = \"CREATE LOGIN [$username`$] FROM WINDOWS WITH DEFAULT_DATABASE=[master], DEFAULT_LANGUAGE=[us_english];\"\n\n  Invoke-SqlCmd -Server $(hostname) -Query $createNodeLogin\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nforeach($MSSQL_NODE in $MSSQL_NODES)\n{\nInvoke-Command -ComputerName $MSSQL_NODE -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "76e2daff-6441-accf-c9c2-64f3467b6d3b"}], "description": "", "name": "29e91e9c_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "aaa51f8e_dag", "uuid": "57532d47-0cd6-4633-8794-5ead278ebcb6"}, "message_list": [], "variable_list": [], "uuid": "042fc435-a86c-4df0-b6f6-4cba2968e264"}, "message_list": [], "name": "action_create"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "b69ab542-8de5-4d55-beb9-5441447e74fb", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "3cea26c0_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "0c6a9f2d-e452-4954-85be-8ab3c5fea208"}], "description": "", "name": "22428294_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "3cea26c0_dag", "uuid": "0c6a9f2d-e452-4954-85be-8ab3c5fea208"}, "message_list": [], "variable_list": [], "uuid": "de943f5f-693e-4a9c-9642-5f51b1e2e081"}, "message_list": [], "name": "action_delete"}, {"description": "System action for starting an application", "type": "system", "uuid": "29aef2da-e402-4fca-9378-e17fcbef0ec8", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "dc2f4c2e_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "ab2764a2-f018-485e-ad39-ee0318fc0746"}], "description": "", "name": "c1427948_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "dc2f4c2e_dag", "uuid": "ab2764a2-f018-485e-ad39-ee0318fc0746"}, "message_list": [], "variable_list": [], "uuid": "631cac91-4b75-4c10-84ab-a2b6017c6296"}, "message_list": [], "name": "action_start"}, {"description": "System action for stopping an application", "type": "system", "uuid": "b1608f09-fa5d-4254-8bad-989e894ba1d3", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "2d568762_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "d4ef6654-0c16-42ea-a33f-55c7c7c6ec2d"}], "description": "", "name": "b2d07af0_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "2d568762_dag", "uuid": "d4ef6654-0c16-42ea-a33f-55c7c7c6ec2d"}, "message_list": [], "variable_list": [], "uuid": "08fe1064-8629-40b1-84b8-72356d4ca6ee"}, "message_list": [], "name": "action_stop"}, {"description": "System action for restarting an application", "type": "system", "uuid": "7f9202a4-9a43-447b-94c4-be94d0a48122", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "0038d36c_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "5c0f64f4-680c-49d1-8589-2ddc23a2ef92"}], "description": "", "name": "73c06dcc_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "0038d36c_dag", "uuid": "5c0f64f4-680c-49d1-8589-2ddc23a2ef92"}, "message_list": [], "variable_list": [], "uuid": "9a54b194-21f3-4c63-b3ef-d53d30553649"}, "message_list": [], "name": "action_restart"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "c63c9f54-e748-4ba9-ba05-96efee72c457", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Service_Element_Delete_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "4875e1d1-5166-4187-9547-34b305961b24"}], "name": "SYS_GEN__DAG_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "36cc9be9-bbd6-4863-9061-39092c5efc73"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Service_Element_Delete_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "4875e1d1-5166-4187-9547-34b305961b24"}], "description": "", "name": "SYS_GEN__Runbook_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "36cc9be9-bbd6-4863-9061-39092c5efc73"}, "message_list": [], "variable_list": [], "uuid": "d24a316a-2dee-4081-9d10-b5986a67ad23"}, "message_list": [], "name": "action_soft_delete"}], "depends_on_list": [], "name": "DDC", "state": "ACTIVE", "port_list": [], "editables": {}, "tier": "", "message_list": [], "variable_list": [{"val_type": "STRING", "description": "", "name": "EXECUTION_MODE", "type": "LOCAL", "value": "", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {}, "message_list": [], "uuid": "61257c30-a435-4a0f-8572-09d08b86e96b"}, {"val_type": "STRING", "description": "", "name": "FQDN", "type": "LOCAL", "value": "", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {}, "message_list": [], "uuid": "27e7da5d-4546-4676-a14a-0d2117e7d213"}, {"val_type": "STRING", "description": "", "name": "HOSTNAME", "type": "LOCAL", "value": "", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {}, "message_list": [], "uuid": "9c53c966-026d-8594-a876-616d798a289c"}], "description": ""}, {"singleton": false, "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675", "action_list": [{"description": "System action for creating an application", "type": "system", "uuid": "89c77a9c-bf28-41f4-9193-3f007db9742d", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "CreateStore", "uuid": "14674482-d350-4eee-98a2-bd417fdf60c8"}, {"kind": "app_task", "name": "EnableLocalMode", "uuid": "697b6d9f-4a95-4d1b-a565-41ec7fc39876"}, {"kind": "app_task", "name": "JoinRemainingNodes", "uuid": "c204a172-3e1e-4ae0-bdca-f79f24e89ab8"}], "name": "52ea23b6_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "CreateStore", "uuid": "14674482-d350-4eee-98a2-bd417fdf60c8"}, "edge_type": "user_defined", "type": "", "uuid": "8634c581-6a93-4adc-b2b2-50cdbee1297e", "to_task_reference": {"kind": "app_task", "name": "EnableLocalMode", "uuid": "697b6d9f-4a95-4d1b-a565-41ec7fc39876"}}, {"from_task_reference": {"kind": "app_task", "name": "EnableLocalMode", "uuid": "697b6d9f-4a95-4d1b-a565-41ec7fc39876"}, "edge_type": "user_defined", "type": "", "uuid": "b2ab1fbb-fa0b-4969-994e-c3e121e8b520", "to_task_reference": {"kind": "app_task", "name": "JoinRemainingNodes", "uuid": "c204a172-3e1e-4ae0-bdca-f79f24e89ab8"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "26f4b416-cc5a-47bd-876e-5e0c19379d6a"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "CreateStore", "state": "NOT_VALIDATED", "attrs": {"exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$FQDN = \"$env:computername.$env:userdnsdomain\"\n$HostbaseUrl = \"http://\" + $FQDN\n$StoreFriendlyName = \"$env:USERDOMAIN\"\n$StoreFriendlyNameWithoutSpaces = $StoreFriendlyName -replace '\\s',''\n$SiteId = 1\n$Farmtype = \"XenDesktop\"\n$FarmServers = \"@@{DDC.FQDN}@@\".Split(',')\n$StoreVirtualPath = \"/Citrix/\" + $StoreFriendlyNameWithoutSpaces\n$LoadbalanceServers = $false\n$Port = 80\n$SSLRelayPort = 443\n$TransportType = \"HTTP\"\n\n$GatewayUrl = \"\"\n$GatewayCallbackUrl = \"\"\n$GatewaySTAUrls = \"\"\n$GatewaySubnetIP = \"\"\n$GatewayName = \"\"\n\nSet-StrictMode -Version 2.0\n\n# Any failure is a terminating failure.\n$ErrorActionPreference = 'Stop'\n$ReportErrorShowStackTrace = $true\n$ReportErrorShowInnerException = $true\n\n# Import StoreFront modules. Required for versions of PowerShell earlier than 3.0 that do not support autoloading\nImport-Module Citrix.StoreFront\nImport-Module Citrix.StoreFront.Stores\nImport-Module Citrix.StoreFront.Authentication\nImport-Module Citrix.StoreFront.WebReceiver\nImport-Module Citrix.StoreFront.Roaming\n\n# Determine the Authentication and Receiver virtual path to use based of the Store\n$authenticationVirtualPath = \"$($StoreVirtualPath.TrimEnd('/'))Auth\"\n$receiverVirtualPath = \"$($StoreVirtualPath.TrimEnd('/'))Web\"\n\n# Determine if the deployment already exists\n$existingDeployment = Get-STFDeployment\n\nif(-not $existingDeployment)\n{\n    # Install the required StoreFront components\n    Add-STFDeployment -HostBaseUrl $HostbaseUrl -SiteId $SiteId -Confirm:$false\n}\nelseif($existingDeployment.HostbaseUrl -eq $HostbaseUrl)\n{\n    # The deployment exists but it is configured to the desired hostbase url\n    Write-Output \"A deployment has already been created with the specified hostbase url on this server and will be used.\"\n}\nelse\n{\n    Write-Error \"A deployment has already been created on this server with a different host base url.\"\n}\n\n# Determine if the authentication service at the specified virtual path exists\n$authentication = Get-STFAuthenticationService -VirtualPath $authenticationVirtualPath\n\nif(-not $authentication)\n{\n    # Add an Authentication service using the IIS path of the Store appended with Auth\n    $authentication = Add-STFAuthenticationService $authenticationVirtualPath\n}\nelse\n{\n    Write-Output \"An Authentication service already exists at the specified virtual path and will be used.\"\n}\n\n# Determine if the store service at the specified virtual path exists\n$store = Get-STFStoreService -VirtualPath $StoreVirtualPath\n\nif(-not $store)\n{\n    # Add a Store that uses the new Authentication service configured to publish resources from the supplied servers\n    $store = Add-STFStoreService -VirtualPath $StoreVirtualPath -AuthenticationService $authentication -FarmName $Farmtype -FarmType $Farmtype -Servers $FarmServers -LoadBalance $LoadbalanceServers `\n        -Port $Port -SSLRelayPort $SSLRelayPort -TransportType $TransportType\n}\nelse\n{\n    Write-Output \"A Store service already exists at the specified virtual path and will be used. Farm and servers will be appended to this store.\"\n    # Get the number of farms configured in the store\n    $farmCount = (Get-STFStoreFarmConfiguration $store).Farms.Count\n\n    # Append the farm to the store with a unique name\n    Add-STFStoreFarm -StoreService $store -FarmName \"Controller$($farmCount + 1)\" -FarmType $Farmtype -Servers $FarmServers -LoadBalance $LoadbalanceServers -Port $Port `\n        -SSLRelayPort $SSLRelayPort -TransportType $TransportType\n}\n\n# Determine if the receiver service at the specified virtual path exists\n$receiver = Get-STFWebReceiverService -VirtualPath $receiverVirtualPath\n\nif(-not $receiver)\n{\n    # Add a Receiver for Web site so users can access the applications and desktops in the published in the Store\n    $receiver = Add-STFWebReceiverService -VirtualPath $receiverVirtualPath -StoreService $store\n}\nelse\n{\n    Write-Output \"A Web Receiver service already exists at the specified virtual path and will be used.\"\n}\n\n# Determine if PNA is configured for the Store service\n$storePnaSettings = Get-STFStorePna -StoreService $store\n\nif(-not $storePnaSettings.PnaEnabled)\n{\n    # Enable XenApp services on the Store and make it the default for this server\n    Enable-STFStorePna -StoreService $store -AllowUserPasswordChange -DefaultPnaService\n}\n\n# Determine the Authentication and Receiver sites based on the Store\n$store = Get-STFStoreService -VirtualPath $StoreVirtualPath\n$authentication = Get-STFAuthenticationService -StoreService $store\n$receiverForWeb = Get-STFWebReceiverService -StoreService $store\n\n# Get the Web Receiver CitrixAGBasic and ExplicitForms authentication method from the supported protocols\n# Included for demonstration purposes as the protocol name can be used directly if known\n$receiverMethods = Get-STFWebReceiverAuthenticationMethodsAvailable | Where-Object { $_ -match \"Explicit\" -or $_ -match \"CitrixAG\" }\n\n# Enable CitrixAGBasic in Receiver for Web (required for remote access)\nSet-STFWebReceiverAuthenticationMethods -WebReceiverService $receiverForWeb -AuthenticationMethods $receiverMethods\n\n# Get the CitrixAGBasic authentication method from the protocols installed.\n# Included for demonstration purposes as the protocol name can be used directly if known\n$citrixAGBasic = Get-STFAuthenticationProtocolsAvailable | Where-Object { $_ -match \"CitrixAGBasic\" }\n\n# Enable CitrixAGBasic in the Authentication service (required for remote access)\nEnable-STFAuthenticationServiceProtocol -AuthenticationService $authentication -Name $citrixAGBasic\n<#\n# Add a new Gateway used to access the new Store remotely\nAdd-STFRoamingGateway -Name $GatewayName -LogonType Domain -Version Version10_0_69_4 -GatewayUrl $GatewayUrl `\n-CallbackUrl $GatewayCallbackUrl -SecureTicketAuthorityUrls $GatewaySTAUrls\n\n# Get the new Gateway from the configuration (Add-STFRoamingGateway will return the new Gateway if -PassThru is supplied as a parameter)\n$gateway = Get-STFRoamingGateway -Name $GatewayName\n\n# If the gateway subnet was provided then set it on the gateway object\nif($GatewaySubnetIP)\n{\n    Set-STFRoamingGateway -Gateway $gateway -SubnetIPAddress $GatewaySubnetIP\n}\n\n# Register the Gateway with the new Store\nRegister-STFStoreGateway -Gateway $gateway -StoreService $store -DefaultGateway\n\nWrite-Host \"Remote Access Deployment complete\"\n#>", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "DOMAIN_CRED", "uuid": "8b73012b-d702-4380-a533-71791b76c719"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "14674482-d350-4eee-98a2-bd417fdf60c8"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "EnableLocalMode", "state": "NOT_VALIDATED", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=LOCAL\"\n", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "uuid": "697b6d9f-4a95-4d1b-a565-41ec7fc39876"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "JoinRemainingNodes", "state": "NOT_VALIDATED", "attrs": {"script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -Authentication Credssp -ScriptBlock {\n    if((Test-Path C:\\_CONFIG) -eq 0 ) {\n\t\tmkdir C:\\_CONFIG\n    }\n    $RemotePasscodeScript=\"C:\\_CONFIG\\SFPasscodeScript.ps1\"\n    if((Test-Path $RemotePasscodeScript) -ne 0) {\n\t\tRemove-Item $RemotePasscodeScript\n\t}\n    Add-Content $RemotePasscodeScript \"Import-Module Citrix.StoreFront\"\n    Add-Content $RemotePasscodeScript \"`$status = Start-STFServerGroupJoin -IsAuthorizingServer -Confirm:`$false\"\n    Add-Content $RemotePasscodeScript \"`$Passcode = `$status.Passcode\"\n    Add-Content $RemotePasscodeScript \"`$Passcode.ToString() > C:\\_CONFIG\\Passcode.txt\"\n    Add-Content $RemotePasscodeScript \"Wait-STFServerGroupJoin -Confirm:`$false\"\n    Add-Content $RemotePasscodeScript \"Stop-STFServerGroupJoin\"\n    Add-Content $RemotePasscodeScript \"Publish-STFServerGroupConfiguration -Confirm:`$false\"\n}\n\n$LocalPasscodeScript=\"C:\\_CONFIG\\SFPasscodeScript.ps1\"\nschtasks /Create /F /TN SFPasscodeScript /S @@{address}@@ /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /RU \"SYSTEM\" /TR \"powershell.exe -File $LocalPasscodeScript\" /SC once /ST 23:30\nschtasks /Run /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /TN SFPasscodeScript /S @@{address}@@\nStart-Sleep -seconds 30\n\n$passcode = Invoke-Command -ComputerName @@{address}@@ -Credential $Creds -Authentication Credssp -ScriptBlock {\n\tGet-Content -Path \"C:\\_CONFIG\\Passcode.txt\"\n}\n\nif ($passcode -eq \"\"){\n\tWrite-Output \"Passcode is empty\"\n    exit 1\n}\n\n$fqdn = Invoke-Command -ComputerName @@{address}@@ -Credential $Creds -Authentication Credssp -ScriptBlock {\n\tWrite-Output \"$env:computername.$env:userdnsdomain\"\n}\n\nInvoke-Command -ComputerName @@{calm_array_address[1]}@@ -Credential $Creds -Authentication Credssp -ScriptBlock {\n\tparam($Server,$Passcode)\n    if((Test-Path C:\\_CONFIG) -eq 0 ) {\n\t\tmkdir C:\\_CONFIG\n    }\n    $RemoteSTFServerGroupJoinRem=\"C:\\_CONFIG\\STFServerGroupJoinRem.ps1\"\n    if((Test-Path $RemoteSTFServerGroupJoinRem) -ne 0) {\n\t\tRemove-Item $RemoteSTFServerGroupJoinRem\n\t}\n    Add-Content $RemoteSTFServerGroupJoinRem \"Import-Module Citrix.StoreFront\"\n    Add-Content $RemoteSTFServerGroupJoinRem \"Start-STFServerGroupJoin -AuthorizerHostName $Server -Passcode $Passcode -Confirm:`$false\"\n    Add-Content $RemoteSTFServerGroupJoinRem \"Wait-STFServerGroupJoin\"\n    Add-Content $RemoteSTFServerGroupJoinRem \"Stop-STFServerGroupJoin\"\n    Add-Content $RemoteSTFServerGroupJoinRem \"Wait-STFPublishServerGroupConfiguration\"\n} -ArgumentList $fqdn,$passcode\n\n$LocalSTFServerGroupJoinRem=\"C:\\_CONFIG\\STFServerGroupJoinRem.ps1\"\nschtasks /Create /F /TN STFServerGroupJoinRem /S @@{calm_array_address[1]}@@ /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /RU \"SYSTEM\" /TR \"powershell.exe -File $LocalSTFServerGroupJoinRem\" /SC once /ST 23:30\nschtasks /Run /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /TN STFServerGroupJoinRem /S @@{calm_array_address[1]}@@\n\nschtasks /Delete /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /TN SFPasscodeScript /S @@{address}@@ /F\nschtasks /Delete /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /TN STFServerGroupJoinRem /S @@{calm_array_address[1]}@@ /F", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c204a172-3e1e-4ae0-bdca-f79f24e89ab8"}], "description": "", "name": "21430fdc_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "52ea23b6_dag", "uuid": "26f4b416-cc5a-47bd-876e-5e0c19379d6a"}, "message_list": [], "variable_list": [], "uuid": "8557edb6-20cf-45bb-a7cc-c73043b6fcc2"}, "message_list": [], "name": "action_create"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "dd977c7c-4e82-4d7f-b7ed-d5342b00ee1d", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "6fd63783_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "102dd339-0dee-45fb-a935-2859b7a43b19"}], "description": "", "name": "6c029928_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "6fd63783_dag", "uuid": "102dd339-0dee-45fb-a935-2859b7a43b19"}, "message_list": [], "variable_list": [], "uuid": "276d66be-0577-4634-8153-df5bc8239935"}, "message_list": [], "name": "action_delete"}, {"description": "System action for starting an application", "type": "system", "uuid": "e2ec4b4f-3bd4-4f4d-bb8d-5c7b01befc37", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "a8287d2f_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "80cd2f36-77d0-41ea-9e5e-6ca3eaab9f3d"}], "description": "", "name": "fee4dd3c_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "a8287d2f_dag", "uuid": "80cd2f36-77d0-41ea-9e5e-6ca3eaab9f3d"}, "message_list": [], "variable_list": [], "uuid": "83470714-cc17-4920-b14e-157565f1ef8c"}, "message_list": [], "name": "action_start"}, {"description": "System action for stopping an application", "type": "system", "uuid": "600b4c2f-cda7-4f23-ac44-7bd23337edb1", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "a14c3309_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "5648fc2a-4985-4693-b820-0171b4bdfeff"}], "description": "", "name": "b2eeaf76_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "a14c3309_dag", "uuid": "5648fc2a-4985-4693-b820-0171b4bdfeff"}, "message_list": [], "variable_list": [], "uuid": "aa98207f-7711-44a6-ae33-fbc55df5fd61"}, "message_list": [], "name": "action_stop"}, {"description": "System action for restarting an application", "type": "system", "uuid": "74db98c2-964d-4f40-8919-e95ace6211cf", "state": "ACTIVE", "critical": false, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "b10ebd95_dag", "state": "NOT_VALIDATED", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "c5e4c2cd-d3ac-4812-afdc-7defba30203d"}], "description": "", "name": "e915c064_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "b10ebd95_dag", "uuid": "c5e4c2cd-d3ac-4812-afdc-7defba30203d"}, "message_list": [], "variable_list": [], "uuid": "f0f54133-4e14-4a5b-9eab-fa5ae1759743"}, "message_list": [], "name": "action_restart"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "2f953525-7b07-470d-9003-ce0ac233124d", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Service_Element_Delete_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "74ff99a9-8868-4999-b694-f54133eb4260"}], "name": "SYS_GEN__DAG_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "a47bf792-bd8e-477c-b996-5d91601cdf85"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Service_Element_Delete_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "74ff99a9-8868-4999-b694-f54133eb4260"}], "description": "", "name": "SYS_GEN__Runbook_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "a47bf792-bd8e-477c-b996-5d91601cdf85"}, "message_list": [], "variable_list": [], "uuid": "d9fc0a1b-0e74-4859-b976-81868939f10b"}, "message_list": [], "name": "action_soft_delete"}], "depends_on_list": [], "name": "StoreFront", "state": "ACTIVE", "port_list": [], "editables": {}, "tier": "", "message_list": [], "variable_list": [{"val_type": "STRING", "description": "", "name": "EXECUTION_MODE", "type": "LOCAL", "value": "", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {}, "message_list": [], "uuid": "22ca9399-2c1d-48e9-9bb3-8a53240f194b"}], "description": ""}], "substrate_definition_list": [{"description": "", "action_list": [{"description": "System action for creating an application", "type": "system", "uuid": "dbe65321-a21a-4e0e-be60-4c16ff761b45", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Provision_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "1d9e2fad-5d4a-4e79-9332-c28e3cec7c83"}, {"kind": "app_task", "name": "SYS_GEN__check_login_for_AHV_MSSQL_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "b52a2c59-6fbe-4e94-8970-cc1db863bf48"}], "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Nutanix_Provision_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "1d9e2fad-5d4a-4e79-9332-c28e3cec7c83"}, "edge_type": "inherent", "type": "", "uuid": "016f8986-18be-4fdc-9313-57e76bed9546", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__check_login_for_AHV_MSSQL_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "b52a2c59-6fbe-4e94-8970-cc1db863bf48"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "976fc3a0-aefa-438d-a768-6a0337ae1a2d"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Provision_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"name": "MSSQL-@@{calm_application_name}@@-@@{calm_array_index}@@", "resources": {"nic_list": [{"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}, {"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}], "serial_port_list": [], "guest_tools": null, "num_vcpus_per_socket": 1, "num_sockets": 4, "gpu_list": [], "memory_size_mib": 4096, "parent_reference": null, "hardware_clock_timezone": "", "guest_customization": {"cloud_init": null, "type": "", "sysprep": {"install_type": "PREPARED", "unattend_xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false</fDenyTSConnections>\n      </component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0</UserAuthentication>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true</Active>\n               <Profile>all</Profile>\n               <Group>@FirewallAPI.dll,-28752</Group>\n            </FirewallGroup>\n         </FirewallGroups>\n      </component>\n   </settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </AdministratorPassword>\n         </UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </Password>\n            <Enabled>true</Enabled>\n            <Username>Administrator</Username>\n         </AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe /c netsh firewall add portopening TCP 5985 \"Port 5985\"</CommandLine>\n               <Description>Win RM port open</Description>\n               <Order>1</Order>\n               <RequiresUserInput>true</RequiresUserInput>\n            </SynchronousCommand>\n         </FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true</HideEULAPage>\n            <SkipMachineOOBE>true</SkipMachineOOBE>\n         </OOBE>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US</InputLocale>\n         <SystemLocale>en-US</SystemLocale>\n         <UILanguageFallback>en-us</UILanguageFallback>\n         <UILanguage>en-US</UILanguage>\n         <UserLocale>en-US</UserLocale>\n      </component>\n   </settings>\n</unattend>", "type": ""}}, "power_state": "ON", "type": "", "boot_config": {"boot_device": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}}, "type": "", "mac_address": ""}, "disk_list": [{"data_source_reference": {"kind": "image", "type": "", "name": "WindowsServer2016-Base", "uuid": "7833ea8b-3bed-4955-9c3c-919b52581ea5"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": {"kind": "image", "type": "", "name": "SQLServer2014SP2-FullSlipstream-x64-ENU", "uuid": "0be4cd78-184b-4319-96fa-d949c686ccde"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "IDE"}, "device_type": "CDROM"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 51200, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 1, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 153600, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 2, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 307200, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 3, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 307200, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 4, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 102400, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 5, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 102400, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 6, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 204800, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 7, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 204800, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 8, "adapter_type": "SCSI"}, "device_type": "DISK"}}]}, "availability_zone_reference": null, "backup_policy": null, "type": "", "cluster_reference": null, "categories": ""}, "timeout_secs": "0", "type": "PROVISION_NUTANIX", "variable_list": [], "uuid": "1d9e2fad-5d4a-4e79-9332-c28e3cec7c83"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__check_login_for_AHV_MSSQL_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CHECK_LOGIN", "timeout": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "timeout_secs": "0", "type": "CHECK_LOGIN", "variable_list": [], "uuid": "b52a2c59-6fbe-4e94-8970-cc1db863bf48"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "976fc3a0-aefa-438d-a768-6a0337ae1a2d"}, "message_list": [], "variable_list": [], "uuid": "a8a7ae38-c2b9-470d-8f94-bd981491fd3a"}, "message_list": [], "name": "action_create"}, {"description": "System action for powering on an application", "type": "system", "uuid": "e61417aa-f8c6-4d26-9faf-38611a2023b2", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_PowerOn_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "e95b948d-c315-4fd4-a885-3b1a0e4a70ab"}, {"kind": "app_task", "name": "check_login_for_AHV_MSSQL_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "b83dec5e-f05e-452e-8327-cd2b4d0bc628"}], "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_PowerOn_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "e95b948d-c315-4fd4-a885-3b1a0e4a70ab"}, "edge_type": "inherent", "type": "", "uuid": "0465252d-38cb-4481-bd5f-6e30420a8724", "to_task_reference": {"kind": "app_task", "name": "check_login_for_AHV_MSSQL_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "b83dec5e-f05e-452e-8327-cd2b4d0bc628"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "3a9abb5e-1646-41fb-bf48-3682142829a6"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Operation_PowerOn_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "GENERIC_OPERATION"}, "timeout_secs": "0", "type": "VMOPERATION_NUTANIX", "variable_list": [], "uuid": "e95b948d-c315-4fd4-a885-3b1a0e4a70ab"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "check_login_for_AHV_MSSQL_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CHECK_LOGIN", "timeout": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "timeout_secs": "0", "type": "CHECK_LOGIN", "variable_list": [], "uuid": "b83dec5e-f05e-452e-8327-cd2b4d0bc628"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "3a9abb5e-1646-41fb-bf48-3682142829a6"}, "message_list": [], "variable_list": [], "uuid": "97d4cc68-bdfa-4035-bb8e-4f2b225343f8"}, "message_list": [], "name": "action_poweron"}, {"description": "System action for restarting an application", "type": "system", "uuid": "494b79af-64c7-4604-9a5d-3b4df4cb26e6", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_Restart_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "08da2d4d-5d3c-4d75-bc2f-92150fb589c0"}, {"kind": "app_task", "name": "check_login_for_AHV_MSSQL_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "6be5c982-a5d8-44b8-ba33-4c62aedacd24"}], "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_Restart_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "08da2d4d-5d3c-4d75-bc2f-92150fb589c0"}, "edge_type": "inherent", "type": "", "uuid": "2c2f252c-cf27-45fb-a8cd-d8d19838f8fa", "to_task_reference": {"kind": "app_task", "name": "check_login_for_AHV_MSSQL_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "6be5c982-a5d8-44b8-ba33-4c62aedacd24"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "6ccd248c-184b-437d-91bf-371de8855603"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Operation_Restart_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "GENERIC_OPERATION"}, "timeout_secs": "0", "type": "VMOPERATION_NUTANIX", "variable_list": [], "uuid": "08da2d4d-5d3c-4d75-bc2f-92150fb589c0"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "check_login_for_AHV_MSSQL_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CHECK_LOGIN", "timeout": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "timeout_secs": "0", "type": "CHECK_LOGIN", "variable_list": [], "uuid": "6be5c982-a5d8-44b8-ba33-4c62aedacd24"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "6ccd248c-184b-437d-91bf-371de8855603"}, "message_list": [], "variable_list": [], "uuid": "c220e32d-de12-444a-910f-fd1720e163c8"}, "message_list": [], "name": "action_restart"}, {"description": "System action for suspending an application", "type": "system", "uuid": "eb362441-bfca-41e2-adde-ddaeb3fb74b1", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "e68bafdc-2d17-47f2-8117-e4c26cd4e0aa"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "e68bafdc-2d17-47f2-8117-e4c26cd4e0aa"}, "message_list": [], "variable_list": [], "uuid": "6f42111c-2439-4b8d-866f-d51591f3d1f4"}, "message_list": [], "name": "action_suspend"}, {"description": "System action for modifying an application", "type": "system", "uuid": "7643c27d-68ed-4459-b06e-c0009f72113b", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "9f47e08f-07e9-4113-a3fa-93cbff3c8a86"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "9f47e08f-07e9-4113-a3fa-93cbff3c8a86"}, "message_list": [], "variable_list": [], "uuid": "696ffcbf-9f0b-487e-a3b0-35e4a7881d4e"}, "message_list": [], "name": "action_modify"}, {"description": "System action for powering off an application", "type": "system", "uuid": "e1a15b42-4d51-4de5-af29-519eb1bcf9cd", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_PowerOff_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "2f603531-ed19-4484-9a07-4eb2839ab1d7"}], "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "bdc8a8be-7716-4227-96ac-a871ed6aa31a"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Operation_PowerOff_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "GENERIC_OPERATION"}, "timeout_secs": "0", "type": "VMOPERATION_NUTANIX", "variable_list": [], "uuid": "2f603531-ed19-4484-9a07-4eb2839ab1d7"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "bdc8a8be-7716-4227-96ac-a871ed6aa31a"}, "message_list": [], "variable_list": [], "uuid": "3aec85b3-a5af-4c55-8c53-078ca9313d67"}, "message_list": [], "name": "action_poweroff"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "eb29711c-843d-4173-a1a7-7fa875ee8a26", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Delete_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "c3d3507e-147d-400b-b312-733078c05840"}], "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "fbde4cf4-aa05-4fe2-bab1-7615356b7fda"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Delete_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "DELETE_NUTANIX", "variable_list": [], "uuid": "c3d3507e-147d-400b-b312-733078c05840"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "fbde4cf4-aa05-4fe2-bab1-7615356b7fda"}, "message_list": [], "variable_list": [], "uuid": "cc049242-7025-433a-8eb7-46374da90b01"}, "message_list": [], "name": "action_delete"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "546fb8de-f970-4ccd-8369-2014b81fd11a", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Substrate_Element_Delete_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "43b82d4b-0fd0-4245-baf3-acb5d291808a"}], "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "ae7200bb-0da3-4342-8c1d-ac80eec2664e"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Substrate_Element_Delete_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "43b82d4b-0fd0-4245-baf3-acb5d291808a"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "ae7200bb-0da3-4342-8c1d-ac80eec2664e"}, "message_list": [], "variable_list": [], "uuid": "af183eaa-f234-4253-ae56-c76e21d553d2"}, "message_list": [], "name": "action_soft_delete"}], "type": "AHV_VM", "name": "AHV_MSSQL", "state": "ACTIVE", "readiness_probe": {"connection_type": "POWERSHELL", "disable_readiness_probe": false, "connection_port": 5985, "timeout_secs": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "editables": {"create_spec": {"resources": {"nic_list": {}, "disk_list": {}}}}, "os_type": "Windows", "message_list": [], "create_spec": {"name": "MSSQL-@@{calm_application_name}@@-@@{calm_array_index}@@", "resources": {"nic_list": [{"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}, {"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}], "serial_port_list": [], "guest_tools": null, "num_vcpus_per_socket": 1, "num_sockets": 4, "gpu_list": [], "memory_size_mib": 4096, "parent_reference": null, "hardware_clock_timezone": "", "guest_customization": {"cloud_init": null, "type": "", "sysprep": {"install_type": "PREPARED", "unattend_xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false</fDenyTSConnections>\n      </component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0</UserAuthentication>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true</Active>\n               <Profile>all</Profile>\n               <Group>@FirewallAPI.dll,-28752</Group>\n            </FirewallGroup>\n         </FirewallGroups>\n      </component>\n   </settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </AdministratorPassword>\n         </UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </Password>\n            <Enabled>true</Enabled>\n            <Username>Administrator</Username>\n         </AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe /c netsh firewall add portopening TCP 5985 \"Port 5985\"</CommandLine>\n               <Description>Win RM port open</Description>\n               <Order>1</Order>\n               <RequiresUserInput>true</RequiresUserInput>\n            </SynchronousCommand>\n         </FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true</HideEULAPage>\n            <SkipMachineOOBE>true</SkipMachineOOBE>\n         </OOBE>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US</InputLocale>\n         <SystemLocale>en-US</SystemLocale>\n         <UILanguageFallback>en-us</UILanguageFallback>\n         <UILanguage>en-US</UILanguage>\n         <UserLocale>en-US</UserLocale>\n      </component>\n   </settings>\n</unattend>", "type": ""}}, "power_state": "ON", "type": "", "boot_config": {"boot_device": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}}, "type": "", "mac_address": ""}, "disk_list": [{"data_source_reference": {"kind": "image", "type": "", "name": "WindowsServer2016-Base", "uuid": "7833ea8b-3bed-4955-9c3c-919b52581ea5"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": {"kind": "image", "type": "", "name": "SQLServer2014SP2-FullSlipstream-x64-ENU", "uuid": "0be4cd78-184b-4319-96fa-d949c686ccde"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "IDE"}, "device_type": "CDROM"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 51200, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 1, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 153600, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 2, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 307200, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 3, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 307200, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 4, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 102400, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 5, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 102400, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 6, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 204800, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 7, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": null, "type": "", "disk_size_mib": 204800, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 8, "adapter_type": "SCSI"}, "device_type": "DISK"}}]}, "availability_zone_reference": null, "backup_policy": null, "type": "", "cluster_reference": null, "categories": ""}, "variable_list": [], "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, {"description": "", "action_list": [{"description": "System action for creating an application", "type": "system", "uuid": "117bd6ed-a0ab-4dc8-9a79-c79c85647a37", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Provision_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "9e115c90-e451-4b60-9f3b-279a4b9d52a9"}, {"kind": "app_task", "name": "SYS_GEN__check_login_for_AHV_DDC_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "2dc63e7f-f336-4de1-9c96-386d300a7b42"}], "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Nutanix_Provision_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "9e115c90-e451-4b60-9f3b-279a4b9d52a9"}, "edge_type": "inherent", "type": "", "uuid": "96d757fc-3f71-4160-805f-84c8fc554dc1", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__check_login_for_AHV_DDC_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "2dc63e7f-f336-4de1-9c96-386d300a7b42"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "03ba6e35-7493-47d0-8be8-c26a3b41a60d"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Provision_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"name": "DDC-@@{calm_application_name}@@-@@{calm_array_index}@@", "resources": {"nic_list": [{"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}], "serial_port_list": [], "guest_tools": null, "num_vcpus_per_socket": 1, "num_sockets": 4, "gpu_list": [], "memory_size_mib": 4096, "parent_reference": null, "hardware_clock_timezone": "", "guest_customization": {"cloud_init": null, "type": "", "sysprep": {"install_type": "PREPARED", "unattend_xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false</fDenyTSConnections>\n      </component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0</UserAuthentication>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true</Active>\n               <Profile>all</Profile>\n               <Group>@FirewallAPI.dll,-28752</Group>\n            </FirewallGroup>\n         </FirewallGroups>\n      </component>\n   </settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </AdministratorPassword>\n         </UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </Password>\n            <Enabled>true</Enabled>\n            <Username>Administrator</Username>\n         </AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe /c netsh firewall add portopening TCP 5985 \"Port 5985\"</CommandLine>\n               <Description>Win RM port open</Description>\n               <Order>1</Order>\n               <RequiresUserInput>true</RequiresUserInput>\n            </SynchronousCommand>\n         </FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true</HideEULAPage>\n            <SkipMachineOOBE>true</SkipMachineOOBE>\n         </OOBE>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US</InputLocale>\n         <SystemLocale>en-US</SystemLocale>\n         <UILanguageFallback>en-us</UILanguageFallback>\n         <UILanguage>en-US</UILanguage>\n         <UserLocale>en-US</UserLocale>\n      </component>\n   </settings>\n</unattend>", "type": ""}}, "power_state": "ON", "type": "", "boot_config": {"boot_device": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}}, "type": "", "mac_address": ""}, "disk_list": [{"data_source_reference": {"kind": "image", "type": "", "name": "WindowsServer2016-Base", "uuid": "7833ea8b-3bed-4955-9c3c-919b52581ea5"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": {"kind": "image", "type": "", "name": "XenApp_and_XenDesktop_7_16", "uuid": "65cfdbf1-d372-4e90-8aff-9563047e4cd8"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "IDE"}, "device_type": "CDROM"}}]}, "availability_zone_reference": null, "backup_policy": null, "type": "", "cluster_reference": null, "categories": ""}, "timeout_secs": "0", "type": "PROVISION_NUTANIX", "variable_list": [], "uuid": "9e115c90-e451-4b60-9f3b-279a4b9d52a9"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__check_login_for_AHV_DDC_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CHECK_LOGIN", "timeout": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "timeout_secs": "0", "type": "CHECK_LOGIN", "variable_list": [], "uuid": "2dc63e7f-f336-4de1-9c96-386d300a7b42"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "03ba6e35-7493-47d0-8be8-c26a3b41a60d"}, "message_list": [], "variable_list": [], "uuid": "c8107d8b-f026-4f14-9247-d21c84ce263a"}, "message_list": [], "name": "action_create"}, {"description": "System action for powering on an application", "type": "system", "uuid": "7cbc7cb2-1865-4c16-8118-dbec4f410f2c", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_PowerOn_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "5bda7516-6c67-4dba-9e1b-e850f3b47134"}, {"kind": "app_task", "name": "check_login_for_AHV_DDC_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "b1a900bb-82b9-4c48-8b12-ff6c9280be36"}], "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_PowerOn_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "5bda7516-6c67-4dba-9e1b-e850f3b47134"}, "edge_type": "inherent", "type": "", "uuid": "bfc18fe0-015c-4dbc-921e-205129928808", "to_task_reference": {"kind": "app_task", "name": "check_login_for_AHV_DDC_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "b1a900bb-82b9-4c48-8b12-ff6c9280be36"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "56924b53-3267-4ff2-aea8-4a99a8cff5da"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Operation_PowerOn_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "GENERIC_OPERATION"}, "timeout_secs": "0", "type": "VMOPERATION_NUTANIX", "variable_list": [], "uuid": "5bda7516-6c67-4dba-9e1b-e850f3b47134"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "check_login_for_AHV_DDC_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CHECK_LOGIN", "timeout": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "timeout_secs": "0", "type": "CHECK_LOGIN", "variable_list": [], "uuid": "b1a900bb-82b9-4c48-8b12-ff6c9280be36"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "56924b53-3267-4ff2-aea8-4a99a8cff5da"}, "message_list": [], "variable_list": [], "uuid": "2621f4ad-b028-4083-bca6-1626e4496ae1"}, "message_list": [], "name": "action_poweron"}, {"description": "System action for restarting an application", "type": "system", "uuid": "9f0be877-e36d-495b-9886-e88f2ebe9245", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_Restart_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "ab4e1f5b-3c9e-43e4-a9ae-e066ded19383"}, {"kind": "app_task", "name": "check_login_for_AHV_DDC_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "3d58d3b4-f68a-419e-98de-fe6ab7b8d798"}], "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_Restart_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "ab4e1f5b-3c9e-43e4-a9ae-e066ded19383"}, "edge_type": "inherent", "type": "", "uuid": "9699e99f-a8fd-4659-a40f-c066b45d9713", "to_task_reference": {"kind": "app_task", "name": "check_login_for_AHV_DDC_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "3d58d3b4-f68a-419e-98de-fe6ab7b8d798"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "e25d10a4-91ad-41a8-8d1d-c728e2c7e90b"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Operation_Restart_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "GENERIC_OPERATION"}, "timeout_secs": "0", "type": "VMOPERATION_NUTANIX", "variable_list": [], "uuid": "ab4e1f5b-3c9e-43e4-a9ae-e066ded19383"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "check_login_for_AHV_DDC_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CHECK_LOGIN", "timeout": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "timeout_secs": "0", "type": "CHECK_LOGIN", "variable_list": [], "uuid": "3d58d3b4-f68a-419e-98de-fe6ab7b8d798"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "e25d10a4-91ad-41a8-8d1d-c728e2c7e90b"}, "message_list": [], "variable_list": [], "uuid": "c1b079ac-5f44-4f74-916e-228a20c522bf"}, "message_list": [], "name": "action_restart"}, {"description": "System action for suspending an application", "type": "system", "uuid": "58e6a87d-09c0-49f8-809b-1844a56be1a5", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "a655fb04-3ef9-4e23-8424-aa9620eb52fb"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "a655fb04-3ef9-4e23-8424-aa9620eb52fb"}, "message_list": [], "variable_list": [], "uuid": "5e6397f9-21f7-425e-a0e5-c88fc230aacf"}, "message_list": [], "name": "action_suspend"}, {"description": "System action for modifying an application", "type": "system", "uuid": "3fe675ac-7080-459e-a2de-bf02f90370d7", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "5f46d697-fcaa-4145-8f3d-fc64188b31f3"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "5f46d697-fcaa-4145-8f3d-fc64188b31f3"}, "message_list": [], "variable_list": [], "uuid": "f503efeb-06ae-46a0-b949-cd33ba97e86c"}, "message_list": [], "name": "action_modify"}, {"description": "System action for powering off an application", "type": "system", "uuid": "d5ba8fc6-5868-4115-8ff4-67cd5966a9b4", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_PowerOff_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "5e4d9589-a60b-4cdb-a8a2-a69e026cf4c4"}], "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "72a4a051-730c-4b45-b8cb-521926e7d055"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Operation_PowerOff_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "GENERIC_OPERATION"}, "timeout_secs": "0", "type": "VMOPERATION_NUTANIX", "variable_list": [], "uuid": "5e4d9589-a60b-4cdb-a8a2-a69e026cf4c4"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "72a4a051-730c-4b45-b8cb-521926e7d055"}, "message_list": [], "variable_list": [], "uuid": "facc6151-0ab3-45d6-abdd-4b310c412e00"}, "message_list": [], "name": "action_poweroff"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "e4750333-17dc-4688-94c4-aa92cb72a8b1", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Delete_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "81103a7d-eace-4b25-82df-c426d5107290"}], "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "165a2811-f502-4535-b2a8-7e227a92e681"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Delete_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "DELETE_NUTANIX", "variable_list": [], "uuid": "81103a7d-eace-4b25-82df-c426d5107290"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "165a2811-f502-4535-b2a8-7e227a92e681"}, "message_list": [], "variable_list": [], "uuid": "05e6b137-bddf-4644-ae7e-55a055af3289"}, "message_list": [], "name": "action_delete"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "6e8c7eef-1db6-4a05-807a-f798ec441555", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Substrate_Element_Delete_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "98fb2396-71a0-4bc8-8a68-fc44a226eb24"}], "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "6d84c531-dbaa-4c37-9c6c-68c76850770e"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Substrate_Element_Delete_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "98fb2396-71a0-4bc8-8a68-fc44a226eb24"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "6d84c531-dbaa-4c37-9c6c-68c76850770e"}, "message_list": [], "variable_list": [], "uuid": "143f12fb-5bd4-489a-bf10-759f2cbeb491"}, "message_list": [], "name": "action_soft_delete"}], "type": "AHV_VM", "name": "AHV_DDC", "state": "ACTIVE", "readiness_probe": {"connection_type": "POWERSHELL", "disable_readiness_probe": false, "connection_port": 5985, "timeout_secs": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "editables": {"create_spec": {"resources": {"nic_list": {}, "disk_list": {}}}}, "os_type": "Windows", "message_list": [], "create_spec": {"name": "DDC-@@{calm_application_name}@@-@@{calm_array_index}@@", "resources": {"nic_list": [{"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}], "serial_port_list": [], "guest_tools": null, "num_vcpus_per_socket": 1, "num_sockets": 4, "gpu_list": [], "memory_size_mib": 4096, "parent_reference": null, "hardware_clock_timezone": "", "guest_customization": {"cloud_init": null, "type": "", "sysprep": {"install_type": "PREPARED", "unattend_xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false</fDenyTSConnections>\n      </component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0</UserAuthentication>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true</Active>\n               <Profile>all</Profile>\n               <Group>@FirewallAPI.dll,-28752</Group>\n            </FirewallGroup>\n         </FirewallGroups>\n      </component>\n   </settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </AdministratorPassword>\n         </UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </Password>\n            <Enabled>true</Enabled>\n            <Username>Administrator</Username>\n         </AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe /c netsh firewall add portopening TCP 5985 \"Port 5985\"</CommandLine>\n               <Description>Win RM port open</Description>\n               <Order>1</Order>\n               <RequiresUserInput>true</RequiresUserInput>\n            </SynchronousCommand>\n         </FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true</HideEULAPage>\n            <SkipMachineOOBE>true</SkipMachineOOBE>\n         </OOBE>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US</InputLocale>\n         <SystemLocale>en-US</SystemLocale>\n         <UILanguageFallback>en-us</UILanguageFallback>\n         <UILanguage>en-US</UILanguage>\n         <UserLocale>en-US</UserLocale>\n      </component>\n   </settings>\n</unattend>", "type": ""}}, "power_state": "ON", "type": "", "boot_config": {"boot_device": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}}, "type": "", "mac_address": ""}, "disk_list": [{"data_source_reference": {"kind": "image", "type": "", "name": "WindowsServer2016-Base", "uuid": "7833ea8b-3bed-4955-9c3c-919b52581ea5"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": {"kind": "image", "type": "", "name": "XenApp_and_XenDesktop_7_16", "uuid": "65cfdbf1-d372-4e90-8aff-9563047e4cd8"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "IDE"}, "device_type": "CDROM"}}]}, "availability_zone_reference": null, "backup_policy": null, "type": "", "cluster_reference": null, "categories": ""}, "variable_list": [], "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, {"description": "", "action_list": [{"description": "System action for creating an application", "type": "system", "uuid": "e75ef7fd-18bb-4252-9760-6bc8437f9751", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Provision_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "aff4dca2-abea-44e7-bfcd-3efb036dde5b"}, {"kind": "app_task", "name": "SYS_GEN__check_login_for_AHV_StoreFront_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "2b965e8b-ef6d-4ae7-80b2-510e0ce71503"}], "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Nutanix_Provision_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "aff4dca2-abea-44e7-bfcd-3efb036dde5b"}, "edge_type": "inherent", "type": "", "uuid": "794c7901-694a-4798-858f-2d212cb59ff9", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__check_login_for_AHV_StoreFront_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "2b965e8b-ef6d-4ae7-80b2-510e0ce71503"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "878fc970-91d1-41ea-86d0-375d40b3918c"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Provision_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"name": "StoreFront-@@{calm_application_name}@@-@@{calm_array_index}@@", "resources": {"nic_list": [{"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}], "serial_port_list": [], "guest_tools": null, "num_vcpus_per_socket": 1, "num_sockets": 4, "gpu_list": [], "memory_size_mib": 4096, "parent_reference": null, "hardware_clock_timezone": "", "guest_customization": {"cloud_init": null, "type": "", "sysprep": {"install_type": "PREPARED", "unattend_xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false</fDenyTSConnections>\n      </component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0</UserAuthentication>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true</Active>\n               <Profile>all</Profile>\n               <Group>@FirewallAPI.dll,-28752</Group>\n            </FirewallGroup>\n         </FirewallGroups>\n      </component>\n   </settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </AdministratorPassword>\n         </UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </Password>\n            <Enabled>true</Enabled>\n            <Username>Administrator</Username>\n         </AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe /c netsh firewall add portopening TCP 5985 \"Port 5985\"</CommandLine>\n               <Description>Win RM port open</Description>\n               <Order>1</Order>\n               <RequiresUserInput>true</RequiresUserInput>\n            </SynchronousCommand>\n         </FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true</HideEULAPage>\n            <SkipMachineOOBE>true</SkipMachineOOBE>\n         </OOBE>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US</InputLocale>\n         <SystemLocale>en-US</SystemLocale>\n         <UILanguageFallback>en-us</UILanguageFallback>\n         <UILanguage>en-US</UILanguage>\n         <UserLocale>en-US</UserLocale>\n      </component>\n   </settings>\n</unattend>", "type": ""}}, "power_state": "ON", "type": "", "boot_config": {"boot_device": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}}, "type": "", "mac_address": ""}, "disk_list": [{"data_source_reference": {"kind": "image", "type": "", "name": "WindowsServer2016-Base", "uuid": "7833ea8b-3bed-4955-9c3c-919b52581ea5"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": {"kind": "image", "type": "", "name": "XenApp_and_XenDesktop_7_16", "uuid": "65cfdbf1-d372-4e90-8aff-9563047e4cd8"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "IDE"}, "device_type": "CDROM"}}]}, "availability_zone_reference": null, "backup_policy": null, "type": "", "cluster_reference": null, "categories": ""}, "timeout_secs": "0", "type": "PROVISION_NUTANIX", "variable_list": [], "uuid": "aff4dca2-abea-44e7-bfcd-3efb036dde5b"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__check_login_for_AHV_StoreFront_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CHECK_LOGIN", "timeout": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "timeout_secs": "0", "type": "CHECK_LOGIN", "variable_list": [], "uuid": "2b965e8b-ef6d-4ae7-80b2-510e0ce71503"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "878fc970-91d1-41ea-86d0-375d40b3918c"}, "message_list": [], "variable_list": [], "uuid": "2900a2a1-75c9-4d53-95a5-4a6d369efb07"}, "message_list": [], "name": "action_create"}, {"description": "System action for powering on an application", "type": "system", "uuid": "0015cb59-c67f-49f6-88f4-b5213b2dfe1b", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_PowerOn_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "32e111fb-6dbd-41b5-9373-6887a2a937ef"}, {"kind": "app_task", "name": "check_login_for_AHV_StoreFront_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "9a58b005-29ad-4d9c-b09e-5d0a506cf1cb"}], "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_PowerOn_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "32e111fb-6dbd-41b5-9373-6887a2a937ef"}, "edge_type": "inherent", "type": "", "uuid": "dcb94d96-293f-4610-9d6c-017aff2a9201", "to_task_reference": {"kind": "app_task", "name": "check_login_for_AHV_StoreFront_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "9a58b005-29ad-4d9c-b09e-5d0a506cf1cb"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "addb3b7a-d4f5-4f4b-a375-16c9d296089b"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Operation_PowerOn_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "GENERIC_OPERATION"}, "timeout_secs": "0", "type": "VMOPERATION_NUTANIX", "variable_list": [], "uuid": "32e111fb-6dbd-41b5-9373-6887a2a937ef"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "check_login_for_AHV_StoreFront_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CHECK_LOGIN", "timeout": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "timeout_secs": "0", "type": "CHECK_LOGIN", "variable_list": [], "uuid": "9a58b005-29ad-4d9c-b09e-5d0a506cf1cb"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "addb3b7a-d4f5-4f4b-a375-16c9d296089b"}, "message_list": [], "variable_list": [], "uuid": "9bbbbf2f-1f21-4d04-9623-3135957b2fad"}, "message_list": [], "name": "action_poweron"}, {"description": "System action for restarting an application", "type": "system", "uuid": "983d8522-3c6d-4dd6-88ca-25a26c03e919", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_Restart_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "8c410267-4ea5-42e6-a0ca-03551da8faf0"}, {"kind": "app_task", "name": "check_login_for_AHV_StoreFront_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "902e9079-db27-42d8-9100-d4281d0ae6c8"}], "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_Restart_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "8c410267-4ea5-42e6-a0ca-03551da8faf0"}, "edge_type": "inherent", "type": "", "uuid": "7839b8ab-aa75-4196-9348-e7e1867684f7", "to_task_reference": {"kind": "app_task", "name": "check_login_for_AHV_StoreFront_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "902e9079-db27-42d8-9100-d4281d0ae6c8"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "cf5ac3ea-11f2-41b6-ad82-516e9bc1c287"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Operation_Restart_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "GENERIC_OPERATION"}, "timeout_secs": "0", "type": "VMOPERATION_NUTANIX", "variable_list": [], "uuid": "8c410267-4ea5-42e6-a0ca-03551da8faf0"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "check_login_for_AHV_StoreFront_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CHECK_LOGIN", "timeout": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "timeout_secs": "0", "type": "CHECK_LOGIN", "variable_list": [], "uuid": "902e9079-db27-42d8-9100-d4281d0ae6c8"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "cf5ac3ea-11f2-41b6-ad82-516e9bc1c287"}, "message_list": [], "variable_list": [], "uuid": "e6b20569-d7a8-4e35-8c21-5b0c0140c508"}, "message_list": [], "name": "action_restart"}, {"description": "System action for suspending an application", "type": "system", "uuid": "1241119e-7df9-4183-95d5-8bb073659ff6", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "051f92ec-7e12-46c8-b3c9-b748a3c2f980"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "051f92ec-7e12-46c8-b3c9-b748a3c2f980"}, "message_list": [], "variable_list": [], "uuid": "59302b10-ed50-440f-bfc4-df1db08d505c"}, "message_list": [], "name": "action_suspend"}, {"description": "System action for modifying an application", "type": "system", "uuid": "71f9470f-0646-44b2-ac80-8fad24e8fb1a", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "e2cee6b2-d9ab-4cbb-b1a9-7ae53aeb982b"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "e2cee6b2-d9ab-4cbb-b1a9-7ae53aeb982b"}, "message_list": [], "variable_list": [], "uuid": "85b8ebb5-bcb0-44e4-8119-ac0de6b44258"}, "message_list": [], "name": "action_modify"}, {"description": "System action for powering off an application", "type": "system", "uuid": "696027ac-cc8f-4eb7-ade9-b84d3df04b82", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Operation_PowerOff_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "0ab1d3a6-2974-4c4a-bd69-89239adb9d2c"}], "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "f858ad22-e563-4b22-9093-a23c14f8f1de"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Operation_PowerOff_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "GENERIC_OPERATION"}, "timeout_secs": "0", "type": "VMOPERATION_NUTANIX", "variable_list": [], "uuid": "0ab1d3a6-2974-4c4a-bd69-89239adb9d2c"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "f858ad22-e563-4b22-9093-a23c14f8f1de"}, "message_list": [], "variable_list": [], "uuid": "db2ca98d-0811-4feb-bad9-5778d88d919c"}, "message_list": [], "name": "action_poweroff"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "bc2881be-22f5-4317-8fe5-e10ea5782e45", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Nutanix_Delete_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "70e2b69e-3740-4763-b840-f4f709daf109"}], "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "6ebb6e6d-c9f8-41ac-895d-5ae1912c6c2d"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Nutanix_Delete_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "DELETE_NUTANIX", "variable_list": [], "uuid": "70e2b69e-3740-4763-b840-f4f709daf109"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "6ebb6e6d-c9f8-41ac-895d-5ae1912c6c2d"}, "message_list": [], "variable_list": [], "uuid": "4b7968fe-611d-464c-aba4-c976bc5809a7"}, "message_list": [], "name": "action_delete"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "2962af37-9876-405c-a2f1-5c9609493189", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Substrate_Element_Delete_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "1f6b5715-8732-46b2-8d2d-f3b09b17e261"}], "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "294ff16a-172c-4ae7-b023-7cdef770bcf8"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Substrate_Element_Delete_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "1f6b5715-8732-46b2-8d2d-f3b09b17e261"}], "description": "", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "294ff16a-172c-4ae7-b023-7cdef770bcf8"}, "message_list": [], "variable_list": [], "uuid": "3509fb5f-6233-4c80-ba35-2ab5bda51f3d"}, "message_list": [], "name": "action_soft_delete"}], "type": "AHV_VM", "name": "AHV_StoreFront", "state": "ACTIVE", "readiness_probe": {"connection_type": "POWERSHELL", "disable_readiness_probe": false, "connection_port": 5985, "timeout_secs": "300", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@"}, "editables": {"create_spec": {"resources": {"nic_list": {}, "disk_list": {}}}}, "os_type": "Windows", "message_list": [], "create_spec": {"name": "StoreFront-@@{calm_application_name}@@-@@{calm_array_index}@@", "resources": {"nic_list": [{"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}], "serial_port_list": [], "guest_tools": null, "num_vcpus_per_socket": 1, "num_sockets": 4, "gpu_list": [], "memory_size_mib": 4096, "parent_reference": null, "hardware_clock_timezone": "", "guest_customization": {"cloud_init": null, "type": "", "sysprep": {"install_type": "PREPARED", "unattend_xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false</fDenyTSConnections>\n      </component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0</UserAuthentication>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true</Active>\n               <Profile>all</Profile>\n               <Group>@FirewallAPI.dll,-28752</Group>\n            </FirewallGroup>\n         </FirewallGroups>\n      </component>\n   </settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </AdministratorPassword>\n         </UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </Password>\n            <Enabled>true</Enabled>\n            <Username>Administrator</Username>\n         </AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe /c netsh firewall add portopening TCP 5985 \"Port 5985\"</CommandLine>\n               <Description>Win RM port open</Description>\n               <Order>1</Order>\n               <RequiresUserInput>true</RequiresUserInput>\n            </SynchronousCommand>\n         </FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true</HideEULAPage>\n            <SkipMachineOOBE>true</SkipMachineOOBE>\n         </OOBE>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US</InputLocale>\n         <SystemLocale>en-US</SystemLocale>\n         <UILanguageFallback>en-us</UILanguageFallback>\n         <UILanguage>en-US</UILanguage>\n         <UserLocale>en-US</UserLocale>\n      </component>\n   </settings>\n</unattend>", "type": ""}}, "power_state": "ON", "type": "", "boot_config": {"boot_device": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}}, "type": "", "mac_address": ""}, "disk_list": [{"data_source_reference": {"kind": "image", "type": "", "name": "WindowsServer2016-Base", "uuid": "7833ea8b-3bed-4955-9c3c-919b52581ea5"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "SCSI"}, "device_type": "DISK"}}, {"data_source_reference": {"kind": "image", "type": "", "name": "XenApp_and_XenDesktop_7_16", "uuid": "65cfdbf1-d372-4e90-8aff-9563047e4cd8"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "disk_address": {"type": "", "device_index": 0, "adapter_type": "IDE"}, "device_type": "CDROM"}}]}, "availability_zone_reference": null, "backup_policy": null, "type": "", "cluster_reference": null, "categories": ""}, "variable_list": [], "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}], "credential_definition_list": [{"username": "administrator", "description": "", "secret": {"attrs": {"is_secret_modified": false, "secret_reference": {}}}, "name": "LOCAL", "state": "ACTIVE", "editables": {}, "type": "PASSWORD", "uuid": "6174bdcb-d1de-4e33-bb60-b6eae2a293d4"}, {"username": "administrator@nucalm.com", "description": "", "secret": {"attrs": {"is_secret_modified": false, "secret_reference": {}}}, "name": "DOMAIN_CRED", "state": "ACTIVE", "editables": {}, "type": "PASSWORD", "uuid": "8b73012b-d702-4380-a533-71791b76c719"}, {"username": "admin", "description": "", "secret": {"attrs": {"is_secret_modified": false, "secret_reference": {}}}, "name": "PE_CREDS", "state": "ACTIVE", "editables": {}, "type": "PASSWORD", "uuid": "c165a2fe-1d19-4393-b476-7fe699e68e34"}, {"username": "nucalm\\administrator", "description": "", "secret": {"attrs": {"is_secret_modified": false, "secret_reference": {}}}, "name": "SQL_CREDS", "state": "ACTIVE", "editables": {}, "type": "PASSWORD", "uuid": "abd58c38-b2df-4ff0-b662-7939db84255d"}, {"username": "administrator", "description": "", "secret": {"attrs": {"is_secret_modified": false, "secret_reference": {}}}, "name": "KARAN_CRED", "state": "ACTIVE", "editables": {}, "type": "PASSWORD", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}], "package_definition_list": [{"description": "", "action_list": [{"description": "System action for installing an application", "type": "system", "uuid": "995af336-07cd-40d1-af7e-975593e6af2d", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Install_Crb_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "6722db44-6b02-4c81-99a6-1836b7684481"}], "name": "SYS_GEN__DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "ef467f22-ad65-4e9c-bc9c-d4ce320d5ae1"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Install_Crb_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask", "uuid": "1973b06b-b80e-4bed-b028-e0eaea13b852"}, {"kind": "app_task", "name": "AddToDomain", "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}, {"kind": "app_task", "name": "Sleep", "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}, {"kind": "app_task", "name": "Create VG", "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}, {"kind": "app_task", "name": "Attach VG", "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}, {"kind": "app_task", "name": "Connect Mount VG", "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}, {"kind": "app_task", "name": "Install FC", "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}, {"kind": "app_task", "name": "EnableLocalMode", "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}, {"kind": "app_task", "name": "Configure WSFC", "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}, {"kind": "app_task", "name": "Install SQL", "uuid": "823b51af-5f82-4c51-983d-deebab849118"}, {"kind": "app_task", "name": "Apply OS BPG", "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}, {"kind": "app_task", "name": "Apply SQL BPG", "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}, {"kind": "app_task", "name": "Enable AAG", "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}, {"kind": "app_task", "name": "Create AAG", "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}, {"kind": "app_task", "name": "DisableLocalMode", "uuid": "c50f49f0-f1ab-4485-a679-0fe57ebc2605"}], "name": "ddaf74d2_dag", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask", "uuid": "1973b06b-b80e-4bed-b028-e0eaea13b852"}, "edge_type": "user_defined", "type": "", "uuid": "dc670ced-4901-4d0f-a98c-c573be6030a4", "to_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}}, {"from_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}, "edge_type": "user_defined", "type": "", "uuid": "05b9925a-552b-401a-ad1a-c801e466955a", "to_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}, "edge_type": "user_defined", "type": "", "uuid": "e40e3bb6-e7bc-4810-9d64-25f8af8e68cb", "to_task_reference": {"kind": "app_task", "name": "Create VG", "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}}, {"from_task_reference": {"kind": "app_task", "name": "Create VG", "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}, "edge_type": "user_defined", "type": "", "uuid": "228b9269-a995-4a42-ba64-e555631f01a3", "to_task_reference": {"kind": "app_task", "name": "Attach VG", "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}}, {"from_task_reference": {"kind": "app_task", "name": "Attach VG", "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}, "edge_type": "user_defined", "type": "", "uuid": "289a83d1-32eb-4ad1-8622-5f617392bac0", "to_task_reference": {"kind": "app_task", "name": "Connect Mount VG", "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}}, {"from_task_reference": {"kind": "app_task", "name": "Connect Mount VG", "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}, "edge_type": "user_defined", "type": "", "uuid": "f70ca537-312d-4b54-825e-646dcdbc709c", "to_task_reference": {"kind": "app_task", "name": "Install FC", "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}}, {"from_task_reference": {"kind": "app_task", "name": "Install FC", "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}, "edge_type": "user_defined", "type": "", "uuid": "4e4cce9f-befc-479a-b0c5-2c3fa0d490c5", "to_task_reference": {"kind": "app_task", "name": "EnableLocalMode", "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}}, {"from_task_reference": {"kind": "app_task", "name": "EnableLocalMode", "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}, "edge_type": "user_defined", "type": "", "uuid": "c46789d8-d95e-4599-84d1-ef08c3f7e4a5", "to_task_reference": {"kind": "app_task", "name": "Configure WSFC", "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}}, {"from_task_reference": {"kind": "app_task", "name": "Configure WSFC", "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}, "edge_type": "user_defined", "type": "", "uuid": "08ecb857-f68c-4031-84c1-05bbea9ce2ff", "to_task_reference": {"kind": "app_task", "name": "Install SQL", "uuid": "823b51af-5f82-4c51-983d-deebab849118"}}, {"from_task_reference": {"kind": "app_task", "name": "Install SQL", "uuid": "823b51af-5f82-4c51-983d-deebab849118"}, "edge_type": "user_defined", "type": "", "uuid": "72ace1a5-c8f1-49c4-9cc4-f1f193357356", "to_task_reference": {"kind": "app_task", "name": "Apply OS BPG", "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}}, {"from_task_reference": {"kind": "app_task", "name": "Apply OS BPG", "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}, "edge_type": "user_defined", "type": "", "uuid": "b022ca56-0c61-4d6e-b046-9f397842357b", "to_task_reference": {"kind": "app_task", "name": "Apply SQL BPG", "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}}, {"from_task_reference": {"kind": "app_task", "name": "Apply SQL BPG", "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}, "edge_type": "user_defined", "type": "", "uuid": "ef277f11-18e8-470c-a6a6-0771b88861f4", "to_task_reference": {"kind": "app_task", "name": "Enable AAG", "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}}, {"from_task_reference": {"kind": "app_task", "name": "Enable AAG", "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}, "edge_type": "user_defined", "type": "", "uuid": "bce58fd9-dae9-4e21-8ec0-81dd108de7d5", "to_task_reference": {"kind": "app_task", "name": "Create AAG", "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}}, {"from_task_reference": {"kind": "app_task", "name": "Create AAG", "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}, "edge_type": "user_defined", "type": "", "uuid": "2332b369-525c-47aa-beb0-0b5e9eed4673", "to_task_reference": {"kind": "app_task", "name": "DisableLocalMode", "uuid": "c50f49f0-f1ab-4485-a679-0fe57ebc2605"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "a014c943-68f5-4ecd-ad80-059f724043f4"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "PackageInstallTask", "state": "ACTIVE", "attrs": {"script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\n# -*- Enabling and starting 'msiscsi'\nSet-Service -Name msiscsi -StartupType Automatic\nStart-Service msiscsi\n# -*- Change first Ehternet adapter name to 'Production'\nGet-NetAdapter -Name \"Ethernet\" | Rename-NetAdapter -NewName \"Production\" -ErrorAction SilentlyContinue\n# -*- Download SQL Updates\n$TempDirectory = \"C:\\Temp\"\nNew-Item -ItemType Directory -Force -Path $TempDirectory\n(New-Object System.Net.WebClient).DownloadFile(\"http://10.7.1.7/data1/ISOs/SQLServer2014-KB4052725-x64.exe\",\"$TempDirectory\\SQLServer2014-KB4052725-x64.exe\")\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "1973b06b-b80e-4bed-b028-e0eaea13b852"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "AddToDomain", "state": "ACTIVE", "attrs": {"script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"MSSQL-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Sleep", "state": "ACTIVE", "attrs": {"script": "#script\nsleep(30)", "type": "", "command_line_args": "", "exit_status": [], "script_type": "static"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Create VG", "state": "ACTIVE", "attrs": {"script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$PrismIP = \"@@{PE_IP}@@\"\n$PrismUser = \"@@{PE_CREDS.username}@@\"\n$PrismPass = \"@@{PE_CREDS.secret}@@\"\n\nadd-type @\"\n    using System.Net;\n    using System.Security.Cryptography.X509Certificates;\n    public class TrustAllCertsPolicy : ICertificatePolicy {\n        public bool CheckValidationResult(\n            ServicePoint srvPoint, X509Certificate certificate,\n            WebRequest request, int certificateProblem) {\n            return true;\n        }\n    }\n\"@\n[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy\n\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n\n$BaseURL = \"https://\" + $PrismIP + \":9440/PrismGateway/services/rest/v2.0/\"\n$Header = @{\"Authorization\" = \"Basic \"+[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($PrismUser+\":\"+$PrismPass))}\n$Type = \"application/json\"\n\n$VolumeGroupURL = $BaseURL+\"volume_groups\"\n$ContainerURL = $BaseURL+\"storage_containers\"\n\ntry {\n  $ContainerList = invoke-RestMethod -Uri $ContainerURL -Method Get -TimeoutSec 100 -Headers $Header -ContentType $Type\n  $ContainerUUID = $ContainerList.entities | where { $_.name -eq \"@@{Nutanix_Container_Name}@@\"} | select storage_container_uuid\n  $ContainerUUID = $ContainerUUID.storage_container_uuid\n\n$Body = @\"\n{\n  \"disk_list\": [\n    {\n      \"create_config\": {\n        \"size\": 1073741824,\n\t\"storage_container_uuid\": \"$ContainerUUID\"\n      },\n      \"index\": 0\n    }\n  ],\n  \"is_shared\": true,\n  \"name\": \"@@{Volume_GroupName}@@\"\n}\n\"@\n\n\t$status=Invoke-RestMethod -Uri $VolumeGroupURL -Method Post -TimeoutSec 100 -Headers $Header -ContentType $Type -Body $Body\n}\ncatch {\n    Write-output \"$_\"\n}\n\nif ($status.task_uuid -eq $null) {\n    Write-Output \"Error while creating volume group\"\n    exit 1\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Attach VG", "state": "ACTIVE", "attrs": {"script": "\n$MsSQL1_iSCSI_IQN = (Get-InitiatorPort).NodeAddress\n\n$PrismIP = \"@@{PE_IP}@@\"\n$PrismUser = \"@@{PE_CREDS.username}@@\"\n$PrismPass = \"@@{PE_CREDS.secret}@@\"\n\nadd-type @\"\n    using System.Net;\n    using System.Security.Cryptography.X509Certificates;\n    public class TrustAllCertsPolicy : ICertificatePolicy {\n        public bool CheckValidationResult(\n            ServicePoint srvPoint, X509Certificate certificate,\n            WebRequest request, int certificateProblem) {\n            return true;\n        }\n    }\n\"@\n[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy\n\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n\n$BaseURL = \"https://\" + $PrismIP + \":9440/PrismGateway/services/rest/v2.0/\"\n$Header = @{\"Authorization\" = \"Basic \"+[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($PrismUser+\":\"+$PrismPass))}\n$Type = \"application/json\"\n\n$VolumeGroupURL = $BaseURL+\"volume_groups\"\ntry {\n\t$VolumeGroupList = invoke-RestMethod -Uri $VolumeGroupURL -Method Get -TimeoutSec 100 -Headers $Header -ContentType $Type\n\t$VolumeGroupUUID = $VolumeGroupList.entities | where { $_.name -eq \"@@{Volume_GroupName}@@\"} | select uuid\n\t$VolumeGroupUUID = $VolumeGroupUUID.uuid\n\n\t$VolumeGroupAttachURL = $VolumeGroupURL+\"/$VolumeGroupUUID\"+\"/open\"\n\n$Body = @\"\n{\n  \"iscsi_client\": {\n    \"client_address\": \"$MsSQL1_iSCSI_IQN\"\n  },\n  \"operation\": \"ATTACH\"\n}\n\"@\n\n\t$status=Invoke-RestMethod -Uri $VolumeGroupAttachURL -Method Post -TimeoutSec 100 -Headers $Header -ContentType $Type -Body $Body\n}\ncatch {\n    Write-output \"$_\"\n}\n\nif ($status.value -ne $true) {\n    Write-Output \"Error while attaching volume group \"\n    exit 1\n}\nsleep 3", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Connect Mount VG", "state": "ACTIVE", "attrs": {"script": "New-IscsiTargetPortal -TargetPortalAddress @@{PE_DATA_SERVICE_IP}@@\nGet-IscsiTarget | Connect-IscsiTarget -IsPersistent $true\n\n#Initialize Disks\nif (((Get-Disk -Number 1 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\") -and ((Get-Disk -Number 2 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\")) {\n\tGet-Disk -Number 1 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 2 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 3 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 4 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 5 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 6 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 7 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 8 | Initialize-Disk -ErrorAction SilentlyContinue\n\tNew-Partition -DiskNumber 1 -UseMaximumSize -DriveLetter F -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -FileSystem NTFS -NewFileSystemLabel \"SQLINSTALL\" \n\tNew-Partition -DiskNumber 2 -UseMaximumSize -DriveLetter R -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"SQLBCK\"\n\tNew-Partition -DiskNumber 3 -UseMaximumSize -DriveLetter G -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"DATA01\" \n\tNew-Partition -DiskNumber 4 -UseMaximumSize -DriveLetter H -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"DATA02\"\n    New-Partition -DiskNumber 5 -UseMaximumSize -DriveLetter I -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDB01\" \n\tNew-Partition -DiskNumber 6 -UseMaximumSize -DriveLetter J -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDB02\"\n    New-Partition -DiskNumber 7 -UseMaximumSize -DriveLetter T -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDBLOG01\" \n\tNew-Partition -DiskNumber 8 -UseMaximumSize -DriveLetter L -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"ULOG01\"\n\n} else {\n\tWrite-Output \"Disks does not exists or not healthy.`nIf you havent added disks please add 8 disk.\"\n\texit 1\n}\n\nif (\"@@{calm_array_index}@@\" -eq \"0\"){\n  if ((Get-Disk -Number 9 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\"){\n      Get-Disk -Number 9 | Initialize-Disk -ErrorAction SilentlyContinue\n      New-Partition -DiskNumber 9 -UseMaximumSize -DriveLetter W -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -FileSystem NTFS -NewFileSystemLabel \"Witness\" \n  } else {\n      Write-Output \"Witness Disk does not exists or not healthy.`nIf you havent added disks please add a volume group and attach.`n `t - Witness : 1GB\"\n      exit 1\n  }\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Install FC", "state": "ACTIVE", "attrs": {"script": "Install-WindowsFeature -Name Failover-Clustering -IncludeManagementTools\n\nif (-not (get-WindowsFeature -Name Failover-Clustering -ErrorAction SilentlyContinue | select -ExpandProperty Installed)){\n\tWrite-output \"Failover Clustering is not installed\"\n\texit 1\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "EnableLocalMode", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=LOCAL\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Configure WSFC", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$adminname=\"@@{DOMAIN_CRED.username}@@\"\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n\n$testScript = {\n\t$Nodes=\"@@{calm_array_address}@@\".split(',')\n    if(Test-Cluster -Node $Nodes){\n        Return $True\n    }\n    else\n    {\n        Return $False\n    }\n} \n\n$TestStatus = Invoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $testScript\n\nif ($TestStatus -eq $false){\nWrite-Output \"Failed\"\nExit 1\n}\n\nforeach ( $node in $(\"@@{calm_array_address}@@\".split(',')) ){Test-WSMan $node}\n\n$ClusterCreate = {\n    #Import-Module FailoverClusters\n    $Nodes=\"@@{calm_array_address}@@\".split(',')\n    New-Cluster -Name @@{FAILOVER_CLUSTER_NAME}@@ -Node $Nodes -StaticAddress @@{FAILOVER_VIP}@@\n} \n\n$ClusterStatus = Invoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $ClusterCreate\n\nif (!$ClusterStatus.Name){\n    Write-Output \"Failed creating CLuster\"\n}\n\n$RenameClusterDisks = {\n    #Rename Cluster Disks\n    $ClusterDisks =  Get-CimInstance -ClassName MSCluster_Resource -Namespace root/mscluster -Filter \"type = 'Physical Disk'\"\n    foreach ($Disk in $ClusterDisks) {\n    $DiskResource = Get-CimAssociatedInstance -InputObject $Disk -ResultClass MSCluster_DiskPartition\n        if (-not ($DiskResource.VolumeLabel -eq $Disk.Name)) {\n        Invoke-CimMethod -InputObject $Disk -MethodName Rename -Arguments @{newName = $DiskResource.VolumeLabel}\n        }\n    }\n} \n\nInvoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $RenameClusterDisks", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Install SQL", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n    Install-WindowsFeature -IncludeAllSubFeature -ErrorAction Stop \"Net-Framework-Core\"\n    $DOMAINNAME=(Get-WmiObject Win32_ComputerSystem).Domain\n    $setupDriveLetter = \"D:\"\n    $setupPath = \"$setupDriveLetter\\setup.exe\"\n\t$silentArgs = \"/IACCEPTSQLSERVERLICENSETERMS /Q /ACTION=install /FEATURES=SQLENGINE,FULLTEXT,SSMS,ADV_SSMS /AGTSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /AGTSVCPASSWORD=@@{SQL_CREDS.secret}@@ /SQLSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /SQLSVCPASSWORD=@@{SQL_CREDS.secret}@@ /SQLSYSADMINACCOUNTS=`\"$DOMAINNAME\\Domain Admins`\" /ISSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /ISSVCPASSWORD=@@{SQL_CREDS.secret}@@ /ASSYSADMINACCOUNTS=`\"@@{SQL_CREDS.username}@@`\" /INSTANCEID=MSSQLSERVER /INSTANCENAME=MSSQLSERVER /UPDATEENABLED=True /UPDATESOURCE=`\"C:\\Temp`\" /INDICATEPROGRESS /TCPENABLED=1 /INSTALLSQLDATADIR=`\"F:\\MSSQL`\" /SQLUSERDBLOGDIR=`\"L:\\MSSQL`\" /SQLTEMPDBLOGDIR=`\"T:\\MSSQL`\"\"\n\t$validExitCodes = @(0)\n\n    $install = Start-Process -FilePath $setupPath -ArgumentList $silentArgs -Wait -NoNewWindow -PassThru\n    $install.WaitForExit()\n    $exitCode = $install.ExitCode\n    $install.Dispose()\n    \n    Write-Output \"SQL Failover Cluster Installation exited with `'$exitCode`'.\"\n      if ($validExitCodes -notcontains $exitCode) {\n          Write-Output \"Running [`\"$setupPath`\" $silentArgs] was not successful. Exit code was '$exitCode'. See log for possible error messages.\"\n\t\t  exit 1\n    }\n\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "823b51af-5f82-4c51-983d-deebab849118"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Apply OS BPG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n  $start_time = Get-Date\n\n  $TempDirectory = \"C:\\Temp\"\n  $RktTemp = \"$TempDirectory\\rktools.2003\"\n\n  $url = \"@@{BPG_RKTOOLS_URL}@@\"\n  $filePath = \"$TempDirectory\\rktools.exe\"\n\n  New-Item -ItemType Directory -Force -Path $TempDirectory\n  (New-Object System.Net.WebClient).DownloadFile($url,$filePath)\n\n  & $filePath /Q /T:\"$RktTemp\" /C\n  \n  Start-Sleep 10\n\n  $PackageName = \"rktools.2003\"\n  $setupPath = \"C:\\Windows\\System32\\msiexec.exe\"\n  $silentArgs = \"/i $RktTemp\\rktools.msi /qn\"\n  $validExitCodes = @(0)\n\n  Write-Output \"Installing $PackageName....\"\n\n  $install = Start-Process -FilePath $setupPath -ArgumentList $silentArgs -Wait -NoNewWindow -PassThru\n  $install.WaitForExit()\n\n  $exitCode = $install.ExitCode\n  $install.Dispose()\n\n  Write-Output \"Command [`\"$setupPath`\" $silentArgs] exited with `'$exitCode`'.\"\n  if ($validExitCodes -notcontains $exitCode) {\n  Write-Output \"Running [`\"$setupPath`\" $silentArgs] was not successful. Exit code was '$exitCode'. See log for possible error messages.\"\n  exit 1\n  }\n\n  # OS related tunning\n  # Set Windows Power Options to High Performance\n  powercfg -s 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c\n\n  #Grant Memory privileges to user \n  $ntrights_cli = \"C:\\Program Files (x86)\\Windows Resource Kits\\Tools\\ntrights.exe\"\n  & $ntrights_cli -u \"NT SERVICE\\MSSQLSERVER\" +r SeLockMemoryPrivilege\n  & $ntrights_cli -u \"NT SERVICE\\MSSQLSERVER\" +r SeManageVolumePrivilege\n\n\n  Write-Output \"Time taken: $((Get-Date).Subtract($start_time).seconds) Second(s)\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Apply SQL BPG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n  $start_time = Get-Date\n\n  $TempDirectory = \"C:\\Temp\"\n  $sqladdparms_cli = \"$TempDirectory\\Add-SqlServerStartupParameter.ps1\"\n  $TSQLSCRIPTSDIR = \"$TempDirectory\\TSQL_Scripts\"\n  New-Item -ItemType Directory -Force -Path $TSQLSCRIPTSDIR\n  \n  Set-Content -Path \"$sqladdparms_cli\" -Value '\nparam(\n    ## The parameter you wish to add\n    [Parameter(Mandatory = $true)]\n    $StartupParameter\n)\n\n$hklmRootNode = \"HKLM:\\SOFTWARE\\Microsoft\\Microsoft SQL Server\"\n\n$props = Get-ItemProperty \"$hklmRootNode\\Instance Names\\SQL\"\n$instances = $props.psobject.properties | ?{$_.Value -like \"MSSQL*\"} | select Value\n\n$instances | %{\n    $inst = $_.Value;\n    $regKey = \"$hklmRootNode\\$inst\\MSSQLServer\\Parameters\"\n    $props = Get-ItemProperty $regKey\n    $params = $props.psobject.properties | ?{$_.Name -like \"SQLArg*\"} | select Name, Value\n    #$params | ft -AutoSize\n    $hasFlag = $false\n    foreach ($param in $params) {\n        if($param.Value -eq $StartupParameter) {\n            $hasFlag = $true\n            break;\n        }\n    }\n    if (-not $hasFlag) {\n        \"Adding $StartupParameter\"\n        $newRegProp = \"SQLArg\"+($params.Count)\n        Set-ItemProperty -Path $regKey -Name $newRegProp -Value $StartupParameter\n    } else {\n        \"$StartupParameter already set\"\n    }\n}'\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\01-ChangeTempDB.sql\" -Value \"use master`r`n\ngo`r`n\nAlter database tempdb modify file (name = tempdev, filename = 'I:\\TEMPDB01\\tempdb01.mdf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb modify file (name = templog, filename = 'T:\\TempDB-logs01\\templog01.ldf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev02, filename = 'I:\\TEMPDB01\\tempdb02.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev03, filename = 'J:\\TEMPDB02\\tempdb03.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev04, filename = 'J:\\TEMPDB02\\tempdb04.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\n`r`n\nALTER DATABASE [tempdb] MODIFY FILE (NAME=N'tempdev', NEWNAME=N'tempdev01')`r`n\nGO`r`n\nALTER DATABASE [tempdb] MODIFY FILE (NAME=N'templog', NEWNAME=N'templog01')`r`n\nGO\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\02-IncreaseTempDB_logs.sql\" -Value \"Use master`r`n\ngo`r`n\nALTER DATABASE tempdb MODIFY FILE (NAME = templog01, filename = 'T:\\TempDB-logs01\\templog01.ldf', SIZE`r`n\n= 8096);`r`n\nGO`r`n\nALTER DATABASE tempdb MODIFY FILE (NAME = templog01, FILENAME = 'T:\\TempDB-logs01\\templog01.ldf', SIZE`r`n\n= 12288);`r`n\nGO\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\03-SQL_set_memory.sql\" -Value \"USE master;`r`n\nexec sp_configure 'show advanced options', 1;`r`n\nRECONFIGURE;`r`n\nGO`r`n\nDECLARE `r`n\n        @total_mem decimal (10,0),`r`n\n\t\t@min int,`r`n\n\t\t@max int`r`n\nSELECT `r`n\n   --SELECT (physical_memory_kb/1024) AS Server_Physical_Memory_MB`r`n\n  @total_mem = (physical_memory_kb/1024)`r`n\nFROM sys.dm_os_sys_info`r`n\n`r`n\nset @min = @total_mem * 0.1`r`n\nset @max = @total_mem * 0.85`r`n\nprint @min`r`n\nprint @max`r`n\n--print @total_mem`r`n\n`r`n\n`r`n\nEXEC sp_configure 'min server memory (MB)',@min`r`n\nEXEC sp_configure 'max server memory (MB)',@max`r`n\nRECONFIGURE\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\04-SQL-ChangeDefaultPaths.sql\" -Value \"USE [master]`r`n\nGO`r`n\n-- Change default location for data files`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'DefaultData',`r`n\nREG_SZ,`r`n\nN'G:\\SQLDATA01'`r`n\nGO`r`n\n-- Change default location for log files`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'DefaultLog',`r`n\nREG_SZ,`r`n\nN'L:\\UserDB-logs01'`r`n\nGO`r`n\n-- Change default location for backups`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'BackupDirectory',`r`n\nREG_SZ,`r`n\nN'R:\\SQLBACK'`r`n\nGO\"\n\n  #create directories\n  mkdir G:\\SQLDATA01\\\n  mkdir H:\\SQLDATA02\\\n  mkdir I:\\TEMPDB01\\\n  mkdir J:\\TEMPDB02\\\n  mkdir L:\\UserDB-logs01\\\n  mkdir T:\\TempDB-logs01\\\n  mkdir R:\\SQLBACK\n\n  #ADD SQL T parameters \n  #T1117 This parameter forces MS SQL Server to grow all database files uniformly\n  #T1118 This parameter forces MS SQL Server to use full extents only\n  & $sqladdparms_cli '-T1117'\n  & $sqladdparms_cli '-T1118'\n  restart-service MSSQL* -force\n\n  #import powershell SQL module\n  import-module \"sqlps\" -DisableNameChecking\n\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\01-ChangeTempDB.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\02-IncreaseTempDB_logs.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\03-SQL_set_memory.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\04-SQL-ChangeDefaultPaths.sql\"\n\n  #Delete original SQL temp files\n  stop-service MSSQL* \n  Start-Sleep 5\n  rm \"F:\\MSSQL\\MSSQL12.MSSQLSERVER\\MSSQL\\DATA\\temp*\"\n\n  start-service MSSQL* \n  wmic useraccount get sid\n  Write-Output \"Time taken: $((Get-Date).Subtract($start_time).seconds) Second(s)\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Enable AAG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n  #Variable for T-SQL command\n  $netbios = \"@@{DOMAIN}@@\".Split(\".\")[0].ToUpper()\n  $createLogin = \"CREATE LOGIN [$netbios\\sqlservice] FROM WINDOWS; \" \n  $grantConnectPermissions = \"GRANT CONNECT ON ENDPOINT::Endpoint_AG TO [$netbios\\sqlservice];\"\n\n  Enable-SqlAlwaysOn -ServerInstance $(hostname) -Force \n  New-SqlHADREndpoint -Path \"SQLSERVER:\\SQL\\$(hostname)\\DEFAULT\" -Name \"Endpoint_AG\" -Port 5022 -EncryptionAlgorithm Aes -Encryption Required \n  Set-SqlHADREndpoint -Path \"SQLSERVER:\\SQL\\$(hostname)\\DEFAULT\\Endpoints\\Endpoint_AG\" -State Started\n  Invoke-SqlCmd -Server $(hostname) -Query $createLogin\n  Invoke-SqlCmd -Server $(hostname) -Query $grantConnectPermissions\n\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Create AAG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n  if (\"$(Get-ClusterNode | where {$_.Id -eq 1} | select -ExpandProperty Name)\" -ne \"$(hostname)\"){\n      exit\n  }\n  #Import-Module SQLPS -DisableNameCheckin\n  $AGName = '@@{SQL_CLUSTER_NAME}@@'\n  $PrimaryNode = $(hostname)\n  $IP = '@@{MSSQL_VIP}@@/255.255.240.0'\n  $replicas = @()\n\n  $cname = (Get-Cluster -name $PrimaryNode).name\n  $nodes = (get-clusternode -Cluster $cname).name\n  \n  $sqlperms = @\"\nuse [master];\nGRANT ALTER ANY AVAILABILITY GROUP TO [NT AUTHORITY\\SYSTEM];\nGRANT CONNECT SQL TO [NT AUTHORITY\\SYSTEM];\nGRANT VIEW SERVER STATE TO [NT AUTHORITY\\SYSTEM];\n\"@\n\n  foreach($node in $nodes)\n  {\n      Invoke-Sqlcmd -ServerInstance $node -Database master -Query $sqlperms\n      $replicas += New-SqlAvailabilityReplica -Name $node -EndpointUrl \"TCP://$($node):5022\" -AvailabilityMode \"SynchronousCommit\" -FailoverMode \"Automatic\" -AsTemplate -Version 12 \n  }\n\n\n  New-SqlAvailabilityGroup -Name $AGName -Path \"SQLSERVER:\\SQL\\$PrimaryNode\\DEFAULT\" -AvailabilityReplica $replicas\n  $nodes | Where-Object {$_ -ne $PrimaryNode} | ForEach-Object {Join-SqlAvailabilityGroup -path \"SQLSERVER:\\SQL\\$_\\DEFAULT\" -Name $AGName}\n  New-SqlAvailabilityGroupListener -Name $AGName -staticIP $IP -Port 1433 -Path \"SQLSERVER:\\Sql\\$PrimaryNode\\DEFAULT\\AvailabilityGroups\\$AGName\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "DisableLocalMode", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "uuid": "c50f49f0-f1ab-4485-a679-0fe57ebc2605"}], "description": "", "name": "0561ade3_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "ddaf74d2_dag", "uuid": "a014c943-68f5-4ecd-ad80-059f724043f4"}, "message_list": [], "variable_list": [], "uuid": "39551697-86bb-44b2-ac14-e499bcb3b40b"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "7bf7eecb_dag", "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "7ce7ac0f-12f4-4a9c-b72f-a8cc4a70dcb0"}], "description": "", "name": "f564b0c1_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "7bf7eecb_dag", "uuid": "7ce7ac0f-12f4-4a9c-b72f-a8cc4a70dcb0"}, "message_list": [], "variable_list": [], "uuid": "85525e2d-17c5-4d50-9841-7e3ec442d933"}}, "timeout_secs": "0", "type": "CUSTOM_PACKAGE_INSTALL", "variable_list": [], "uuid": "6722db44-6b02-4c81-99a6-1836b7684481"}], "description": "", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "ef467f22-ad65-4e9c-bc9c-d4ce320d5ae1"}, "message_list": [], "variable_list": [], "uuid": "06b5b79e-c0da-422a-84ef-a7c47bd3fda5"}, "message_list": [], "name": "action_install"}, {"description": "System action for creating an application", "type": "system", "uuid": "78017ab9-5fdb-482f-9f4e-3aec8780d8ca", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "70dd8fff-e565-4319-93fb-991bde91f0b3"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "061fff6c-35de-41c4-97c5-c97e0a6dcae6"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "b7f9db27-7f0f-4a95-b4ff-39165ba45d52"}], "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "061fff6c-35de-41c4-97c5-c97e0a6dcae6"}, "edge_type": "inherent", "type": "", "uuid": "6ba9407d-b0d6-491f-8a11-8f9f81a84af0", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "b7f9db27-7f0f-4a95-b4ff-39165ba45d52"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "70dd8fff-e565-4319-93fb-991bde91f0b3"}, "edge_type": "inherent", "type": "", "uuid": "685c262d-b48b-4fdf-af12-110c6d72a3e6", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "061fff6c-35de-41c4-97c5-c97e0a6dcae6"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "31e2c5ac-3ddb-4f09-becc-21665b0315b7"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__install_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "06b5b79e-c0da-422a-84ef-a7c47bd3fda5"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "70dd8fff-e565-4319-93fb-991bde91f0b3"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "dade7481_runbook", "uuid": "58135bbb-91b0-4e42-8f9d-8bdfb261eaad"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "061fff6c-35de-41c4-97c5-c97e0a6dcae6"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "11876906_runbook", "uuid": "e822e828-353d-4651-ad6a-f7d60355913a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "b7f9db27-7f0f-4a95-b4ff-39165ba45d52"}], "description": "", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "31e2c5ac-3ddb-4f09-becc-21665b0315b7"}, "message_list": [], "variable_list": [], "uuid": "4a8e4bc9-cdf0-47ff-84d6-8236323fa2ff"}, "message_list": [], "name": "action_create"}, {"description": "System action for uninstalling an application", "type": "system", "uuid": "5a1d7776-3d11-4925-b622-4b03d35c98b7", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Uninstall_Crb_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "3b3072d4-db39-4a0f-8859-ebfe9c2fe055"}], "name": "SYS_GEN__DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "92271d2f-5604-4ef8-9658-4d2997ed7c98"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Uninstall_Crb_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask", "uuid": "1973b06b-b80e-4bed-b028-e0eaea13b852"}, {"kind": "app_task", "name": "AddToDomain", "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}, {"kind": "app_task", "name": "Sleep", "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}, {"kind": "app_task", "name": "Create VG", "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}, {"kind": "app_task", "name": "Attach VG", "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}, {"kind": "app_task", "name": "Connect Mount VG", "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}, {"kind": "app_task", "name": "Install FC", "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}, {"kind": "app_task", "name": "EnableLocalMode", "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}, {"kind": "app_task", "name": "Configure WSFC", "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}, {"kind": "app_task", "name": "Install SQL", "uuid": "823b51af-5f82-4c51-983d-deebab849118"}, {"kind": "app_task", "name": "Apply OS BPG", "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}, {"kind": "app_task", "name": "Apply SQL BPG", "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}, {"kind": "app_task", "name": "Enable AAG", "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}, {"kind": "app_task", "name": "Create AAG", "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}, {"kind": "app_task", "name": "DisableLocalMode", "uuid": "c50f49f0-f1ab-4485-a679-0fe57ebc2605"}], "name": "ddaf74d2_dag", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask", "uuid": "1973b06b-b80e-4bed-b028-e0eaea13b852"}, "edge_type": "user_defined", "type": "", "uuid": "dc670ced-4901-4d0f-a98c-c573be6030a4", "to_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}}, {"from_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}, "edge_type": "user_defined", "type": "", "uuid": "05b9925a-552b-401a-ad1a-c801e466955a", "to_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}, "edge_type": "user_defined", "type": "", "uuid": "e40e3bb6-e7bc-4810-9d64-25f8af8e68cb", "to_task_reference": {"kind": "app_task", "name": "Create VG", "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}}, {"from_task_reference": {"kind": "app_task", "name": "Create VG", "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}, "edge_type": "user_defined", "type": "", "uuid": "228b9269-a995-4a42-ba64-e555631f01a3", "to_task_reference": {"kind": "app_task", "name": "Attach VG", "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}}, {"from_task_reference": {"kind": "app_task", "name": "Attach VG", "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}, "edge_type": "user_defined", "type": "", "uuid": "289a83d1-32eb-4ad1-8622-5f617392bac0", "to_task_reference": {"kind": "app_task", "name": "Connect Mount VG", "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}}, {"from_task_reference": {"kind": "app_task", "name": "Connect Mount VG", "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}, "edge_type": "user_defined", "type": "", "uuid": "f70ca537-312d-4b54-825e-646dcdbc709c", "to_task_reference": {"kind": "app_task", "name": "Install FC", "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}}, {"from_task_reference": {"kind": "app_task", "name": "Install FC", "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}, "edge_type": "user_defined", "type": "", "uuid": "4e4cce9f-befc-479a-b0c5-2c3fa0d490c5", "to_task_reference": {"kind": "app_task", "name": "EnableLocalMode", "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}}, {"from_task_reference": {"kind": "app_task", "name": "EnableLocalMode", "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}, "edge_type": "user_defined", "type": "", "uuid": "c46789d8-d95e-4599-84d1-ef08c3f7e4a5", "to_task_reference": {"kind": "app_task", "name": "Configure WSFC", "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}}, {"from_task_reference": {"kind": "app_task", "name": "Configure WSFC", "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}, "edge_type": "user_defined", "type": "", "uuid": "08ecb857-f68c-4031-84c1-05bbea9ce2ff", "to_task_reference": {"kind": "app_task", "name": "Install SQL", "uuid": "823b51af-5f82-4c51-983d-deebab849118"}}, {"from_task_reference": {"kind": "app_task", "name": "Install SQL", "uuid": "823b51af-5f82-4c51-983d-deebab849118"}, "edge_type": "user_defined", "type": "", "uuid": "72ace1a5-c8f1-49c4-9cc4-f1f193357356", "to_task_reference": {"kind": "app_task", "name": "Apply OS BPG", "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}}, {"from_task_reference": {"kind": "app_task", "name": "Apply OS BPG", "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}, "edge_type": "user_defined", "type": "", "uuid": "b022ca56-0c61-4d6e-b046-9f397842357b", "to_task_reference": {"kind": "app_task", "name": "Apply SQL BPG", "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}}, {"from_task_reference": {"kind": "app_task", "name": "Apply SQL BPG", "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}, "edge_type": "user_defined", "type": "", "uuid": "ef277f11-18e8-470c-a6a6-0771b88861f4", "to_task_reference": {"kind": "app_task", "name": "Enable AAG", "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}}, {"from_task_reference": {"kind": "app_task", "name": "Enable AAG", "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}, "edge_type": "user_defined", "type": "", "uuid": "bce58fd9-dae9-4e21-8ec0-81dd108de7d5", "to_task_reference": {"kind": "app_task", "name": "Create AAG", "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}}, {"from_task_reference": {"kind": "app_task", "name": "Create AAG", "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}, "edge_type": "user_defined", "type": "", "uuid": "2332b369-525c-47aa-beb0-0b5e9eed4673", "to_task_reference": {"kind": "app_task", "name": "DisableLocalMode", "uuid": "c50f49f0-f1ab-4485-a679-0fe57ebc2605"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "a014c943-68f5-4ecd-ad80-059f724043f4"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "PackageInstallTask", "state": "ACTIVE", "attrs": {"script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\n# -*- Enabling and starting 'msiscsi'\nSet-Service -Name msiscsi -StartupType Automatic\nStart-Service msiscsi\n# -*- Change first Ehternet adapter name to 'Production'\nGet-NetAdapter -Name \"Ethernet\" | Rename-NetAdapter -NewName \"Production\" -ErrorAction SilentlyContinue\n# -*- Download SQL Updates\n$TempDirectory = \"C:\\Temp\"\nNew-Item -ItemType Directory -Force -Path $TempDirectory\n(New-Object System.Net.WebClient).DownloadFile(\"http://10.7.1.7/data1/ISOs/SQLServer2014-KB4052725-x64.exe\",\"$TempDirectory\\SQLServer2014-KB4052725-x64.exe\")\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "1973b06b-b80e-4bed-b028-e0eaea13b852"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "AddToDomain", "state": "ACTIVE", "attrs": {"script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"MSSQL-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Sleep", "state": "ACTIVE", "attrs": {"script": "#script\nsleep(30)", "type": "", "command_line_args": "", "exit_status": [], "script_type": "static"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Create VG", "state": "ACTIVE", "attrs": {"script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$PrismIP = \"@@{PE_IP}@@\"\n$PrismUser = \"@@{PE_CREDS.username}@@\"\n$PrismPass = \"@@{PE_CREDS.secret}@@\"\n\nadd-type @\"\n    using System.Net;\n    using System.Security.Cryptography.X509Certificates;\n    public class TrustAllCertsPolicy : ICertificatePolicy {\n        public bool CheckValidationResult(\n            ServicePoint srvPoint, X509Certificate certificate,\n            WebRequest request, int certificateProblem) {\n            return true;\n        }\n    }\n\"@\n[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy\n\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n\n$BaseURL = \"https://\" + $PrismIP + \":9440/PrismGateway/services/rest/v2.0/\"\n$Header = @{\"Authorization\" = \"Basic \"+[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($PrismUser+\":\"+$PrismPass))}\n$Type = \"application/json\"\n\n$VolumeGroupURL = $BaseURL+\"volume_groups\"\n$ContainerURL = $BaseURL+\"storage_containers\"\n\ntry {\n  $ContainerList = invoke-RestMethod -Uri $ContainerURL -Method Get -TimeoutSec 100 -Headers $Header -ContentType $Type\n  $ContainerUUID = $ContainerList.entities | where { $_.name -eq \"@@{Nutanix_Container_Name}@@\"} | select storage_container_uuid\n  $ContainerUUID = $ContainerUUID.storage_container_uuid\n\n$Body = @\"\n{\n  \"disk_list\": [\n    {\n      \"create_config\": {\n        \"size\": 1073741824,\n\t\"storage_container_uuid\": \"$ContainerUUID\"\n      },\n      \"index\": 0\n    }\n  ],\n  \"is_shared\": true,\n  \"name\": \"@@{Volume_GroupName}@@\"\n}\n\"@\n\n\t$status=Invoke-RestMethod -Uri $VolumeGroupURL -Method Post -TimeoutSec 100 -Headers $Header -ContentType $Type -Body $Body\n}\ncatch {\n    Write-output \"$_\"\n}\n\nif ($status.task_uuid -eq $null) {\n    Write-Output \"Error while creating volume group\"\n    exit 1\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Attach VG", "state": "ACTIVE", "attrs": {"script": "\n$MsSQL1_iSCSI_IQN = (Get-InitiatorPort).NodeAddress\n\n$PrismIP = \"@@{PE_IP}@@\"\n$PrismUser = \"@@{PE_CREDS.username}@@\"\n$PrismPass = \"@@{PE_CREDS.secret}@@\"\n\nadd-type @\"\n    using System.Net;\n    using System.Security.Cryptography.X509Certificates;\n    public class TrustAllCertsPolicy : ICertificatePolicy {\n        public bool CheckValidationResult(\n            ServicePoint srvPoint, X509Certificate certificate,\n            WebRequest request, int certificateProblem) {\n            return true;\n        }\n    }\n\"@\n[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy\n\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n\n$BaseURL = \"https://\" + $PrismIP + \":9440/PrismGateway/services/rest/v2.0/\"\n$Header = @{\"Authorization\" = \"Basic \"+[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($PrismUser+\":\"+$PrismPass))}\n$Type = \"application/json\"\n\n$VolumeGroupURL = $BaseURL+\"volume_groups\"\ntry {\n\t$VolumeGroupList = invoke-RestMethod -Uri $VolumeGroupURL -Method Get -TimeoutSec 100 -Headers $Header -ContentType $Type\n\t$VolumeGroupUUID = $VolumeGroupList.entities | where { $_.name -eq \"@@{Volume_GroupName}@@\"} | select uuid\n\t$VolumeGroupUUID = $VolumeGroupUUID.uuid\n\n\t$VolumeGroupAttachURL = $VolumeGroupURL+\"/$VolumeGroupUUID\"+\"/open\"\n\n$Body = @\"\n{\n  \"iscsi_client\": {\n    \"client_address\": \"$MsSQL1_iSCSI_IQN\"\n  },\n  \"operation\": \"ATTACH\"\n}\n\"@\n\n\t$status=Invoke-RestMethod -Uri $VolumeGroupAttachURL -Method Post -TimeoutSec 100 -Headers $Header -ContentType $Type -Body $Body\n}\ncatch {\n    Write-output \"$_\"\n}\n\nif ($status.value -ne $true) {\n    Write-Output \"Error while attaching volume group \"\n    exit 1\n}\nsleep 3", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Connect Mount VG", "state": "ACTIVE", "attrs": {"script": "New-IscsiTargetPortal -TargetPortalAddress @@{PE_DATA_SERVICE_IP}@@\nGet-IscsiTarget | Connect-IscsiTarget -IsPersistent $true\n\n#Initialize Disks\nif (((Get-Disk -Number 1 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\") -and ((Get-Disk -Number 2 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\")) {\n\tGet-Disk -Number 1 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 2 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 3 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 4 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 5 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 6 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 7 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 8 | Initialize-Disk -ErrorAction SilentlyContinue\n\tNew-Partition -DiskNumber 1 -UseMaximumSize -DriveLetter F -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -FileSystem NTFS -NewFileSystemLabel \"SQLINSTALL\" \n\tNew-Partition -DiskNumber 2 -UseMaximumSize -DriveLetter R -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"SQLBCK\"\n\tNew-Partition -DiskNumber 3 -UseMaximumSize -DriveLetter G -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"DATA01\" \n\tNew-Partition -DiskNumber 4 -UseMaximumSize -DriveLetter H -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"DATA02\"\n    New-Partition -DiskNumber 5 -UseMaximumSize -DriveLetter I -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDB01\" \n\tNew-Partition -DiskNumber 6 -UseMaximumSize -DriveLetter J -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDB02\"\n    New-Partition -DiskNumber 7 -UseMaximumSize -DriveLetter T -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDBLOG01\" \n\tNew-Partition -DiskNumber 8 -UseMaximumSize -DriveLetter L -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"ULOG01\"\n\n} else {\n\tWrite-Output \"Disks does not exists or not healthy.`nIf you havent added disks please add 8 disk.\"\n\texit 1\n}\n\nif (\"@@{calm_array_index}@@\" -eq \"0\"){\n  if ((Get-Disk -Number 9 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\"){\n      Get-Disk -Number 9 | Initialize-Disk -ErrorAction SilentlyContinue\n      New-Partition -DiskNumber 9 -UseMaximumSize -DriveLetter W -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -FileSystem NTFS -NewFileSystemLabel \"Witness\" \n  } else {\n      Write-Output \"Witness Disk does not exists or not healthy.`nIf you havent added disks please add a volume group and attach.`n `t - Witness : 1GB\"\n      exit 1\n  }\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Install FC", "state": "ACTIVE", "attrs": {"script": "Install-WindowsFeature -Name Failover-Clustering -IncludeManagementTools\n\nif (-not (get-WindowsFeature -Name Failover-Clustering -ErrorAction SilentlyContinue | select -ExpandProperty Installed)){\n\tWrite-output \"Failover Clustering is not installed\"\n\texit 1\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "EnableLocalMode", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=LOCAL\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Configure WSFC", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$adminname=\"@@{DOMAIN_CRED.username}@@\"\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n\n$testScript = {\n\t$Nodes=\"@@{calm_array_address}@@\".split(',')\n    if(Test-Cluster -Node $Nodes){\n        Return $True\n    }\n    else\n    {\n        Return $False\n    }\n} \n\n$TestStatus = Invoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $testScript\n\nif ($TestStatus -eq $false){\nWrite-Output \"Failed\"\nExit 1\n}\n\nforeach ( $node in $(\"@@{calm_array_address}@@\".split(',')) ){Test-WSMan $node}\n\n$ClusterCreate = {\n    #Import-Module FailoverClusters\n    $Nodes=\"@@{calm_array_address}@@\".split(',')\n    New-Cluster -Name @@{FAILOVER_CLUSTER_NAME}@@ -Node $Nodes -StaticAddress @@{FAILOVER_VIP}@@\n} \n\n$ClusterStatus = Invoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $ClusterCreate\n\nif (!$ClusterStatus.Name){\n    Write-Output \"Failed creating CLuster\"\n}\n\n$RenameClusterDisks = {\n    #Rename Cluster Disks\n    $ClusterDisks =  Get-CimInstance -ClassName MSCluster_Resource -Namespace root/mscluster -Filter \"type = 'Physical Disk'\"\n    foreach ($Disk in $ClusterDisks) {\n    $DiskResource = Get-CimAssociatedInstance -InputObject $Disk -ResultClass MSCluster_DiskPartition\n        if (-not ($DiskResource.VolumeLabel -eq $Disk.Name)) {\n        Invoke-CimMethod -InputObject $Disk -MethodName Rename -Arguments @{newName = $DiskResource.VolumeLabel}\n        }\n    }\n} \n\nInvoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $RenameClusterDisks", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Install SQL", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n    Install-WindowsFeature -IncludeAllSubFeature -ErrorAction Stop \"Net-Framework-Core\"\n    $DOMAINNAME=(Get-WmiObject Win32_ComputerSystem).Domain\n    $setupDriveLetter = \"D:\"\n    $setupPath = \"$setupDriveLetter\\setup.exe\"\n\t$silentArgs = \"/IACCEPTSQLSERVERLICENSETERMS /Q /ACTION=install /FEATURES=SQLENGINE,FULLTEXT,SSMS,ADV_SSMS /AGTSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /AGTSVCPASSWORD=@@{SQL_CREDS.secret}@@ /SQLSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /SQLSVCPASSWORD=@@{SQL_CREDS.secret}@@ /SQLSYSADMINACCOUNTS=`\"$DOMAINNAME\\Domain Admins`\" /ISSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /ISSVCPASSWORD=@@{SQL_CREDS.secret}@@ /ASSYSADMINACCOUNTS=`\"@@{SQL_CREDS.username}@@`\" /INSTANCEID=MSSQLSERVER /INSTANCENAME=MSSQLSERVER /UPDATEENABLED=True /UPDATESOURCE=`\"C:\\Temp`\" /INDICATEPROGRESS /TCPENABLED=1 /INSTALLSQLDATADIR=`\"F:\\MSSQL`\" /SQLUSERDBLOGDIR=`\"L:\\MSSQL`\" /SQLTEMPDBLOGDIR=`\"T:\\MSSQL`\"\"\n\t$validExitCodes = @(0)\n\n    $install = Start-Process -FilePath $setupPath -ArgumentList $silentArgs -Wait -NoNewWindow -PassThru\n    $install.WaitForExit()\n    $exitCode = $install.ExitCode\n    $install.Dispose()\n    \n    Write-Output \"SQL Failover Cluster Installation exited with `'$exitCode`'.\"\n      if ($validExitCodes -notcontains $exitCode) {\n          Write-Output \"Running [`\"$setupPath`\" $silentArgs] was not successful. Exit code was '$exitCode'. See log for possible error messages.\"\n\t\t  exit 1\n    }\n\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "823b51af-5f82-4c51-983d-deebab849118"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Apply OS BPG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n  $start_time = Get-Date\n\n  $TempDirectory = \"C:\\Temp\"\n  $RktTemp = \"$TempDirectory\\rktools.2003\"\n\n  $url = \"@@{BPG_RKTOOLS_URL}@@\"\n  $filePath = \"$TempDirectory\\rktools.exe\"\n\n  New-Item -ItemType Directory -Force -Path $TempDirectory\n  (New-Object System.Net.WebClient).DownloadFile($url,$filePath)\n\n  & $filePath /Q /T:\"$RktTemp\" /C\n  \n  Start-Sleep 10\n\n  $PackageName = \"rktools.2003\"\n  $setupPath = \"C:\\Windows\\System32\\msiexec.exe\"\n  $silentArgs = \"/i $RktTemp\\rktools.msi /qn\"\n  $validExitCodes = @(0)\n\n  Write-Output \"Installing $PackageName....\"\n\n  $install = Start-Process -FilePath $setupPath -ArgumentList $silentArgs -Wait -NoNewWindow -PassThru\n  $install.WaitForExit()\n\n  $exitCode = $install.ExitCode\n  $install.Dispose()\n\n  Write-Output \"Command [`\"$setupPath`\" $silentArgs] exited with `'$exitCode`'.\"\n  if ($validExitCodes -notcontains $exitCode) {\n  Write-Output \"Running [`\"$setupPath`\" $silentArgs] was not successful. Exit code was '$exitCode'. See log for possible error messages.\"\n  exit 1\n  }\n\n  # OS related tunning\n  # Set Windows Power Options to High Performance\n  powercfg -s 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c\n\n  #Grant Memory privileges to user \n  $ntrights_cli = \"C:\\Program Files (x86)\\Windows Resource Kits\\Tools\\ntrights.exe\"\n  & $ntrights_cli -u \"NT SERVICE\\MSSQLSERVER\" +r SeLockMemoryPrivilege\n  & $ntrights_cli -u \"NT SERVICE\\MSSQLSERVER\" +r SeManageVolumePrivilege\n\n\n  Write-Output \"Time taken: $((Get-Date).Subtract($start_time).seconds) Second(s)\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Apply SQL BPG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n  $start_time = Get-Date\n\n  $TempDirectory = \"C:\\Temp\"\n  $sqladdparms_cli = \"$TempDirectory\\Add-SqlServerStartupParameter.ps1\"\n  $TSQLSCRIPTSDIR = \"$TempDirectory\\TSQL_Scripts\"\n  New-Item -ItemType Directory -Force -Path $TSQLSCRIPTSDIR\n  \n  Set-Content -Path \"$sqladdparms_cli\" -Value '\nparam(\n    ## The parameter you wish to add\n    [Parameter(Mandatory = $true)]\n    $StartupParameter\n)\n\n$hklmRootNode = \"HKLM:\\SOFTWARE\\Microsoft\\Microsoft SQL Server\"\n\n$props = Get-ItemProperty \"$hklmRootNode\\Instance Names\\SQL\"\n$instances = $props.psobject.properties | ?{$_.Value -like \"MSSQL*\"} | select Value\n\n$instances | %{\n    $inst = $_.Value;\n    $regKey = \"$hklmRootNode\\$inst\\MSSQLServer\\Parameters\"\n    $props = Get-ItemProperty $regKey\n    $params = $props.psobject.properties | ?{$_.Name -like \"SQLArg*\"} | select Name, Value\n    #$params | ft -AutoSize\n    $hasFlag = $false\n    foreach ($param in $params) {\n        if($param.Value -eq $StartupParameter) {\n            $hasFlag = $true\n            break;\n        }\n    }\n    if (-not $hasFlag) {\n        \"Adding $StartupParameter\"\n        $newRegProp = \"SQLArg\"+($params.Count)\n        Set-ItemProperty -Path $regKey -Name $newRegProp -Value $StartupParameter\n    } else {\n        \"$StartupParameter already set\"\n    }\n}'\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\01-ChangeTempDB.sql\" -Value \"use master`r`n\ngo`r`n\nAlter database tempdb modify file (name = tempdev, filename = 'I:\\TEMPDB01\\tempdb01.mdf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb modify file (name = templog, filename = 'T:\\TempDB-logs01\\templog01.ldf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev02, filename = 'I:\\TEMPDB01\\tempdb02.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev03, filename = 'J:\\TEMPDB02\\tempdb03.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev04, filename = 'J:\\TEMPDB02\\tempdb04.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\n`r`n\nALTER DATABASE [tempdb] MODIFY FILE (NAME=N'tempdev', NEWNAME=N'tempdev01')`r`n\nGO`r`n\nALTER DATABASE [tempdb] MODIFY FILE (NAME=N'templog', NEWNAME=N'templog01')`r`n\nGO\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\02-IncreaseTempDB_logs.sql\" -Value \"Use master`r`n\ngo`r`n\nALTER DATABASE tempdb MODIFY FILE (NAME = templog01, filename = 'T:\\TempDB-logs01\\templog01.ldf', SIZE`r`n\n= 8096);`r`n\nGO`r`n\nALTER DATABASE tempdb MODIFY FILE (NAME = templog01, FILENAME = 'T:\\TempDB-logs01\\templog01.ldf', SIZE`r`n\n= 12288);`r`n\nGO\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\03-SQL_set_memory.sql\" -Value \"USE master;`r`n\nexec sp_configure 'show advanced options', 1;`r`n\nRECONFIGURE;`r`n\nGO`r`n\nDECLARE `r`n\n        @total_mem decimal (10,0),`r`n\n\t\t@min int,`r`n\n\t\t@max int`r`n\nSELECT `r`n\n   --SELECT (physical_memory_kb/1024) AS Server_Physical_Memory_MB`r`n\n  @total_mem = (physical_memory_kb/1024)`r`n\nFROM sys.dm_os_sys_info`r`n\n`r`n\nset @min = @total_mem * 0.1`r`n\nset @max = @total_mem * 0.85`r`n\nprint @min`r`n\nprint @max`r`n\n--print @total_mem`r`n\n`r`n\n`r`n\nEXEC sp_configure 'min server memory (MB)',@min`r`n\nEXEC sp_configure 'max server memory (MB)',@max`r`n\nRECONFIGURE\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\04-SQL-ChangeDefaultPaths.sql\" -Value \"USE [master]`r`n\nGO`r`n\n-- Change default location for data files`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'DefaultData',`r`n\nREG_SZ,`r`n\nN'G:\\SQLDATA01'`r`n\nGO`r`n\n-- Change default location for log files`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'DefaultLog',`r`n\nREG_SZ,`r`n\nN'L:\\UserDB-logs01'`r`n\nGO`r`n\n-- Change default location for backups`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'BackupDirectory',`r`n\nREG_SZ,`r`n\nN'R:\\SQLBACK'`r`n\nGO\"\n\n  #create directories\n  mkdir G:\\SQLDATA01\\\n  mkdir H:\\SQLDATA02\\\n  mkdir I:\\TEMPDB01\\\n  mkdir J:\\TEMPDB02\\\n  mkdir L:\\UserDB-logs01\\\n  mkdir T:\\TempDB-logs01\\\n  mkdir R:\\SQLBACK\n\n  #ADD SQL T parameters \n  #T1117 This parameter forces MS SQL Server to grow all database files uniformly\n  #T1118 This parameter forces MS SQL Server to use full extents only\n  & $sqladdparms_cli '-T1117'\n  & $sqladdparms_cli '-T1118'\n  restart-service MSSQL* -force\n\n  #import powershell SQL module\n  import-module \"sqlps\" -DisableNameChecking\n\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\01-ChangeTempDB.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\02-IncreaseTempDB_logs.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\03-SQL_set_memory.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\04-SQL-ChangeDefaultPaths.sql\"\n\n  #Delete original SQL temp files\n  stop-service MSSQL* \n  Start-Sleep 5\n  rm \"F:\\MSSQL\\MSSQL12.MSSQLSERVER\\MSSQL\\DATA\\temp*\"\n\n  start-service MSSQL* \n  wmic useraccount get sid\n  Write-Output \"Time taken: $((Get-Date).Subtract($start_time).seconds) Second(s)\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Enable AAG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n  #Variable for T-SQL command\n  $netbios = \"@@{DOMAIN}@@\".Split(\".\")[0].ToUpper()\n  $createLogin = \"CREATE LOGIN [$netbios\\sqlservice] FROM WINDOWS; \" \n  $grantConnectPermissions = \"GRANT CONNECT ON ENDPOINT::Endpoint_AG TO [$netbios\\sqlservice];\"\n\n  Enable-SqlAlwaysOn -ServerInstance $(hostname) -Force \n  New-SqlHADREndpoint -Path \"SQLSERVER:\\SQL\\$(hostname)\\DEFAULT\" -Name \"Endpoint_AG\" -Port 5022 -EncryptionAlgorithm Aes -Encryption Required \n  Set-SqlHADREndpoint -Path \"SQLSERVER:\\SQL\\$(hostname)\\DEFAULT\\Endpoints\\Endpoint_AG\" -State Started\n  Invoke-SqlCmd -Server $(hostname) -Query $createLogin\n  Invoke-SqlCmd -Server $(hostname) -Query $grantConnectPermissions\n\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Create AAG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n  if (\"$(Get-ClusterNode | where {$_.Id -eq 1} | select -ExpandProperty Name)\" -ne \"$(hostname)\"){\n      exit\n  }\n  #Import-Module SQLPS -DisableNameCheckin\n  $AGName = '@@{SQL_CLUSTER_NAME}@@'\n  $PrimaryNode = $(hostname)\n  $IP = '@@{MSSQL_VIP}@@/255.255.240.0'\n  $replicas = @()\n\n  $cname = (Get-Cluster -name $PrimaryNode).name\n  $nodes = (get-clusternode -Cluster $cname).name\n  \n  $sqlperms = @\"\nuse [master];\nGRANT ALTER ANY AVAILABILITY GROUP TO [NT AUTHORITY\\SYSTEM];\nGRANT CONNECT SQL TO [NT AUTHORITY\\SYSTEM];\nGRANT VIEW SERVER STATE TO [NT AUTHORITY\\SYSTEM];\n\"@\n\n  foreach($node in $nodes)\n  {\n      Invoke-Sqlcmd -ServerInstance $node -Database master -Query $sqlperms\n      $replicas += New-SqlAvailabilityReplica -Name $node -EndpointUrl \"TCP://$($node):5022\" -AvailabilityMode \"SynchronousCommit\" -FailoverMode \"Automatic\" -AsTemplate -Version 12 \n  }\n\n\n  New-SqlAvailabilityGroup -Name $AGName -Path \"SQLSERVER:\\SQL\\$PrimaryNode\\DEFAULT\" -AvailabilityReplica $replicas\n  $nodes | Where-Object {$_ -ne $PrimaryNode} | ForEach-Object {Join-SqlAvailabilityGroup -path \"SQLSERVER:\\SQL\\$_\\DEFAULT\" -Name $AGName}\n  New-SqlAvailabilityGroupListener -Name $AGName -staticIP $IP -Port 1433 -Path \"SQLSERVER:\\Sql\\$PrimaryNode\\DEFAULT\\AvailabilityGroups\\$AGName\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "DisableLocalMode", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "uuid": "c50f49f0-f1ab-4485-a679-0fe57ebc2605"}], "description": "", "name": "0561ade3_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "ddaf74d2_dag", "uuid": "a014c943-68f5-4ecd-ad80-059f724043f4"}, "message_list": [], "variable_list": [], "uuid": "39551697-86bb-44b2-ac14-e499bcb3b40b"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "7bf7eecb_dag", "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "7ce7ac0f-12f4-4a9c-b72f-a8cc4a70dcb0"}], "description": "", "name": "f564b0c1_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "7bf7eecb_dag", "uuid": "7ce7ac0f-12f4-4a9c-b72f-a8cc4a70dcb0"}, "message_list": [], "variable_list": [], "uuid": "85525e2d-17c5-4d50-9841-7e3ec442d933"}}, "timeout_secs": "0", "type": "CUSTOM_PACKAGE_UNINSTALL", "variable_list": [], "uuid": "3b3072d4-db39-4a0f-8859-ebfe9c2fe055"}], "description": "", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "92271d2f-5604-4ef8-9658-4d2997ed7c98"}, "message_list": [], "variable_list": [], "uuid": "094213a3-cf7f-49cc-a078-cde57059e254"}, "message_list": [], "name": "action_uninstall"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "3e5018de-f01e-4eca-a7cc-dcd218dd28e9", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "8bec2a96-083d-4e74-b7d3-85a97fda8d45"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "b3daf897-f515-4a1c-bcc3-31bb84df520e"}, {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "98a266ea-a9fa-409e-b119-52b5ec710772"}], "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "8bec2a96-083d-4e74-b7d3-85a97fda8d45"}, "edge_type": "inherent", "type": "", "uuid": "46d0fd70-fcfa-4f2d-aed6-b549df7131aa", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "b3daf897-f515-4a1c-bcc3-31bb84df520e"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "b3daf897-f515-4a1c-bcc3-31bb84df520e"}, "edge_type": "inherent", "type": "", "uuid": "e2778ee9-f870-4f19-ab1b-8f29b49dfb15", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "98a266ea-a9fa-409e-b119-52b5ec710772"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "319c4a82-b34d-453b-aafd-af0ccb03cef1"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "d2728354_runbook", "uuid": "2227c943-6a01-4b4f-b5f9-d748009e7ff1"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "8bec2a96-083d-4e74-b7d3-85a97fda8d45"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "59afb4f4_runbook", "uuid": "ce606f1a-cd67-4456-8823-df98e0d20936"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "b3daf897-f515-4a1c-bcc3-31bb84df520e"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__uninstall_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "094213a3-cf7f-49cc-a078-cde57059e254"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "98a266ea-a9fa-409e-b119-52b5ec710772"}], "description": "", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "319c4a82-b34d-453b-aafd-af0ccb03cef1"}, "message_list": [], "variable_list": [], "uuid": "bd13a0dd-f313-4bba-ab81-6246f6f84264"}, "message_list": [], "name": "action_delete"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "94ee64a5-f0df-4a94-9c6e-c48f4037f249", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "fa7c918c-f107-49dd-8325-b69825494a9e"}, {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "75906625-95c1-40d2-bdb9-9082f69a653f"}], "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "fa7c918c-f107-49dd-8325-b69825494a9e"}, "edge_type": "inherent", "type": "", "uuid": "d710be3e-3bd1-48bd-beeb-17c5c5d3cf10", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "75906625-95c1-40d2-bdb9-9082f69a653f"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "c436884c-78fe-416e-9d23-1d15bfbaec04"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "0942c9ef-1ecf-4cca-bca2-be37bb12790a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "fa7c918c-f107-49dd-8325-b69825494a9e"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Package_Element_Delete_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "75906625-95c1-40d2-bdb9-9082f69a653f"}], "description": "", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "c436884c-78fe-416e-9d23-1d15bfbaec04"}, "message_list": [], "variable_list": [], "uuid": "5ae44cf1-53e7-4be8-9d88-1d4097a66fd3"}, "message_list": [], "name": "action_soft_delete"}, {"description": "System action for starting an application", "type": "system", "uuid": "2f2bd69c-0c66-47d3-bd89-7009144e9468", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "c095b9e5-b69b-4bbb-bede-eccd9f9cb3e3"}], "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "95db3cfb-655f-44d4-acfe-f2d7562592d4"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "11876906_runbook", "uuid": "e822e828-353d-4651-ad6a-f7d60355913a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "c095b9e5-b69b-4bbb-bede-eccd9f9cb3e3"}], "description": "", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "95db3cfb-655f-44d4-acfe-f2d7562592d4"}, "message_list": [], "variable_list": [], "uuid": "a715a2dc-fafc-4307-ae59-882aa08527cd"}, "message_list": [], "name": "action_start"}, {"description": "System action for restarting an application", "type": "system", "uuid": "ae08609b-1dfd-44e2-9d33-5bc6a4cbdfe9", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "9e2b7448-21fe-49b3-8ff1-daa1fc8e2b6c"}], "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "1fae0f8a-f330-4669-b7b5-6665ba2a6c73"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "4150545e_runbook", "uuid": "525f4db7-9369-478a-a1c9-99518e03e93e"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "9e2b7448-21fe-49b3-8ff1-daa1fc8e2b6c"}], "description": "", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "1fae0f8a-f330-4669-b7b5-6665ba2a6c73"}, "message_list": [], "variable_list": [], "uuid": "1d48a1db-72c0-41c8-bbf2-0ef092cd5b2f"}, "message_list": [], "name": "action_restart"}, {"description": "System action for stopping an application", "type": "system", "uuid": "e0081a08-9c2b-4d65-a8c3-403ba35241e3", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "b1a1aafa-e678-4c7e-9374-37129b788c73"}], "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "55c88734-ac21-478b-8137-0f075352ae6c"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "d2728354_runbook", "uuid": "2227c943-6a01-4b4f-b5f9-d748009e7ff1"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "b1a1aafa-e678-4c7e-9374-37129b788c73"}], "description": "", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "55c88734-ac21-478b-8137-0f075352ae6c"}, "message_list": [], "variable_list": [], "uuid": "698d4571-2dea-4c86-abef-d9c8a2b18c74"}, "message_list": [], "name": "action_stop"}], "type": "DEB", "service_local_reference_list": [{"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}], "name": "AHV MSSQL Package", "state": "ACTIVE", "version": "", "editables": {}, "message_list": [], "options": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask", "uuid": "1973b06b-b80e-4bed-b028-e0eaea13b852"}, {"kind": "app_task", "name": "AddToDomain", "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}, {"kind": "app_task", "name": "Sleep", "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}, {"kind": "app_task", "name": "Create VG", "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}, {"kind": "app_task", "name": "Attach VG", "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}, {"kind": "app_task", "name": "Connect Mount VG", "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}, {"kind": "app_task", "name": "Install FC", "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}, {"kind": "app_task", "name": "EnableLocalMode", "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}, {"kind": "app_task", "name": "Configure WSFC", "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}, {"kind": "app_task", "name": "Install SQL", "uuid": "823b51af-5f82-4c51-983d-deebab849118"}, {"kind": "app_task", "name": "Apply OS BPG", "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}, {"kind": "app_task", "name": "Apply SQL BPG", "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}, {"kind": "app_task", "name": "Enable AAG", "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}, {"kind": "app_task", "name": "Create AAG", "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}, {"kind": "app_task", "name": "DisableLocalMode", "uuid": "c50f49f0-f1ab-4485-a679-0fe57ebc2605"}], "name": "ddaf74d2_dag", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask", "uuid": "1973b06b-b80e-4bed-b028-e0eaea13b852"}, "edge_type": "user_defined", "type": "", "uuid": "dc670ced-4901-4d0f-a98c-c573be6030a4", "to_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}}, {"from_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}, "edge_type": "user_defined", "type": "", "uuid": "05b9925a-552b-401a-ad1a-c801e466955a", "to_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}, "edge_type": "user_defined", "type": "", "uuid": "e40e3bb6-e7bc-4810-9d64-25f8af8e68cb", "to_task_reference": {"kind": "app_task", "name": "Create VG", "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}}, {"from_task_reference": {"kind": "app_task", "name": "Create VG", "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}, "edge_type": "user_defined", "type": "", "uuid": "228b9269-a995-4a42-ba64-e555631f01a3", "to_task_reference": {"kind": "app_task", "name": "Attach VG", "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}}, {"from_task_reference": {"kind": "app_task", "name": "Attach VG", "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}, "edge_type": "user_defined", "type": "", "uuid": "289a83d1-32eb-4ad1-8622-5f617392bac0", "to_task_reference": {"kind": "app_task", "name": "Connect Mount VG", "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}}, {"from_task_reference": {"kind": "app_task", "name": "Connect Mount VG", "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}, "edge_type": "user_defined", "type": "", "uuid": "f70ca537-312d-4b54-825e-646dcdbc709c", "to_task_reference": {"kind": "app_task", "name": "Install FC", "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}}, {"from_task_reference": {"kind": "app_task", "name": "Install FC", "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}, "edge_type": "user_defined", "type": "", "uuid": "4e4cce9f-befc-479a-b0c5-2c3fa0d490c5", "to_task_reference": {"kind": "app_task", "name": "EnableLocalMode", "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}}, {"from_task_reference": {"kind": "app_task", "name": "EnableLocalMode", "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}, "edge_type": "user_defined", "type": "", "uuid": "c46789d8-d95e-4599-84d1-ef08c3f7e4a5", "to_task_reference": {"kind": "app_task", "name": "Configure WSFC", "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}}, {"from_task_reference": {"kind": "app_task", "name": "Configure WSFC", "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}, "edge_type": "user_defined", "type": "", "uuid": "08ecb857-f68c-4031-84c1-05bbea9ce2ff", "to_task_reference": {"kind": "app_task", "name": "Install SQL", "uuid": "823b51af-5f82-4c51-983d-deebab849118"}}, {"from_task_reference": {"kind": "app_task", "name": "Install SQL", "uuid": "823b51af-5f82-4c51-983d-deebab849118"}, "edge_type": "user_defined", "type": "", "uuid": "72ace1a5-c8f1-49c4-9cc4-f1f193357356", "to_task_reference": {"kind": "app_task", "name": "Apply OS BPG", "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}}, {"from_task_reference": {"kind": "app_task", "name": "Apply OS BPG", "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}, "edge_type": "user_defined", "type": "", "uuid": "b022ca56-0c61-4d6e-b046-9f397842357b", "to_task_reference": {"kind": "app_task", "name": "Apply SQL BPG", "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}}, {"from_task_reference": {"kind": "app_task", "name": "Apply SQL BPG", "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}, "edge_type": "user_defined", "type": "", "uuid": "ef277f11-18e8-470c-a6a6-0771b88861f4", "to_task_reference": {"kind": "app_task", "name": "Enable AAG", "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}}, {"from_task_reference": {"kind": "app_task", "name": "Enable AAG", "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}, "edge_type": "user_defined", "type": "", "uuid": "bce58fd9-dae9-4e21-8ec0-81dd108de7d5", "to_task_reference": {"kind": "app_task", "name": "Create AAG", "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}}, {"from_task_reference": {"kind": "app_task", "name": "Create AAG", "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}, "edge_type": "user_defined", "type": "", "uuid": "2332b369-525c-47aa-beb0-0b5e9eed4673", "to_task_reference": {"kind": "app_task", "name": "DisableLocalMode", "uuid": "c50f49f0-f1ab-4485-a679-0fe57ebc2605"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "a014c943-68f5-4ecd-ad80-059f724043f4"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "PackageInstallTask", "state": "ACTIVE", "attrs": {"script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\n# -*- Enabling and starting 'msiscsi'\nSet-Service -Name msiscsi -StartupType Automatic\nStart-Service msiscsi\n# -*- Change first Ehternet adapter name to 'Production'\nGet-NetAdapter -Name \"Ethernet\" | Rename-NetAdapter -NewName \"Production\" -ErrorAction SilentlyContinue\n# -*- Download SQL Updates\n$TempDirectory = \"C:\\Temp\"\nNew-Item -ItemType Directory -Force -Path $TempDirectory\n(New-Object System.Net.WebClient).DownloadFile(\"http://10.7.1.7/data1/ISOs/SQLServer2014-KB4052725-x64.exe\",\"$TempDirectory\\SQLServer2014-KB4052725-x64.exe\")\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "1973b06b-b80e-4bed-b028-e0eaea13b852"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "AddToDomain", "state": "ACTIVE", "attrs": {"script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"MSSQL-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "f5a1a9bd-1dc2-4aec-817d-f2821855c1fd"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Sleep", "state": "ACTIVE", "attrs": {"script": "#script\nsleep(30)", "type": "", "command_line_args": "", "exit_status": [], "script_type": "static"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "63f1b418-c7c4-4bef-9acd-e981d3792560"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Create VG", "state": "ACTIVE", "attrs": {"script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$PrismIP = \"@@{PE_IP}@@\"\n$PrismUser = \"@@{PE_CREDS.username}@@\"\n$PrismPass = \"@@{PE_CREDS.secret}@@\"\n\nadd-type @\"\n    using System.Net;\n    using System.Security.Cryptography.X509Certificates;\n    public class TrustAllCertsPolicy : ICertificatePolicy {\n        public bool CheckValidationResult(\n            ServicePoint srvPoint, X509Certificate certificate,\n            WebRequest request, int certificateProblem) {\n            return true;\n        }\n    }\n\"@\n[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy\n\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n\n$BaseURL = \"https://\" + $PrismIP + \":9440/PrismGateway/services/rest/v2.0/\"\n$Header = @{\"Authorization\" = \"Basic \"+[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($PrismUser+\":\"+$PrismPass))}\n$Type = \"application/json\"\n\n$VolumeGroupURL = $BaseURL+\"volume_groups\"\n$ContainerURL = $BaseURL+\"storage_containers\"\n\ntry {\n  $ContainerList = invoke-RestMethod -Uri $ContainerURL -Method Get -TimeoutSec 100 -Headers $Header -ContentType $Type\n  $ContainerUUID = $ContainerList.entities | where { $_.name -eq \"@@{Nutanix_Container_Name}@@\"} | select storage_container_uuid\n  $ContainerUUID = $ContainerUUID.storage_container_uuid\n\n$Body = @\"\n{\n  \"disk_list\": [\n    {\n      \"create_config\": {\n        \"size\": 1073741824,\n\t\"storage_container_uuid\": \"$ContainerUUID\"\n      },\n      \"index\": 0\n    }\n  ],\n  \"is_shared\": true,\n  \"name\": \"@@{Volume_GroupName}@@\"\n}\n\"@\n\n\t$status=Invoke-RestMethod -Uri $VolumeGroupURL -Method Post -TimeoutSec 100 -Headers $Header -ContentType $Type -Body $Body\n}\ncatch {\n    Write-output \"$_\"\n}\n\nif ($status.task_uuid -eq $null) {\n    Write-Output \"Error while creating volume group\"\n    exit 1\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c73ce5fb-267b-4ad6-b8d0-e52f09edd5e8"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Attach VG", "state": "ACTIVE", "attrs": {"script": "\n$MsSQL1_iSCSI_IQN = (Get-InitiatorPort).NodeAddress\n\n$PrismIP = \"@@{PE_IP}@@\"\n$PrismUser = \"@@{PE_CREDS.username}@@\"\n$PrismPass = \"@@{PE_CREDS.secret}@@\"\n\nadd-type @\"\n    using System.Net;\n    using System.Security.Cryptography.X509Certificates;\n    public class TrustAllCertsPolicy : ICertificatePolicy {\n        public bool CheckValidationResult(\n            ServicePoint srvPoint, X509Certificate certificate,\n            WebRequest request, int certificateProblem) {\n            return true;\n        }\n    }\n\"@\n[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy\n\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n\n$BaseURL = \"https://\" + $PrismIP + \":9440/PrismGateway/services/rest/v2.0/\"\n$Header = @{\"Authorization\" = \"Basic \"+[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($PrismUser+\":\"+$PrismPass))}\n$Type = \"application/json\"\n\n$VolumeGroupURL = $BaseURL+\"volume_groups\"\ntry {\n\t$VolumeGroupList = invoke-RestMethod -Uri $VolumeGroupURL -Method Get -TimeoutSec 100 -Headers $Header -ContentType $Type\n\t$VolumeGroupUUID = $VolumeGroupList.entities | where { $_.name -eq \"@@{Volume_GroupName}@@\"} | select uuid\n\t$VolumeGroupUUID = $VolumeGroupUUID.uuid\n\n\t$VolumeGroupAttachURL = $VolumeGroupURL+\"/$VolumeGroupUUID\"+\"/open\"\n\n$Body = @\"\n{\n  \"iscsi_client\": {\n    \"client_address\": \"$MsSQL1_iSCSI_IQN\"\n  },\n  \"operation\": \"ATTACH\"\n}\n\"@\n\n\t$status=Invoke-RestMethod -Uri $VolumeGroupAttachURL -Method Post -TimeoutSec 100 -Headers $Header -ContentType $Type -Body $Body\n}\ncatch {\n    Write-output \"$_\"\n}\n\nif ($status.value -ne $true) {\n    Write-Output \"Error while attaching volume group \"\n    exit 1\n}\nsleep 3", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c7ab4621-5048-4aa0-a5d2-79d56129c3e4"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Connect Mount VG", "state": "ACTIVE", "attrs": {"script": "New-IscsiTargetPortal -TargetPortalAddress @@{PE_DATA_SERVICE_IP}@@\nGet-IscsiTarget | Connect-IscsiTarget -IsPersistent $true\n\n#Initialize Disks\nif (((Get-Disk -Number 1 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\") -and ((Get-Disk -Number 2 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\")) {\n\tGet-Disk -Number 1 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 2 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 3 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 4 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 5 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 6 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 7 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 8 | Initialize-Disk -ErrorAction SilentlyContinue\n\tNew-Partition -DiskNumber 1 -UseMaximumSize -DriveLetter F -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -FileSystem NTFS -NewFileSystemLabel \"SQLINSTALL\" \n\tNew-Partition -DiskNumber 2 -UseMaximumSize -DriveLetter R -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"SQLBCK\"\n\tNew-Partition -DiskNumber 3 -UseMaximumSize -DriveLetter G -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"DATA01\" \n\tNew-Partition -DiskNumber 4 -UseMaximumSize -DriveLetter H -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"DATA02\"\n    New-Partition -DiskNumber 5 -UseMaximumSize -DriveLetter I -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDB01\" \n\tNew-Partition -DiskNumber 6 -UseMaximumSize -DriveLetter J -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDB02\"\n    New-Partition -DiskNumber 7 -UseMaximumSize -DriveLetter T -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDBLOG01\" \n\tNew-Partition -DiskNumber 8 -UseMaximumSize -DriveLetter L -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"ULOG01\"\n\n} else {\n\tWrite-Output \"Disks does not exists or not healthy.`nIf you havent added disks please add 8 disk.\"\n\texit 1\n}\n\nif (\"@@{calm_array_index}@@\" -eq \"0\"){\n  if ((Get-Disk -Number 9 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\"){\n      Get-Disk -Number 9 | Initialize-Disk -ErrorAction SilentlyContinue\n      New-Partition -DiskNumber 9 -UseMaximumSize -DriveLetter W -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -FileSystem NTFS -NewFileSystemLabel \"Witness\" \n  } else {\n      Write-Output \"Witness Disk does not exists or not healthy.`nIf you havent added disks please add a volume group and attach.`n `t - Witness : 1GB\"\n      exit 1\n  }\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c1440903-01da-4f55-8f18-6c1a2db464c6"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Install FC", "state": "ACTIVE", "attrs": {"script": "Install-WindowsFeature -Name Failover-Clustering -IncludeManagementTools\n\nif (-not (get-WindowsFeature -Name Failover-Clustering -ErrorAction SilentlyContinue | select -ExpandProperty Installed)){\n\tWrite-output \"Failover Clustering is not installed\"\n\texit 1\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c788f06d-e41d-4c68-8232-179a176e33ba"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "EnableLocalMode", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=LOCAL\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "uuid": "935909e7-3b8b-4e35-88f9-f26e7a01989c"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Configure WSFC", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$adminname=\"@@{DOMAIN_CRED.username}@@\"\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n\n$testScript = {\n\t$Nodes=\"@@{calm_array_address}@@\".split(',')\n    if(Test-Cluster -Node $Nodes){\n        Return $True\n    }\n    else\n    {\n        Return $False\n    }\n} \n\n$TestStatus = Invoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $testScript\n\nif ($TestStatus -eq $false){\nWrite-Output \"Failed\"\nExit 1\n}\n\nforeach ( $node in $(\"@@{calm_array_address}@@\".split(',')) ){Test-WSMan $node}\n\n$ClusterCreate = {\n    #Import-Module FailoverClusters\n    $Nodes=\"@@{calm_array_address}@@\".split(',')\n    New-Cluster -Name @@{FAILOVER_CLUSTER_NAME}@@ -Node $Nodes -StaticAddress @@{FAILOVER_VIP}@@\n} \n\n$ClusterStatus = Invoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $ClusterCreate\n\nif (!$ClusterStatus.Name){\n    Write-Output \"Failed creating CLuster\"\n}\n\n$RenameClusterDisks = {\n    #Rename Cluster Disks\n    $ClusterDisks =  Get-CimInstance -ClassName MSCluster_Resource -Namespace root/mscluster -Filter \"type = 'Physical Disk'\"\n    foreach ($Disk in $ClusterDisks) {\n    $DiskResource = Get-CimAssociatedInstance -InputObject $Disk -ResultClass MSCluster_DiskPartition\n        if (-not ($DiskResource.VolumeLabel -eq $Disk.Name)) {\n        Invoke-CimMethod -InputObject $Disk -MethodName Rename -Arguments @{newName = $DiskResource.VolumeLabel}\n        }\n    }\n} \n\nInvoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $RenameClusterDisks", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "38719494-d1cb-40df-b61f-0346a825bd5f"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Install SQL", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n    Install-WindowsFeature -IncludeAllSubFeature -ErrorAction Stop \"Net-Framework-Core\"\n    $DOMAINNAME=(Get-WmiObject Win32_ComputerSystem).Domain\n    $setupDriveLetter = \"D:\"\n    $setupPath = \"$setupDriveLetter\\setup.exe\"\n\t$silentArgs = \"/IACCEPTSQLSERVERLICENSETERMS /Q /ACTION=install /FEATURES=SQLENGINE,FULLTEXT,SSMS,ADV_SSMS /AGTSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /AGTSVCPASSWORD=@@{SQL_CREDS.secret}@@ /SQLSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /SQLSVCPASSWORD=@@{SQL_CREDS.secret}@@ /SQLSYSADMINACCOUNTS=`\"$DOMAINNAME\\Domain Admins`\" /ISSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /ISSVCPASSWORD=@@{SQL_CREDS.secret}@@ /ASSYSADMINACCOUNTS=`\"@@{SQL_CREDS.username}@@`\" /INSTANCEID=MSSQLSERVER /INSTANCENAME=MSSQLSERVER /UPDATEENABLED=True /UPDATESOURCE=`\"C:\\Temp`\" /INDICATEPROGRESS /TCPENABLED=1 /INSTALLSQLDATADIR=`\"F:\\MSSQL`\" /SQLUSERDBLOGDIR=`\"L:\\MSSQL`\" /SQLTEMPDBLOGDIR=`\"T:\\MSSQL`\"\"\n\t$validExitCodes = @(0)\n\n    $install = Start-Process -FilePath $setupPath -ArgumentList $silentArgs -Wait -NoNewWindow -PassThru\n    $install.WaitForExit()\n    $exitCode = $install.ExitCode\n    $install.Dispose()\n    \n    Write-Output \"SQL Failover Cluster Installation exited with `'$exitCode`'.\"\n      if ($validExitCodes -notcontains $exitCode) {\n          Write-Output \"Running [`\"$setupPath`\" $silentArgs] was not successful. Exit code was '$exitCode'. See log for possible error messages.\"\n\t\t  exit 1\n    }\n\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "823b51af-5f82-4c51-983d-deebab849118"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Apply OS BPG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n  $start_time = Get-Date\n\n  $TempDirectory = \"C:\\Temp\"\n  $RktTemp = \"$TempDirectory\\rktools.2003\"\n\n  $url = \"@@{BPG_RKTOOLS_URL}@@\"\n  $filePath = \"$TempDirectory\\rktools.exe\"\n\n  New-Item -ItemType Directory -Force -Path $TempDirectory\n  (New-Object System.Net.WebClient).DownloadFile($url,$filePath)\n\n  & $filePath /Q /T:\"$RktTemp\" /C\n  \n  Start-Sleep 10\n\n  $PackageName = \"rktools.2003\"\n  $setupPath = \"C:\\Windows\\System32\\msiexec.exe\"\n  $silentArgs = \"/i $RktTemp\\rktools.msi /qn\"\n  $validExitCodes = @(0)\n\n  Write-Output \"Installing $PackageName....\"\n\n  $install = Start-Process -FilePath $setupPath -ArgumentList $silentArgs -Wait -NoNewWindow -PassThru\n  $install.WaitForExit()\n\n  $exitCode = $install.ExitCode\n  $install.Dispose()\n\n  Write-Output \"Command [`\"$setupPath`\" $silentArgs] exited with `'$exitCode`'.\"\n  if ($validExitCodes -notcontains $exitCode) {\n  Write-Output \"Running [`\"$setupPath`\" $silentArgs] was not successful. Exit code was '$exitCode'. See log for possible error messages.\"\n  exit 1\n  }\n\n  # OS related tunning\n  # Set Windows Power Options to High Performance\n  powercfg -s 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c\n\n  #Grant Memory privileges to user \n  $ntrights_cli = \"C:\\Program Files (x86)\\Windows Resource Kits\\Tools\\ntrights.exe\"\n  & $ntrights_cli -u \"NT SERVICE\\MSSQLSERVER\" +r SeLockMemoryPrivilege\n  & $ntrights_cli -u \"NT SERVICE\\MSSQLSERVER\" +r SeManageVolumePrivilege\n\n\n  Write-Output \"Time taken: $((Get-Date).Subtract($start_time).seconds) Second(s)\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "80c64b35-315a-47cf-9856-c4a23f1afd70"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Apply SQL BPG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n  $start_time = Get-Date\n\n  $TempDirectory = \"C:\\Temp\"\n  $sqladdparms_cli = \"$TempDirectory\\Add-SqlServerStartupParameter.ps1\"\n  $TSQLSCRIPTSDIR = \"$TempDirectory\\TSQL_Scripts\"\n  New-Item -ItemType Directory -Force -Path $TSQLSCRIPTSDIR\n  \n  Set-Content -Path \"$sqladdparms_cli\" -Value '\nparam(\n    ## The parameter you wish to add\n    [Parameter(Mandatory = $true)]\n    $StartupParameter\n)\n\n$hklmRootNode = \"HKLM:\\SOFTWARE\\Microsoft\\Microsoft SQL Server\"\n\n$props = Get-ItemProperty \"$hklmRootNode\\Instance Names\\SQL\"\n$instances = $props.psobject.properties | ?{$_.Value -like \"MSSQL*\"} | select Value\n\n$instances | %{\n    $inst = $_.Value;\n    $regKey = \"$hklmRootNode\\$inst\\MSSQLServer\\Parameters\"\n    $props = Get-ItemProperty $regKey\n    $params = $props.psobject.properties | ?{$_.Name -like \"SQLArg*\"} | select Name, Value\n    #$params | ft -AutoSize\n    $hasFlag = $false\n    foreach ($param in $params) {\n        if($param.Value -eq $StartupParameter) {\n            $hasFlag = $true\n            break;\n        }\n    }\n    if (-not $hasFlag) {\n        \"Adding $StartupParameter\"\n        $newRegProp = \"SQLArg\"+($params.Count)\n        Set-ItemProperty -Path $regKey -Name $newRegProp -Value $StartupParameter\n    } else {\n        \"$StartupParameter already set\"\n    }\n}'\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\01-ChangeTempDB.sql\" -Value \"use master`r`n\ngo`r`n\nAlter database tempdb modify file (name = tempdev, filename = 'I:\\TEMPDB01\\tempdb01.mdf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb modify file (name = templog, filename = 'T:\\TempDB-logs01\\templog01.ldf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev02, filename = 'I:\\TEMPDB01\\tempdb02.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev03, filename = 'J:\\TEMPDB02\\tempdb03.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev04, filename = 'J:\\TEMPDB02\\tempdb04.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\n`r`n\nALTER DATABASE [tempdb] MODIFY FILE (NAME=N'tempdev', NEWNAME=N'tempdev01')`r`n\nGO`r`n\nALTER DATABASE [tempdb] MODIFY FILE (NAME=N'templog', NEWNAME=N'templog01')`r`n\nGO\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\02-IncreaseTempDB_logs.sql\" -Value \"Use master`r`n\ngo`r`n\nALTER DATABASE tempdb MODIFY FILE (NAME = templog01, filename = 'T:\\TempDB-logs01\\templog01.ldf', SIZE`r`n\n= 8096);`r`n\nGO`r`n\nALTER DATABASE tempdb MODIFY FILE (NAME = templog01, FILENAME = 'T:\\TempDB-logs01\\templog01.ldf', SIZE`r`n\n= 12288);`r`n\nGO\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\03-SQL_set_memory.sql\" -Value \"USE master;`r`n\nexec sp_configure 'show advanced options', 1;`r`n\nRECONFIGURE;`r`n\nGO`r`n\nDECLARE `r`n\n        @total_mem decimal (10,0),`r`n\n\t\t@min int,`r`n\n\t\t@max int`r`n\nSELECT `r`n\n   --SELECT (physical_memory_kb/1024) AS Server_Physical_Memory_MB`r`n\n  @total_mem = (physical_memory_kb/1024)`r`n\nFROM sys.dm_os_sys_info`r`n\n`r`n\nset @min = @total_mem * 0.1`r`n\nset @max = @total_mem * 0.85`r`n\nprint @min`r`n\nprint @max`r`n\n--print @total_mem`r`n\n`r`n\n`r`n\nEXEC sp_configure 'min server memory (MB)',@min`r`n\nEXEC sp_configure 'max server memory (MB)',@max`r`n\nRECONFIGURE\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\04-SQL-ChangeDefaultPaths.sql\" -Value \"USE [master]`r`n\nGO`r`n\n-- Change default location for data files`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'DefaultData',`r`n\nREG_SZ,`r`n\nN'G:\\SQLDATA01'`r`n\nGO`r`n\n-- Change default location for log files`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'DefaultLog',`r`n\nREG_SZ,`r`n\nN'L:\\UserDB-logs01'`r`n\nGO`r`n\n-- Change default location for backups`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'BackupDirectory',`r`n\nREG_SZ,`r`n\nN'R:\\SQLBACK'`r`n\nGO\"\n\n  #create directories\n  mkdir G:\\SQLDATA01\\\n  mkdir H:\\SQLDATA02\\\n  mkdir I:\\TEMPDB01\\\n  mkdir J:\\TEMPDB02\\\n  mkdir L:\\UserDB-logs01\\\n  mkdir T:\\TempDB-logs01\\\n  mkdir R:\\SQLBACK\n\n  #ADD SQL T parameters \n  #T1117 This parameter forces MS SQL Server to grow all database files uniformly\n  #T1118 This parameter forces MS SQL Server to use full extents only\n  & $sqladdparms_cli '-T1117'\n  & $sqladdparms_cli '-T1118'\n  restart-service MSSQL* -force\n\n  #import powershell SQL module\n  import-module \"sqlps\" -DisableNameChecking\n\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\01-ChangeTempDB.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\02-IncreaseTempDB_logs.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\03-SQL_set_memory.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\04-SQL-ChangeDefaultPaths.sql\"\n\n  #Delete original SQL temp files\n  stop-service MSSQL* \n  Start-Sleep 5\n  rm \"F:\\MSSQL\\MSSQL12.MSSQLSERVER\\MSSQL\\DATA\\temp*\"\n\n  start-service MSSQL* \n  wmic useraccount get sid\n  Write-Output \"Time taken: $((Get-Date).Subtract($start_time).seconds) Second(s)\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "a0af4918-fc3a-46c7-8b11-024feca40898"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Enable AAG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n  #Variable for T-SQL command\n  $netbios = \"@@{DOMAIN}@@\".Split(\".\")[0].ToUpper()\n  $createLogin = \"CREATE LOGIN [$netbios\\sqlservice] FROM WINDOWS; \" \n  $grantConnectPermissions = \"GRANT CONNECT ON ENDPOINT::Endpoint_AG TO [$netbios\\sqlservice];\"\n\n  Enable-SqlAlwaysOn -ServerInstance $(hostname) -Force \n  New-SqlHADREndpoint -Path \"SQLSERVER:\\SQL\\$(hostname)\\DEFAULT\" -Name \"Endpoint_AG\" -Port 5022 -EncryptionAlgorithm Aes -Encryption Required \n  Set-SqlHADREndpoint -Path \"SQLSERVER:\\SQL\\$(hostname)\\DEFAULT\\Endpoints\\Endpoint_AG\" -State Started\n  Invoke-SqlCmd -Server $(hostname) -Query $createLogin\n  Invoke-SqlCmd -Server $(hostname) -Query $grantConnectPermissions\n\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "5f7453e9-11a0-4197-b102-848bea481247"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Create AAG", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n  if (\"$(Get-ClusterNode | where {$_.Id -eq 1} | select -ExpandProperty Name)\" -ne \"$(hostname)\"){\n      exit\n  }\n  #Import-Module SQLPS -DisableNameCheckin\n  $AGName = '@@{SQL_CLUSTER_NAME}@@'\n  $PrimaryNode = $(hostname)\n  $IP = '@@{MSSQL_VIP}@@/255.255.240.0'\n  $replicas = @()\n\n  $cname = (Get-Cluster -name $PrimaryNode).name\n  $nodes = (get-clusternode -Cluster $cname).name\n  \n  $sqlperms = @\"\nuse [master];\nGRANT ALTER ANY AVAILABILITY GROUP TO [NT AUTHORITY\\SYSTEM];\nGRANT CONNECT SQL TO [NT AUTHORITY\\SYSTEM];\nGRANT VIEW SERVER STATE TO [NT AUTHORITY\\SYSTEM];\n\"@\n\n  foreach($node in $nodes)\n  {\n      Invoke-Sqlcmd -ServerInstance $node -Database master -Query $sqlperms\n      $replicas += New-SqlAvailabilityReplica -Name $node -EndpointUrl \"TCP://$($node):5022\" -AvailabilityMode \"SynchronousCommit\" -FailoverMode \"Automatic\" -AsTemplate -Version 12 \n  }\n\n\n  New-SqlAvailabilityGroup -Name $AGName -Path \"SQLSERVER:\\SQL\\$PrimaryNode\\DEFAULT\" -AvailabilityReplica $replicas\n  $nodes | Where-Object {$_ -ne $PrimaryNode} | ForEach-Object {Join-SqlAvailabilityGroup -path \"SQLSERVER:\\SQL\\$_\\DEFAULT\" -Name $AGName}\n  New-SqlAvailabilityGroupListener -Name $AGName -staticIP $IP -Port 1433 -Path \"SQLSERVER:\\Sql\\$PrimaryNode\\DEFAULT\\AvailabilityGroups\\$AGName\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED", "uuid": "78b85fee-7b94-4681-ae43-3d74d5b759aa"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "e9e23449-f45f-4ce0-98b4-ea9877b5dc6a"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "DisableLocalMode", "state": "ACTIVE", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "uuid": "c50f49f0-f1ab-4485-a679-0fe57ebc2605"}], "description": "", "name": "0561ade3_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "ddaf74d2_dag", "uuid": "a014c943-68f5-4ecd-ad80-059f724043f4"}, "message_list": [], "variable_list": [], "uuid": "39551697-86bb-44b2-ac14-e499bcb3b40b"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "7bf7eecb_dag", "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "7ce7ac0f-12f4-4a9c-b72f-a8cc4a70dcb0"}], "description": "", "name": "f564b0c1_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "7bf7eecb_dag", "uuid": "7ce7ac0f-12f4-4a9c-b72f-a8cc4a70dcb0"}, "message_list": [], "variable_list": [], "uuid": "85525e2d-17c5-4d50-9841-7e3ec442d933"}}, "variable_list": [], "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, {"description": "", "action_list": [{"description": "System action for installing an application", "type": "system", "uuid": "ff0cc0f6-73b2-446e-bc37-d2485d034163", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Install_Crb_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "0efc3e58-9f2b-4d9f-96a1-b97dcfc63a31"}], "name": "SYS_GEN__DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "d70a8e29-00a1-4983-ac01-6a65a0575446"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Install_Crb_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask", "uuid": "dcea441e-73d7-4c3f-9c50-87c77e5dba18"}, {"kind": "app_task", "name": "AddToDomain", "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}, {"kind": "app_task", "name": "Sleep", "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}, {"kind": "app_task", "name": "InstallController", "uuid": "18172071-87fc-4a06-906e-96104edb495a"}], "name": "7fcb2293_dag", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask", "uuid": "dcea441e-73d7-4c3f-9c50-87c77e5dba18"}, "edge_type": "user_defined", "type": "", "uuid": "e66fbc3e-16a6-43fd-88dd-6893fea20d0d", "to_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}}, {"from_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}, "edge_type": "user_defined", "type": "", "uuid": "f3392b71-5121-4c24-aa1b-f84ef1cc74c3", "to_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}, "edge_type": "user_defined", "type": "", "uuid": "8a1e8338-92ec-4029-8b9e-d2a0bf971a94", "to_task_reference": {"kind": "app_task", "name": "InstallController", "uuid": "18172071-87fc-4a06-906e-96104edb495a"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "7f813a1f-b27c-4811-97e0-49e6675ee68a"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "PackageInstallTask", "state": "ACTIVE", "attrs": {"script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "dcea441e-73d7-4c3f-9c50-87c77e5dba18"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "AddToDomain", "state": "ACTIVE", "attrs": {"script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"DDC-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Sleep", "state": "ACTIVE", "attrs": {"script": "#script\nsleep(30)", "type": "", "command_line_args": "", "exit_status": [], "script_type": "static"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "InstallController", "state": "ACTIVE", "attrs": {"script": "<#\nInstalls Xendesktop components.\nFirst instance would be installed with CONTROLLER,DESKTOPSTUDIO,LICENSESERVER.\nAnd remaining instances would be installed with CONTROLLER,DESKTOPSTUDIO.\n#>\n\nfunction InstallCitrixComponents{\n        param(\n        [Parameter(Mandatory=$true)][string] $XenDesktopServerSetup,\n        [Parameter(Mandatory=$true)][string] $Components,\n        [Parameter(Mandatory=$false)][string] $Arguements\n    )\n\n    & \"$XenDesktopServerSetup\" /quiet /nosql /configure_firewall /components $Components $Arguements\n\n}\n$DriveLetter = \"D:\"\n$XenDesktopServerSetup = \"$DriveLetter\\x64\\XenDesktop Setup\\XenDesktopServerSetup.exe\"\n\nif (\"@@{calm_array_index}@@\" -eq \"0\"){\n  InstallCitrixComponents $XenDesktopServerSetup \"CONTROLLER,DESKTOPSTUDIO,LICENSESERVER\"\n}\nelse{\n  InstallCitrixComponents $XenDesktopServerSetup \"CONTROLLER,DESKTOPSTUDIO\"\n}\n\n<#\nDownloads and installs nutanix citrix plugin\n#>\n$TempDirectory = \"C:\\Temp\"\nNew-Item -ItemType Directory -Force -Path $TempDirectory\n$NutanixAcropolisPlugin = \"@@{NutanixAcropolisPlugin}@@\"\n$NutanixAcropolisPluginFilePath = \"$TempDirectory\\NutanixAcropolis.msi\"\n$NutanixAcropolisPluginInstallPath = \"@@{NutanixAcropolis_Installed_Path}@@\"\n\nWrite-Output \"Downloading the pulgin\"\ntry{\n  (New-Object System.Net.WebClient).DownloadFile($NutanixAcropolisPlugin,$NutanixAcropolisPluginFilePath)\n  Write-Output \"Pulgin has been downloaded\"\n\n  msiexec /i $NutanixAcropolisPluginFilePath /qn\n  sleep(40)\n  Rename-Item -LiteralPath C:\\[INSTALLFOLDER] -NewName \"NutanixAcropolis\"\n  Move-Item -Path C:\\NutanixAcropolis -Destination \"$NutanixAcropolisPluginInstallPath\"\n\n  & \"C:\\Program Files\\Common Files\\Citrix\\HCLPlugins\\RegisterPlugins.exe\" -PluginsRoot \"C:\\Program Files\\Common Files\\Citrix\\HCLPlugins\\CitrixMachineCreation\\v1.0.0.0\"\n\n  Restart-Service -Name \"Citrix Host Service\"\n  Restart-Service -Name \"Citrix Broker Service\"\n  Restart-Service -Name \"Citrix Machine Creation Service\"\n}\ncatch\n{\n\tWrite-Output \"$_\"\n    exit 1\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "18172071-87fc-4a06-906e-96104edb495a"}], "description": "", "name": "ff975c07_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "7fcb2293_dag", "uuid": "7f813a1f-b27c-4811-97e0-49e6675ee68a"}, "message_list": [], "variable_list": [], "uuid": "d8049132-b9b6-4436-8300-84536da659c9"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "5d9a3914_dag", "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "419be271-1104-4c5e-bc24-f7c86d74233b"}], "description": "", "name": "086f090e_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "5d9a3914_dag", "uuid": "419be271-1104-4c5e-bc24-f7c86d74233b"}, "message_list": [], "variable_list": [], "uuid": "c6144a5a-2a58-4b20-8cc8-5b6f562fed68"}}, "timeout_secs": "0", "type": "CUSTOM_PACKAGE_INSTALL", "variable_list": [], "uuid": "0efc3e58-9f2b-4d9f-96a1-b97dcfc63a31"}], "description": "", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "d70a8e29-00a1-4983-ac01-6a65a0575446"}, "message_list": [], "variable_list": [], "uuid": "785d636f-4375-4b31-88a1-4cdd226c2cb8"}, "message_list": [], "name": "action_install"}, {"description": "System action for creating an application", "type": "system", "uuid": "fd3a171b-8ba5-46e2-965b-9a804e0d3d46", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "268741a6-fc77-410e-a811-84ad371063ba"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "2326319b-4bb7-422f-904e-4dd4152b3217"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "fcf2e50a-3f57-4c5f-b819-abf84660b4a2"}], "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "2326319b-4bb7-422f-904e-4dd4152b3217"}, "edge_type": "inherent", "type": "", "uuid": "11071c71-0ba5-41c5-91aa-52ceec275fe4", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "fcf2e50a-3f57-4c5f-b819-abf84660b4a2"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "268741a6-fc77-410e-a811-84ad371063ba"}, "edge_type": "inherent", "type": "", "uuid": "f92fd129-ea5c-4e1a-8aab-16d5416d2e0a", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "2326319b-4bb7-422f-904e-4dd4152b3217"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "e7a9c870-fa2e-4816-a6b4-23bfb3140ef3"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__install_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "785d636f-4375-4b31-88a1-4cdd226c2cb8"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "268741a6-fc77-410e-a811-84ad371063ba"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "29e91e9c_runbook", "uuid": "042fc435-a86c-4df0-b6f6-4cba2968e264"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "2326319b-4bb7-422f-904e-4dd4152b3217"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "c1427948_runbook", "uuid": "631cac91-4b75-4c10-84ab-a2b6017c6296"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "fcf2e50a-3f57-4c5f-b819-abf84660b4a2"}], "description": "", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "e7a9c870-fa2e-4816-a6b4-23bfb3140ef3"}, "message_list": [], "variable_list": [], "uuid": "5aead859-6a32-4867-8cc9-3c145e0be8c1"}, "message_list": [], "name": "action_create"}, {"description": "System action for uninstalling an application", "type": "system", "uuid": "e00fcf85-bfac-42f6-be64-400712264136", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Uninstall_Crb_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "043b5974-22b0-43ad-9922-18277d932365"}], "name": "SYS_GEN__DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "7922a529-b11f-4537-b04b-23dbf6dee36d"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Uninstall_Crb_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask", "uuid": "dcea441e-73d7-4c3f-9c50-87c77e5dba18"}, {"kind": "app_task", "name": "AddToDomain", "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}, {"kind": "app_task", "name": "Sleep", "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}, {"kind": "app_task", "name": "InstallController", "uuid": "18172071-87fc-4a06-906e-96104edb495a"}], "name": "7fcb2293_dag", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask", "uuid": "dcea441e-73d7-4c3f-9c50-87c77e5dba18"}, "edge_type": "user_defined", "type": "", "uuid": "e66fbc3e-16a6-43fd-88dd-6893fea20d0d", "to_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}}, {"from_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}, "edge_type": "user_defined", "type": "", "uuid": "f3392b71-5121-4c24-aa1b-f84ef1cc74c3", "to_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}, "edge_type": "user_defined", "type": "", "uuid": "8a1e8338-92ec-4029-8b9e-d2a0bf971a94", "to_task_reference": {"kind": "app_task", "name": "InstallController", "uuid": "18172071-87fc-4a06-906e-96104edb495a"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "7f813a1f-b27c-4811-97e0-49e6675ee68a"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "PackageInstallTask", "state": "ACTIVE", "attrs": {"script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "dcea441e-73d7-4c3f-9c50-87c77e5dba18"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "AddToDomain", "state": "ACTIVE", "attrs": {"script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"DDC-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Sleep", "state": "ACTIVE", "attrs": {"script": "#script\nsleep(30)", "type": "", "command_line_args": "", "exit_status": [], "script_type": "static"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "InstallController", "state": "ACTIVE", "attrs": {"script": "<#\nInstalls Xendesktop components.\nFirst instance would be installed with CONTROLLER,DESKTOPSTUDIO,LICENSESERVER.\nAnd remaining instances would be installed with CONTROLLER,DESKTOPSTUDIO.\n#>\n\nfunction InstallCitrixComponents{\n        param(\n        [Parameter(Mandatory=$true)][string] $XenDesktopServerSetup,\n        [Parameter(Mandatory=$true)][string] $Components,\n        [Parameter(Mandatory=$false)][string] $Arguements\n    )\n\n    & \"$XenDesktopServerSetup\" /quiet /nosql /configure_firewall /components $Components $Arguements\n\n}\n$DriveLetter = \"D:\"\n$XenDesktopServerSetup = \"$DriveLetter\\x64\\XenDesktop Setup\\XenDesktopServerSetup.exe\"\n\nif (\"@@{calm_array_index}@@\" -eq \"0\"){\n  InstallCitrixComponents $XenDesktopServerSetup \"CONTROLLER,DESKTOPSTUDIO,LICENSESERVER\"\n}\nelse{\n  InstallCitrixComponents $XenDesktopServerSetup \"CONTROLLER,DESKTOPSTUDIO\"\n}\n\n<#\nDownloads and installs nutanix citrix plugin\n#>\n$TempDirectory = \"C:\\Temp\"\nNew-Item -ItemType Directory -Force -Path $TempDirectory\n$NutanixAcropolisPlugin = \"@@{NutanixAcropolisPlugin}@@\"\n$NutanixAcropolisPluginFilePath = \"$TempDirectory\\NutanixAcropolis.msi\"\n$NutanixAcropolisPluginInstallPath = \"@@{NutanixAcropolis_Installed_Path}@@\"\n\nWrite-Output \"Downloading the pulgin\"\ntry{\n  (New-Object System.Net.WebClient).DownloadFile($NutanixAcropolisPlugin,$NutanixAcropolisPluginFilePath)\n  Write-Output \"Pulgin has been downloaded\"\n\n  msiexec /i $NutanixAcropolisPluginFilePath /qn\n  sleep(40)\n  Rename-Item -LiteralPath C:\\[INSTALLFOLDER] -NewName \"NutanixAcropolis\"\n  Move-Item -Path C:\\NutanixAcropolis -Destination \"$NutanixAcropolisPluginInstallPath\"\n\n  & \"C:\\Program Files\\Common Files\\Citrix\\HCLPlugins\\RegisterPlugins.exe\" -PluginsRoot \"C:\\Program Files\\Common Files\\Citrix\\HCLPlugins\\CitrixMachineCreation\\v1.0.0.0\"\n\n  Restart-Service -Name \"Citrix Host Service\"\n  Restart-Service -Name \"Citrix Broker Service\"\n  Restart-Service -Name \"Citrix Machine Creation Service\"\n}\ncatch\n{\n\tWrite-Output \"$_\"\n    exit 1\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "18172071-87fc-4a06-906e-96104edb495a"}], "description": "", "name": "ff975c07_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "7fcb2293_dag", "uuid": "7f813a1f-b27c-4811-97e0-49e6675ee68a"}, "message_list": [], "variable_list": [], "uuid": "d8049132-b9b6-4436-8300-84536da659c9"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "5d9a3914_dag", "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "419be271-1104-4c5e-bc24-f7c86d74233b"}], "description": "", "name": "086f090e_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "5d9a3914_dag", "uuid": "419be271-1104-4c5e-bc24-f7c86d74233b"}, "message_list": [], "variable_list": [], "uuid": "c6144a5a-2a58-4b20-8cc8-5b6f562fed68"}}, "timeout_secs": "0", "type": "CUSTOM_PACKAGE_UNINSTALL", "variable_list": [], "uuid": "043b5974-22b0-43ad-9922-18277d932365"}], "description": "", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "7922a529-b11f-4537-b04b-23dbf6dee36d"}, "message_list": [], "variable_list": [], "uuid": "8acf3f85-5155-48b8-b8de-a5fe74733282"}, "message_list": [], "name": "action_uninstall"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "0a7be465-facb-4550-a296-51cda12ac360", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "cf497d26-6d3a-4618-8f36-51847b8a7145"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "f62713fc-2691-4d2e-a21c-cd2bc483373c"}, {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "a933b057-b97b-4697-ba1b-2481199b417b"}], "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "cf497d26-6d3a-4618-8f36-51847b8a7145"}, "edge_type": "inherent", "type": "", "uuid": "8973763b-1fee-4cfb-81cb-8be144bf141d", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "f62713fc-2691-4d2e-a21c-cd2bc483373c"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "f62713fc-2691-4d2e-a21c-cd2bc483373c"}, "edge_type": "inherent", "type": "", "uuid": "b98ccd27-3083-4b9f-a010-763c6f375749", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "a933b057-b97b-4697-ba1b-2481199b417b"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "aeaef3a5-5f64-4739-b6ee-394b7af098af"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2d07af0_runbook", "uuid": "08fe1064-8629-40b1-84b8-72356d4ca6ee"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "cf497d26-6d3a-4618-8f36-51847b8a7145"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "22428294_runbook", "uuid": "de943f5f-693e-4a9c-9642-5f51b1e2e081"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "f62713fc-2691-4d2e-a21c-cd2bc483373c"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__uninstall_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "8acf3f85-5155-48b8-b8de-a5fe74733282"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "a933b057-b97b-4697-ba1b-2481199b417b"}], "description": "", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "aeaef3a5-5f64-4739-b6ee-394b7af098af"}, "message_list": [], "variable_list": [], "uuid": "3f60e82c-0218-4bf0-8487-397c2477c252"}, "message_list": [], "name": "action_delete"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "55cc829e-a959-422d-9e52-733842b80f36", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "d8152c23-5287-4964-a384-91782ee8538f"}, {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "a9ef8876-6741-4724-b2c9-00fea596ba45"}], "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "d8152c23-5287-4964-a384-91782ee8538f"}, "edge_type": "inherent", "type": "", "uuid": "de4e645e-1e64-4101-8a23-5edd47e6ed50", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "a9ef8876-6741-4724-b2c9-00fea596ba45"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "c258a66b-28bb-48dd-ba21-2054cd51a4f1"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "d24a316a-2dee-4081-9d10-b5986a67ad23"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "d8152c23-5287-4964-a384-91782ee8538f"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Package_Element_Delete_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "a9ef8876-6741-4724-b2c9-00fea596ba45"}], "description": "", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "c258a66b-28bb-48dd-ba21-2054cd51a4f1"}, "message_list": [], "variable_list": [], "uuid": "4512e707-a0b3-4531-9936-89335ce0dea1"}, "message_list": [], "name": "action_soft_delete"}, {"description": "System action for starting an application", "type": "system", "uuid": "fd8699ae-748e-4332-a2f6-d42bce6dd508", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "a3282267-26e3-4770-9e28-9c059e61873c"}], "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "1aee2269-a22e-4000-833d-c22034008154"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "c1427948_runbook", "uuid": "631cac91-4b75-4c10-84ab-a2b6017c6296"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "a3282267-26e3-4770-9e28-9c059e61873c"}], "description": "", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "1aee2269-a22e-4000-833d-c22034008154"}, "message_list": [], "variable_list": [], "uuid": "10c6cf52-5a49-4159-a90e-b27099e528d5"}, "message_list": [], "name": "action_start"}, {"description": "System action for restarting an application", "type": "system", "uuid": "219861c2-82fc-4160-9db1-8af520cdb401", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "2ca3373e-67b4-4043-abe6-659859c2f989"}], "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "cb902419-9ee6-491a-a63a-c53448fa2caa"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "73c06dcc_runbook", "uuid": "9a54b194-21f3-4c63-b3ef-d53d30553649"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "2ca3373e-67b4-4043-abe6-659859c2f989"}], "description": "", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "cb902419-9ee6-491a-a63a-c53448fa2caa"}, "message_list": [], "variable_list": [], "uuid": "d687db4f-5282-4e21-a44b-2ecb6aa4e819"}, "message_list": [], "name": "action_restart"}, {"description": "System action for stopping an application", "type": "system", "uuid": "20bcb14b-1ffd-4c0b-ad85-1db7e6b196f1", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "d34bdf16-7e1c-487c-9a76-f30b4fae5e13"}], "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "ef42a135-bbd1-439a-9972-d529a01296b6"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2d07af0_runbook", "uuid": "08fe1064-8629-40b1-84b8-72356d4ca6ee"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "d34bdf16-7e1c-487c-9a76-f30b4fae5e13"}], "description": "", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "ef42a135-bbd1-439a-9972-d529a01296b6"}, "message_list": [], "variable_list": [], "uuid": "b4973488-3cb2-46fc-bd8a-b20eddda8221"}, "message_list": [], "name": "action_stop"}], "type": "DEB", "service_local_reference_list": [{"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}], "name": "AHV DDC Package", "state": "ACTIVE", "version": "", "editables": {}, "message_list": [], "options": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask", "uuid": "dcea441e-73d7-4c3f-9c50-87c77e5dba18"}, {"kind": "app_task", "name": "AddToDomain", "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}, {"kind": "app_task", "name": "Sleep", "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}, {"kind": "app_task", "name": "InstallController", "uuid": "18172071-87fc-4a06-906e-96104edb495a"}], "name": "7fcb2293_dag", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask", "uuid": "dcea441e-73d7-4c3f-9c50-87c77e5dba18"}, "edge_type": "user_defined", "type": "", "uuid": "e66fbc3e-16a6-43fd-88dd-6893fea20d0d", "to_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}}, {"from_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}, "edge_type": "user_defined", "type": "", "uuid": "f3392b71-5121-4c24-aa1b-f84ef1cc74c3", "to_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}, "edge_type": "user_defined", "type": "", "uuid": "8a1e8338-92ec-4029-8b9e-d2a0bf971a94", "to_task_reference": {"kind": "app_task", "name": "InstallController", "uuid": "18172071-87fc-4a06-906e-96104edb495a"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "7f813a1f-b27c-4811-97e0-49e6675ee68a"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "PackageInstallTask", "state": "ACTIVE", "attrs": {"script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "dcea441e-73d7-4c3f-9c50-87c77e5dba18"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "AddToDomain", "state": "ACTIVE", "attrs": {"script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"DDC-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "7d8aee4e-9b5d-46cc-855d-56040be554f3"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Sleep", "state": "ACTIVE", "attrs": {"script": "#script\nsleep(30)", "type": "", "command_line_args": "", "exit_status": [], "script_type": "static"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "d7e5bbc7-01af-426b-bc86-7973527663bd"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "InstallController", "state": "ACTIVE", "attrs": {"script": "<#\nInstalls Xendesktop components.\nFirst instance would be installed with CONTROLLER,DESKTOPSTUDIO,LICENSESERVER.\nAnd remaining instances would be installed with CONTROLLER,DESKTOPSTUDIO.\n#>\n\nfunction InstallCitrixComponents{\n        param(\n        [Parameter(Mandatory=$true)][string] $XenDesktopServerSetup,\n        [Parameter(Mandatory=$true)][string] $Components,\n        [Parameter(Mandatory=$false)][string] $Arguements\n    )\n\n    & \"$XenDesktopServerSetup\" /quiet /nosql /configure_firewall /components $Components $Arguements\n\n}\n$DriveLetter = \"D:\"\n$XenDesktopServerSetup = \"$DriveLetter\\x64\\XenDesktop Setup\\XenDesktopServerSetup.exe\"\n\nif (\"@@{calm_array_index}@@\" -eq \"0\"){\n  InstallCitrixComponents $XenDesktopServerSetup \"CONTROLLER,DESKTOPSTUDIO,LICENSESERVER\"\n}\nelse{\n  InstallCitrixComponents $XenDesktopServerSetup \"CONTROLLER,DESKTOPSTUDIO\"\n}\n\n<#\nDownloads and installs nutanix citrix plugin\n#>\n$TempDirectory = \"C:\\Temp\"\nNew-Item -ItemType Directory -Force -Path $TempDirectory\n$NutanixAcropolisPlugin = \"@@{NutanixAcropolisPlugin}@@\"\n$NutanixAcropolisPluginFilePath = \"$TempDirectory\\NutanixAcropolis.msi\"\n$NutanixAcropolisPluginInstallPath = \"@@{NutanixAcropolis_Installed_Path}@@\"\n\nWrite-Output \"Downloading the pulgin\"\ntry{\n  (New-Object System.Net.WebClient).DownloadFile($NutanixAcropolisPlugin,$NutanixAcropolisPluginFilePath)\n  Write-Output \"Pulgin has been downloaded\"\n\n  msiexec /i $NutanixAcropolisPluginFilePath /qn\n  sleep(40)\n  Rename-Item -LiteralPath C:\\[INSTALLFOLDER] -NewName \"NutanixAcropolis\"\n  Move-Item -Path C:\\NutanixAcropolis -Destination \"$NutanixAcropolisPluginInstallPath\"\n\n  & \"C:\\Program Files\\Common Files\\Citrix\\HCLPlugins\\RegisterPlugins.exe\" -PluginsRoot \"C:\\Program Files\\Common Files\\Citrix\\HCLPlugins\\CitrixMachineCreation\\v1.0.0.0\"\n\n  Restart-Service -Name \"Citrix Host Service\"\n  Restart-Service -Name \"Citrix Broker Service\"\n  Restart-Service -Name \"Citrix Machine Creation Service\"\n}\ncatch\n{\n\tWrite-Output \"$_\"\n    exit 1\n}", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "18172071-87fc-4a06-906e-96104edb495a"}], "description": "", "name": "ff975c07_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "7fcb2293_dag", "uuid": "7f813a1f-b27c-4811-97e0-49e6675ee68a"}, "message_list": [], "variable_list": [], "uuid": "d8049132-b9b6-4436-8300-84536da659c9"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "5d9a3914_dag", "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "419be271-1104-4c5e-bc24-f7c86d74233b"}], "description": "", "name": "086f090e_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "5d9a3914_dag", "uuid": "419be271-1104-4c5e-bc24-f7c86d74233b"}, "message_list": [], "variable_list": [], "uuid": "c6144a5a-2a58-4b20-8cc8-5b6f562fed68"}}, "variable_list": [], "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, {"description": "", "action_list": [{"description": "System action for installing an application", "type": "system", "uuid": "5ef8eca9-ddd9-4e73-ade9-49a86923a00e", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Install_Crb_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "6e45b8b5-8595-4ad2-b307-be3441fe4188"}], "name": "SYS_GEN__DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "8e11f7e8-5522-498e-b545-e4f2cbe4ec7a"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Install_Crb_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask", "uuid": "b233cc44-d9ae-4908-b996-6cf612717dbb"}, {"kind": "app_task", "name": "AddToDomain", "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}, {"kind": "app_task", "name": "Sleep", "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}, {"kind": "app_task", "name": "InstallStoreFront", "uuid": "c488f5cc-be27-404a-b1dc-6d7627737c05"}], "name": "7f665a14_dag", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}, "edge_type": "user_defined", "type": "", "uuid": "4034162e-5264-40ca-a14d-9ae581458f24", "to_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}, "edge_type": "user_defined", "type": "", "uuid": "f3674137-6e95-4993-a172-d9631876fa50", "to_task_reference": {"kind": "app_task", "name": "InstallStoreFront", "uuid": "c488f5cc-be27-404a-b1dc-6d7627737c05"}}, {"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask", "uuid": "b233cc44-d9ae-4908-b996-6cf612717dbb"}, "edge_type": "user_defined", "type": "", "uuid": "7489bb4f-694a-4450-bf81-281b73aa80a4", "to_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "9c8555b1-3b4b-48eb-8479-df6190944429"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "PackageInstallTask", "state": "ACTIVE", "attrs": {"script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "b233cc44-d9ae-4908-b996-6cf612717dbb"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "AddToDomain", "state": "ACTIVE", "attrs": {"script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"StoreFront-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Sleep", "state": "ACTIVE", "attrs": {"script": "#script\nsleep(30)", "type": "", "command_line_args": "", "exit_status": [], "script_type": "static"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "InstallStoreFront", "state": "ACTIVE", "attrs": {"script": "<#\nInstalls Xendesktop components.\nAll the instances would be installed with STOREFRONT.\n#>\nfunction InstallCitrixComponents{\n        param(\n        [Parameter(Mandatory=$true)][string] $XenDesktopServerSetup,\n        [Parameter(Mandatory=$true)][string] $Components,\n        [Parameter(Mandatory=$false)][string] $Arguements\n    )\n\n    & \"$XenDesktopServerSetup\" /quiet /nosql /configure_firewall /components $Components $Arguements\n\n}\n$DriveLetter = \"D:\"\n$XenDesktopServerSetup = \"$DriveLetter\\x64\\XenDesktop Setup\\XenDesktopServerSetup.exe\"\n\nInstallCitrixComponents $XenDesktopServerSetup \"STOREFRONT\"", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c488f5cc-be27-404a-b1dc-6d7627737c05"}], "description": "", "name": "113a7553_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "7f665a14_dag", "uuid": "9c8555b1-3b4b-48eb-8479-df6190944429"}, "message_list": [], "variable_list": [], "uuid": "4d787701-dc83-4c72-98f5-0be0521565ac"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "6f2933d9_dag", "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "c91193cf-8070-4785-b7e8-b9a4ab29005a"}], "description": "", "name": "04e28c7a_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "6f2933d9_dag", "uuid": "c91193cf-8070-4785-b7e8-b9a4ab29005a"}, "message_list": [], "variable_list": [], "uuid": "ac29206c-f656-4ce9-a8d0-a8efa1a34326"}}, "timeout_secs": "0", "type": "CUSTOM_PACKAGE_INSTALL", "variable_list": [], "uuid": "6e45b8b5-8595-4ad2-b307-be3441fe4188"}], "description": "", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "8e11f7e8-5522-498e-b545-e4f2cbe4ec7a"}, "message_list": [], "variable_list": [], "uuid": "09787d82-8351-424f-bfc9-8b2ff98d3c18"}, "message_list": [], "name": "action_install"}, {"description": "System action for creating an application", "type": "system", "uuid": "97d9c174-dbb8-44b5-aad7-63d0d3d3df02", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "f653215e-a816-4bfb-8f65-b2177abe28aa"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "0e5c2c08-d94c-45e5-bf15-b1ae32984afd"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "e0448284-caab-46f9-96d0-3c3b7a3ce0b9"}], "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "0e5c2c08-d94c-45e5-bf15-b1ae32984afd"}, "edge_type": "inherent", "type": "", "uuid": "57456c56-c26e-438a-a6ac-45bafef22032", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "e0448284-caab-46f9-96d0-3c3b7a3ce0b9"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "f653215e-a816-4bfb-8f65-b2177abe28aa"}, "edge_type": "inherent", "type": "", "uuid": "442525a3-c6d0-4f0b-b650-a74deae59fb4", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "0e5c2c08-d94c-45e5-bf15-b1ae32984afd"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "0a1c7cd0-f2d2-4392-bc37-225205f9bb2a"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__install_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "09787d82-8351-424f-bfc9-8b2ff98d3c18"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "f653215e-a816-4bfb-8f65-b2177abe28aa"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "21430fdc_runbook", "uuid": "8557edb6-20cf-45bb-a7cc-c73043b6fcc2"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "0e5c2c08-d94c-45e5-bf15-b1ae32984afd"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "fee4dd3c_runbook", "uuid": "83470714-cc17-4920-b14e-157565f1ef8c"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "e0448284-caab-46f9-96d0-3c3b7a3ce0b9"}], "description": "", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "0a1c7cd0-f2d2-4392-bc37-225205f9bb2a"}, "message_list": [], "variable_list": [], "uuid": "15fbaa8a-f7d3-4962-8d86-e6a26cf6c7a7"}, "message_list": [], "name": "action_create"}, {"description": "System action for uninstalling an application", "type": "system", "uuid": "d7601c2b-8a31-4f0a-b131-15c014b81186", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Uninstall_Crb_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "c83bc897-9035-4f4c-afc9-541cde6374ff"}], "name": "SYS_GEN__DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "84d2a08e-239d-416c-baa8-4cb9c6e0e410"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Uninstall_Crb_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask", "uuid": "b233cc44-d9ae-4908-b996-6cf612717dbb"}, {"kind": "app_task", "name": "AddToDomain", "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}, {"kind": "app_task", "name": "Sleep", "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}, {"kind": "app_task", "name": "InstallStoreFront", "uuid": "c488f5cc-be27-404a-b1dc-6d7627737c05"}], "name": "7f665a14_dag", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}, "edge_type": "user_defined", "type": "", "uuid": "4034162e-5264-40ca-a14d-9ae581458f24", "to_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}, "edge_type": "user_defined", "type": "", "uuid": "f3674137-6e95-4993-a172-d9631876fa50", "to_task_reference": {"kind": "app_task", "name": "InstallStoreFront", "uuid": "c488f5cc-be27-404a-b1dc-6d7627737c05"}}, {"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask", "uuid": "b233cc44-d9ae-4908-b996-6cf612717dbb"}, "edge_type": "user_defined", "type": "", "uuid": "7489bb4f-694a-4450-bf81-281b73aa80a4", "to_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "9c8555b1-3b4b-48eb-8479-df6190944429"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "PackageInstallTask", "state": "ACTIVE", "attrs": {"script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "b233cc44-d9ae-4908-b996-6cf612717dbb"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "AddToDomain", "state": "ACTIVE", "attrs": {"script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"StoreFront-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Sleep", "state": "ACTIVE", "attrs": {"script": "#script\nsleep(30)", "type": "", "command_line_args": "", "exit_status": [], "script_type": "static"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "InstallStoreFront", "state": "ACTIVE", "attrs": {"script": "<#\nInstalls Xendesktop components.\nAll the instances would be installed with STOREFRONT.\n#>\nfunction InstallCitrixComponents{\n        param(\n        [Parameter(Mandatory=$true)][string] $XenDesktopServerSetup,\n        [Parameter(Mandatory=$true)][string] $Components,\n        [Parameter(Mandatory=$false)][string] $Arguements\n    )\n\n    & \"$XenDesktopServerSetup\" /quiet /nosql /configure_firewall /components $Components $Arguements\n\n}\n$DriveLetter = \"D:\"\n$XenDesktopServerSetup = \"$DriveLetter\\x64\\XenDesktop Setup\\XenDesktopServerSetup.exe\"\n\nInstallCitrixComponents $XenDesktopServerSetup \"STOREFRONT\"", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c488f5cc-be27-404a-b1dc-6d7627737c05"}], "description": "", "name": "113a7553_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "7f665a14_dag", "uuid": "9c8555b1-3b4b-48eb-8479-df6190944429"}, "message_list": [], "variable_list": [], "uuid": "4d787701-dc83-4c72-98f5-0be0521565ac"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "6f2933d9_dag", "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "c91193cf-8070-4785-b7e8-b9a4ab29005a"}], "description": "", "name": "04e28c7a_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "6f2933d9_dag", "uuid": "c91193cf-8070-4785-b7e8-b9a4ab29005a"}, "message_list": [], "variable_list": [], "uuid": "ac29206c-f656-4ce9-a8d0-a8efa1a34326"}}, "timeout_secs": "0", "type": "CUSTOM_PACKAGE_UNINSTALL", "variable_list": [], "uuid": "c83bc897-9035-4f4c-afc9-541cde6374ff"}], "description": "", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "84d2a08e-239d-416c-baa8-4cb9c6e0e410"}, "message_list": [], "variable_list": [], "uuid": "f74dfb01-c68d-4172-9066-e596ca3f30df"}, "message_list": [], "name": "action_uninstall"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "685ee08e-f27d-4d28-a628-c845a55614b2", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "f5308ece-9380-4675-823f-37aa4fd2bed8"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "0b12d212-41f5-4063-9cfd-c9d4b35eac86"}, {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "0f513f6a-5c27-4cf8-bbda-f4335d185c6d"}], "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "f5308ece-9380-4675-823f-37aa4fd2bed8"}, "edge_type": "inherent", "type": "", "uuid": "b527b71f-7676-41ab-a6e6-0ed59463f5cf", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "0b12d212-41f5-4063-9cfd-c9d4b35eac86"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "0b12d212-41f5-4063-9cfd-c9d4b35eac86"}, "edge_type": "inherent", "type": "", "uuid": "11d44f5c-3ddc-4b67-a064-5fb951fcf08a", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "0f513f6a-5c27-4cf8-bbda-f4335d185c6d"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "15afa620-9cff-45fb-8cdf-5a4587a9f6dc"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2eeaf76_runbook", "uuid": "aa98207f-7711-44a6-ae33-fbc55df5fd61"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "f5308ece-9380-4675-823f-37aa4fd2bed8"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "6c029928_runbook", "uuid": "276d66be-0577-4634-8153-df5bc8239935"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "0b12d212-41f5-4063-9cfd-c9d4b35eac86"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__uninstall_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "f74dfb01-c68d-4172-9066-e596ca3f30df"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "0f513f6a-5c27-4cf8-bbda-f4335d185c6d"}], "description": "", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "15afa620-9cff-45fb-8cdf-5a4587a9f6dc"}, "message_list": [], "variable_list": [], "uuid": "cfa4987b-fd1b-42ab-ae59-6486132ec954"}, "message_list": [], "name": "action_delete"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "2c28b692-3876-45ee-800d-4a11fce1fb8c", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "0a3e62b5-6f97-411b-9804-033b4d69c1be"}, {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "4ac81c42-ef98-4a67-9fc0-517631a336e3"}], "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "0a3e62b5-6f97-411b-9804-033b4d69c1be"}, "edge_type": "inherent", "type": "", "uuid": "f51b7903-9708-4bcb-8d0a-6584ae2359fb", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "4ac81c42-ef98-4a67-9fc0-517631a336e3"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "86534fb1-d919-49a7-b67f-4e50ca3ecac1"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "d9fc0a1b-0e74-4859-b976-81868939f10b"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "0a3e62b5-6f97-411b-9804-033b4d69c1be"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Package_Element_Delete_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "4ac81c42-ef98-4a67-9fc0-517631a336e3"}], "description": "", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "86534fb1-d919-49a7-b67f-4e50ca3ecac1"}, "message_list": [], "variable_list": [], "uuid": "4f95641a-41f6-45c2-9907-108f10032099"}, "message_list": [], "name": "action_soft_delete"}, {"description": "System action for starting an application", "type": "system", "uuid": "75cf8d3b-b0f5-4593-8864-4b13a554eb41", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "1850dc5b-91ad-4ded-9178-f65ad9abc48c"}], "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "cc4ef2e0-69cc-4b1f-b754-f9b77f7a24f1"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "fee4dd3c_runbook", "uuid": "83470714-cc17-4920-b14e-157565f1ef8c"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "1850dc5b-91ad-4ded-9178-f65ad9abc48c"}], "description": "", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "cc4ef2e0-69cc-4b1f-b754-f9b77f7a24f1"}, "message_list": [], "variable_list": [], "uuid": "06dc7c24-9f58-4bb9-81bb-9f9f72ae2294"}, "message_list": [], "name": "action_start"}, {"description": "System action for restarting an application", "type": "system", "uuid": "1bbe57ca-e330-4291-a8ae-0aef87dfccd4", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "d3d6d2d2-093a-4555-a52e-405825cb48d5"}], "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "217ebda7-2151-4fb4-8271-a6b34a9050bc"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "e915c064_runbook", "uuid": "f0f54133-4e14-4a5b-9eab-fa5ae1759743"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "d3d6d2d2-093a-4555-a52e-405825cb48d5"}], "description": "", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "217ebda7-2151-4fb4-8271-a6b34a9050bc"}, "message_list": [], "variable_list": [], "uuid": "ffd55af4-c4a6-4778-aa6c-34b60e0649af"}, "message_list": [], "name": "action_restart"}, {"description": "System action for stopping an application", "type": "system", "uuid": "9221ab90-e712-46c3-a23d-dd120ce53369", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "5b15ea27-e9c1-416e-84cc-0e4aad276cf8"}], "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "b241a0b0-809c-479b-84a5-448399fe2e2f"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2eeaf76_runbook", "uuid": "aa98207f-7711-44a6-ae33-fbc55df5fd61"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "5b15ea27-e9c1-416e-84cc-0e4aad276cf8"}], "description": "", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "b241a0b0-809c-479b-84a5-448399fe2e2f"}, "message_list": [], "variable_list": [], "uuid": "20482aa4-2da7-4e38-9677-1d3c20ad5a44"}, "message_list": [], "name": "action_stop"}], "type": "DEB", "service_local_reference_list": [{"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}], "name": "AHV StoreFront Package", "state": "ACTIVE", "version": "", "editables": {}, "message_list": [], "options": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask", "uuid": "b233cc44-d9ae-4908-b996-6cf612717dbb"}, {"kind": "app_task", "name": "AddToDomain", "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}, {"kind": "app_task", "name": "Sleep", "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}, {"kind": "app_task", "name": "InstallStoreFront", "uuid": "c488f5cc-be27-404a-b1dc-6d7627737c05"}], "name": "7f665a14_dag", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}, "edge_type": "user_defined", "type": "", "uuid": "4034162e-5264-40ca-a14d-9ae581458f24", "to_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep", "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}, "edge_type": "user_defined", "type": "", "uuid": "f3674137-6e95-4993-a172-d9631876fa50", "to_task_reference": {"kind": "app_task", "name": "InstallStoreFront", "uuid": "c488f5cc-be27-404a-b1dc-6d7627737c05"}}, {"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask", "uuid": "b233cc44-d9ae-4908-b996-6cf612717dbb"}, "edge_type": "user_defined", "type": "", "uuid": "7489bb4f-694a-4450-bf81-281b73aa80a4", "to_task_reference": {"kind": "app_task", "name": "AddToDomain", "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "9c8555b1-3b4b-48eb-8479-df6190944429"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "PackageInstallTask", "state": "ACTIVE", "attrs": {"script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "b233cc44-d9ae-4908-b996-6cf612717dbb"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "AddToDomain", "state": "ACTIVE", "attrs": {"script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"StoreFront-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "4165a27f-7f71-4d9c-999f-7fe0f16928c9"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "Sleep", "state": "ACTIVE", "attrs": {"script": "#script\nsleep(30)", "type": "", "command_line_args": "", "exit_status": [], "script_type": "static"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "9108bbc3-9977-41eb-bd44-1ea483044ab5"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "InstallStoreFront", "state": "ACTIVE", "attrs": {"script": "<#\nInstalls Xendesktop components.\nAll the instances would be installed with STOREFRONT.\n#>\nfunction InstallCitrixComponents{\n        param(\n        [Parameter(Mandatory=$true)][string] $XenDesktopServerSetup,\n        [Parameter(Mandatory=$true)][string] $Components,\n        [Parameter(Mandatory=$false)][string] $Arguements\n    )\n\n    & \"$XenDesktopServerSetup\" /quiet /nosql /configure_firewall /components $Components $Arguements\n\n}\n$DriveLetter = \"D:\"\n$XenDesktopServerSetup = \"$DriveLetter\\x64\\XenDesktop Setup\\XenDesktopServerSetup.exe\"\n\nInstallCitrixComponents $XenDesktopServerSetup \"STOREFRONT\"", "type": "", "command_line_args": "", "exit_status": [], "script_type": "sh"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "uuid": "c488f5cc-be27-404a-b1dc-6d7627737c05"}], "description": "", "name": "113a7553_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "7f665a14_dag", "uuid": "9c8555b1-3b4b-48eb-8479-df6190944429"}, "message_list": [], "variable_list": [], "uuid": "4d787701-dc83-4c72-98f5-0be0521565ac"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "6f2933d9_dag", "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "c91193cf-8070-4785-b7e8-b9a4ab29005a"}], "description": "", "name": "04e28c7a_runbook", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "6f2933d9_dag", "uuid": "c91193cf-8070-4785-b7e8-b9a4ab29005a"}, "message_list": [], "variable_list": [], "uuid": "ac29206c-f656-4ce9-a8d0-a8efa1a34326"}}, "variable_list": [], "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}], "app_profile_list": [{"deployment_create_list": [{"type": "GREENFIELD", "description": "", "action_list": [{"description": "System action for creating an application", "type": "system", "uuid": "1e9a909a-5f31-4e71-b76c-3ac84f5ef7e2", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__DE_Provision_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "c81d88f0-987e-4e88-a4f7-3a1c3fc74fa8"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "abf0d33d-505d-40ad-ad6d-96f7ec16a169"}, {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "f57b9c3a-a483-4e23-a270-d912885aec01"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "47bd956f-e628-48db-8cf8-23739b9c2b09"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "c3b11731-7c8a-4ba0-9602-c0c4e6a534b4"}], "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "47bd956f-e628-48db-8cf8-23739b9c2b09"}, "edge_type": "inherent", "type": "", "uuid": "a8dbd1c4-2995-4636-9442-a8e8c70f6abe", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "c3b11731-7c8a-4ba0-9602-c0c4e6a534b4"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "f57b9c3a-a483-4e23-a270-d912885aec01"}, "edge_type": "inherent", "type": "", "uuid": "6c3c1343-9ac3-4f46-9957-9708aaf53e88", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "47bd956f-e628-48db-8cf8-23739b9c2b09"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Provision_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "c81d88f0-987e-4e88-a4f7-3a1c3fc74fa8"}, "edge_type": "inherent", "type": "", "uuid": "fd4b2fef-df23-44ee-83c3-05d150194e96", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "abf0d33d-505d-40ad-ad6d-96f7ec16a169"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "abf0d33d-505d-40ad-ad6d-96f7ec16a169"}, "edge_type": "inherent", "type": "", "uuid": "945012f5-51db-440f-8644-1310a52c8a7a", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "f57b9c3a-a483-4e23-a270-d912885aec01"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "ae3828dc-f220-4b33-b851-22c765d0226c"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Provision_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "CREATE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "c81d88f0-987e-4e88-a4f7-3a1c3fc74fa8"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "a8a7ae38-c2b9-470d-8f94-bd981491fd3a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "abf0d33d-505d-40ad-ad6d-96f7ec16a169"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__install_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "06b5b79e-c0da-422a-84ef-a7c47bd3fda5"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "f57b9c3a-a483-4e23-a270-d912885aec01"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "dade7481_runbook", "uuid": "58135bbb-91b0-4e42-8f9d-8bdfb261eaad"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "47bd956f-e628-48db-8cf8-23739b9c2b09"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "11876906_runbook", "uuid": "e822e828-353d-4651-ad6a-f7d60355913a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "c3b11731-7c8a-4ba0-9602-c0c4e6a534b4"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "ae3828dc-f220-4b33-b851-22c765d0226c"}, "message_list": [], "variable_list": [], "uuid": "e3f956eb-f362-47cb-a75e-dc058b16068e"}, "message_list": [], "name": "action_create"}, {"description": "System action for starting an application", "type": "system", "uuid": "8a41b77e-04cb-4fa5-a8ad-dbd0d3fbd5f4", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "ab25b8d0-a4db-47b6-9a7a-08b4dd6bf9a4"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "2642b3c6-70c3-4f68-9883-c076bdbfc472"}], "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "ab25b8d0-a4db-47b6-9a7a-08b4dd6bf9a4"}, "edge_type": "inherent", "type": "", "uuid": "3463aa6b-9d55-4282-b97c-d0ba53f6ea53", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "2642b3c6-70c3-4f68-9883-c076bdbfc472"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "26512d53-d993-474d-ac39-61e7f7c8bc8f"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "97d4cc68-bdfa-4035-bb8e-4f2b225343f8"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "ab25b8d0-a4db-47b6-9a7a-08b4dd6bf9a4"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "11876906_runbook", "uuid": "e822e828-353d-4651-ad6a-f7d60355913a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "2642b3c6-70c3-4f68-9883-c076bdbfc472"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "26512d53-d993-474d-ac39-61e7f7c8bc8f"}, "message_list": [], "variable_list": [], "uuid": "265aded7-1b46-4434-a4cd-72158fa7634e"}, "message_list": [], "name": "action_start"}, {"description": "System action for restarting an application", "type": "system", "uuid": "9b5e7de3-a9f0-4226-a242-e2be6e93b8b1", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "22515872-4f49-4afa-bef9-93bd5f807821"}, {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "f2b908d4-a5b7-4c81-98f4-eef78541e0cc"}], "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "22515872-4f49-4afa-bef9-93bd5f807821"}, "edge_type": "inherent", "type": "", "uuid": "d0f74bc5-600f-420b-9ee9-0a41f52f5321", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "f2b908d4-a5b7-4c81-98f4-eef78541e0cc"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "626733bb-b2df-4c63-bfbf-1e743dd057b8"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "c220e32d-de12-444a-910f-fd1720e163c8"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "22515872-4f49-4afa-bef9-93bd5f807821"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "4150545e_runbook", "uuid": "525f4db7-9369-478a-a1c9-99518e03e93e"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "f2b908d4-a5b7-4c81-98f4-eef78541e0cc"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "626733bb-b2df-4c63-bfbf-1e743dd057b8"}, "message_list": [], "variable_list": [], "uuid": "a2d15464-57b6-4945-8561-2dd687bd6361"}, "message_list": [], "name": "action_restart"}, {"description": "System action for stopping an application", "type": "system", "uuid": "0f7d0432-0e4e-4f6f-b096-29453ae677ed", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "beb2479b-933f-499e-bc64-fa99414031a5"}, {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "845e9379-5eac-41f9-99e5-8f127a8774b1"}], "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "beb2479b-933f-499e-bc64-fa99414031a5"}, "edge_type": "inherent", "type": "", "uuid": "7852067c-699a-4707-8436-cc37660e99c2", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "845e9379-5eac-41f9-99e5-8f127a8774b1"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "916aef33-11c0-4fa9-b376-aae746773c62"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "d2728354_runbook", "uuid": "2227c943-6a01-4b4f-b5f9-d748009e7ff1"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "beb2479b-933f-499e-bc64-fa99414031a5"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "3aec85b3-a5af-4c55-8c53-078ca9313d67"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "845e9379-5eac-41f9-99e5-8f127a8774b1"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "916aef33-11c0-4fa9-b376-aae746773c62"}, "message_list": [], "variable_list": [], "uuid": "f3cb50ff-8b31-40b0-b83d-e50f23ecd5ed"}, "message_list": [], "name": "action_stop"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "140deb2b-1e23-41aa-a438-8f9cee4ffdac", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "3813dac7-60ae-44cd-beef-a9c7f4759158"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "a1d87f1d-96f1-44f1-917f-600ac8191657"}, {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "886666c2-7575-4966-86ee-1795d65a3a14"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "32dfea24-204f-432a-b082-9b8c7abea7fe"}, {"kind": "app_task", "name": "SYS_GEN__DE_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "a57a4a62-2c14-4eb0-be85-1acf346ebaed"}], "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "3813dac7-60ae-44cd-beef-a9c7f4759158"}, "edge_type": "inherent", "type": "", "uuid": "39041cbd-e5e0-460e-9ae0-07129fe4a85e", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "a1d87f1d-96f1-44f1-917f-600ac8191657"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "a1d87f1d-96f1-44f1-917f-600ac8191657"}, "edge_type": "inherent", "type": "", "uuid": "a432ec2a-03e3-4ec1-8f3f-5724a356fd0f", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "886666c2-7575-4966-86ee-1795d65a3a14"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "32dfea24-204f-432a-b082-9b8c7abea7fe"}, "edge_type": "inherent", "type": "", "uuid": "47af5b71-b282-452a-8e53-d4f9ab6f91b2", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "a57a4a62-2c14-4eb0-be85-1acf346ebaed"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "886666c2-7575-4966-86ee-1795d65a3a14"}, "edge_type": "inherent", "type": "", "uuid": "9474333e-9adf-4054-98b2-cb58d488182e", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "32dfea24-204f-432a-b082-9b8c7abea7fe"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "2b5bdd6b-e705-4b3b-84b0-b20b32d41bb6"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "d2728354_runbook", "uuid": "2227c943-6a01-4b4f-b5f9-d748009e7ff1"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "3813dac7-60ae-44cd-beef-a9c7f4759158"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "59afb4f4_runbook", "uuid": "ce606f1a-cd67-4456-8823-df98e0d20936"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "a1d87f1d-96f1-44f1-917f-600ac8191657"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__uninstall_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "094213a3-cf7f-49cc-a078-cde57059e254"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "886666c2-7575-4966-86ee-1795d65a3a14"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "cc049242-7025-433a-8eb7-46374da90b01"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "32dfea24-204f-432a-b082-9b8c7abea7fe"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "a57a4a62-2c14-4eb0-be85-1acf346ebaed"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "2b5bdd6b-e705-4b3b-84b0-b20b32d41bb6"}, "message_list": [], "variable_list": [], "uuid": "ca50651f-fa87-44bb-9ce3-1b9969a3ee44"}, "message_list": [], "name": "action_delete"}, {"description": "System action for scaleout", "type": "system", "uuid": "1d5224b9-4613-4645-b34c-3a8d60c4897a", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Deployment_Scaleout_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "d43d7d9e-cfd8-4011-b91f-b12b8207615d"}], "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "3d4c8d0c-8c40-4783-b75a-da5a099454ed"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Deployment_Scaleout_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"scaling_count": "@@{scaling_count}@@", "type": "", "scaling_type": "SCALEOUT"}, "timeout_secs": "0", "type": "SCALING", "variable_list": [], "uuid": "d43d7d9e-cfd8-4011-b91f-b12b8207615d"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "3d4c8d0c-8c40-4783-b75a-da5a099454ed"}, "message_list": [], "variable_list": [{"val_type": "STRING", "description": "", "name": "scaling_count", "type": "LOCAL", "value": "0", "label": "", "state": "NOT_VALIDATED", "attrs": {}, "editables": {"value": true}, "message_list": [], "uuid": "da7e4793-f9b8-46c9-8434-ff050911af5b"}], "uuid": "a4906373-21e2-4084-a621-472e1f53f491"}, "message_list": [], "name": "action_scaleout"}, {"description": "System action for scalein", "type": "system", "uuid": "a9a4f14e-9f32-4fc3-9a5d-57969cf90f83", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Deployment_Scalein_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "918b4c31-3f6a-4ce9-b661-84bb514bb45e"}], "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "fc561bb4-6b87-41a2-9fd6-78e7f5057b96"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Deployment_Scalein_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"scaling_count": "@@{scaling_count}@@", "type": "", "scaling_type": "SCALEIN"}, "timeout_secs": "0", "type": "SCALING", "variable_list": [], "uuid": "918b4c31-3f6a-4ce9-b661-84bb514bb45e"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "fc561bb4-6b87-41a2-9fd6-78e7f5057b96"}, "message_list": [], "variable_list": [{"val_type": "STRING", "description": "", "name": "scaling_count", "type": "LOCAL", "value": "0", "label": "", "state": "NOT_VALIDATED", "attrs": {}, "editables": {"value": true}, "message_list": [], "uuid": "fa86ff52-8ec1-4971-82a9-48449ebdef29"}], "uuid": "3c58aa7b-4216-4556-99d3-83aedf28b7e5"}, "message_list": [], "name": "action_scalein"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "92e5bc23-59f9-4a4f-bd7d-fbe8a039e043", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "19f84d1f-d915-47cc-b4c7-7b918a2923dc"}, {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "86e09b4d-a9da-44c0-a748-95fa7bbf700c"}, {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "3a93ccd8-f83b-42c6-8520-4dfec64fe63f"}, {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "b5fb40cf-382d-4111-ad23-367920ebe371"}], "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "19f84d1f-d915-47cc-b4c7-7b918a2923dc"}, "edge_type": "inherent", "type": "", "uuid": "1a52e343-3b71-421e-9710-53effe8fc3a0", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "86e09b4d-a9da-44c0-a748-95fa7bbf700c"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "3a93ccd8-f83b-42c6-8520-4dfec64fe63f"}, "edge_type": "inherent", "type": "", "uuid": "bfe1f771-1156-452f-9576-5cfe68dd2a05", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "b5fb40cf-382d-4111-ad23-367920ebe371"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "86e09b4d-a9da-44c0-a748-95fa7bbf700c"}, "edge_type": "inherent", "type": "", "uuid": "0ee8704c-b6ac-4c6a-bb47-885d2f4e3a80", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "3a93ccd8-f83b-42c6-8520-4dfec64fe63f"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "effa90b0-a264-4415-bcb7-0ee4235a62a5"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "0942c9ef-1ecf-4cca-bca2-be37bb12790a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "19f84d1f-d915-47cc-b4c7-7b918a2923dc"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Package_Element_Delete_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "86e09b4d-a9da-44c0-a748-95fa7bbf700c"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "af183eaa-f234-4253-ae56-c76e21d553d2"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "3a93ccd8-f83b-42c6-8520-4dfec64fe63f"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Soft_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "b5fb40cf-382d-4111-ad23-367920ebe371"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "effa90b0-a264-4415-bcb7-0ee4235a62a5"}, "message_list": [], "variable_list": [], "uuid": "16f38f9b-9db6-47e5-80be-8713d88a3051"}, "message_list": [], "name": "action_soft_delete"}], "message_list": [], "editables": {}, "name": "5aed8000_deployment", "state": "ACTIVE", "max_replicas": "2", "package_local_reference_list": [{"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}], "substrate_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "min_replicas": "2", "variable_list": [], "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, {"type": "GREENFIELD", "description": "", "action_list": [{"description": "System action for creating an application", "type": "system", "uuid": "c7eb3ac1-238d-4fb5-8103-4118684850da", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__DE_Provision_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "0cf37d46-fa9f-4f77-bf5c-80b05f2dbd9f"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "5d9f58c2-5b6c-42fa-b80f-d952572f0c6c"}, {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "45514e19-015b-4cde-873e-71b18f665fc0"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "2947875e-bc98-4918-acbb-9533aaa6e6b7"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "7471eb6f-9822-4d1f-b9fe-af2c1c0c5eb0"}], "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "2947875e-bc98-4918-acbb-9533aaa6e6b7"}, "edge_type": "inherent", "type": "", "uuid": "4fe5653b-1c7a-4e55-ba22-9f124706db37", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "7471eb6f-9822-4d1f-b9fe-af2c1c0c5eb0"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "45514e19-015b-4cde-873e-71b18f665fc0"}, "edge_type": "inherent", "type": "", "uuid": "14809512-f35a-4f96-bc55-1aff6eccaa55", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "2947875e-bc98-4918-acbb-9533aaa6e6b7"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Provision_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "0cf37d46-fa9f-4f77-bf5c-80b05f2dbd9f"}, "edge_type": "inherent", "type": "", "uuid": "111e6855-dcea-43f2-b0a2-e5b8f8d8e47e", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "5d9f58c2-5b6c-42fa-b80f-d952572f0c6c"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "5d9f58c2-5b6c-42fa-b80f-d952572f0c6c"}, "edge_type": "inherent", "type": "", "uuid": "b67331dd-f7f1-4381-9e26-0776c9476a31", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "45514e19-015b-4cde-873e-71b18f665fc0"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "ef293079-a0de-4533-a814-0e80836ccf7e"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Provision_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "CREATE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "0cf37d46-fa9f-4f77-bf5c-80b05f2dbd9f"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "c8107d8b-f026-4f14-9247-d21c84ce263a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "5d9f58c2-5b6c-42fa-b80f-d952572f0c6c"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__install_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "785d636f-4375-4b31-88a1-4cdd226c2cb8"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "45514e19-015b-4cde-873e-71b18f665fc0"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "29e91e9c_runbook", "uuid": "042fc435-a86c-4df0-b6f6-4cba2968e264"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "2947875e-bc98-4918-acbb-9533aaa6e6b7"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "c1427948_runbook", "uuid": "631cac91-4b75-4c10-84ab-a2b6017c6296"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "7471eb6f-9822-4d1f-b9fe-af2c1c0c5eb0"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "ef293079-a0de-4533-a814-0e80836ccf7e"}, "message_list": [], "variable_list": [], "uuid": "2a4427ad-bbeb-44d9-8ee3-1edb7bd061d0"}, "message_list": [], "name": "action_create"}, {"description": "System action for starting an application", "type": "system", "uuid": "7d424c21-92b6-4ce8-b0c0-9a9c6b9ce25f", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "0e4a4a5c-fde5-42c8-951d-5ec1ac4984ba"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "38fce15e-9802-49ce-a002-6542289aa86a"}], "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "0e4a4a5c-fde5-42c8-951d-5ec1ac4984ba"}, "edge_type": "inherent", "type": "", "uuid": "e74e5ed0-8ee6-46e9-91fd-fdfa6c717d1a", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "38fce15e-9802-49ce-a002-6542289aa86a"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "33876699-a93c-4620-bc1c-0c2072e7cde0"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "2621f4ad-b028-4083-bca6-1626e4496ae1"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "0e4a4a5c-fde5-42c8-951d-5ec1ac4984ba"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "c1427948_runbook", "uuid": "631cac91-4b75-4c10-84ab-a2b6017c6296"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "38fce15e-9802-49ce-a002-6542289aa86a"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "33876699-a93c-4620-bc1c-0c2072e7cde0"}, "message_list": [], "variable_list": [], "uuid": "84c9ad02-995c-4d8d-8f57-b16c0e99192d"}, "message_list": [], "name": "action_start"}, {"description": "System action for restarting an application", "type": "system", "uuid": "2dcd2f53-3923-44d4-a846-04b1d1bae05b", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "e77df3b9-c826-46f2-9917-9a1daba421a7"}, {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "ff343081-5714-4416-b27e-fb3b6341ea98"}], "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "e77df3b9-c826-46f2-9917-9a1daba421a7"}, "edge_type": "inherent", "type": "", "uuid": "ab14a0db-6309-4628-90ce-d58a702a69a3", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "ff343081-5714-4416-b27e-fb3b6341ea98"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "21ee5f40-822b-4d8f-976c-d788d3600d92"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "c1b079ac-5f44-4f74-916e-228a20c522bf"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "e77df3b9-c826-46f2-9917-9a1daba421a7"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "73c06dcc_runbook", "uuid": "9a54b194-21f3-4c63-b3ef-d53d30553649"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "ff343081-5714-4416-b27e-fb3b6341ea98"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "21ee5f40-822b-4d8f-976c-d788d3600d92"}, "message_list": [], "variable_list": [], "uuid": "28882d06-9d71-4701-b4f5-4c08e87be7fc"}, "message_list": [], "name": "action_restart"}, {"description": "System action for stopping an application", "type": "system", "uuid": "1fe1e678-0218-4844-b4de-9d6e2e725451", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "8b609e95-1805-43cd-9eac-cbc3f82f4bab"}, {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "ef569bb1-edd5-45c4-96ef-faf69e39e89f"}], "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "8b609e95-1805-43cd-9eac-cbc3f82f4bab"}, "edge_type": "inherent", "type": "", "uuid": "5f968559-33d1-420d-aaa1-990fffbb600b", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "ef569bb1-edd5-45c4-96ef-faf69e39e89f"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "ea2be968-d9a5-4831-bba1-f8d55a085ec5"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2d07af0_runbook", "uuid": "08fe1064-8629-40b1-84b8-72356d4ca6ee"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "8b609e95-1805-43cd-9eac-cbc3f82f4bab"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "facc6151-0ab3-45d6-abdd-4b310c412e00"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "ef569bb1-edd5-45c4-96ef-faf69e39e89f"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "ea2be968-d9a5-4831-bba1-f8d55a085ec5"}, "message_list": [], "variable_list": [], "uuid": "7b17c540-09d8-4fe2-af79-78f3f31afbb6"}, "message_list": [], "name": "action_stop"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "2df3c9ac-0c9c-482f-bb6c-49d9a6285ec5", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "f6859094-c94e-4844-8286-8c60b438f1e5"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "2b7ba8fa-53b5-464c-803e-5de342fcc0e9"}, {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "90eae399-bcd0-4793-9d75-397af979d01f"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "729e2b77-93c8-4a80-861f-486983f68cfe"}, {"kind": "app_task", "name": "SYS_GEN__DE_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "3e4dbacd-fac6-45ff-b421-3ed67339585f"}], "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "f6859094-c94e-4844-8286-8c60b438f1e5"}, "edge_type": "inherent", "type": "", "uuid": "ba8382e4-20ac-467b-aba8-be62d2101c75", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "2b7ba8fa-53b5-464c-803e-5de342fcc0e9"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "2b7ba8fa-53b5-464c-803e-5de342fcc0e9"}, "edge_type": "inherent", "type": "", "uuid": "2cd9a1b1-0929-4702-862e-b9df8dd1248d", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "90eae399-bcd0-4793-9d75-397af979d01f"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "729e2b77-93c8-4a80-861f-486983f68cfe"}, "edge_type": "inherent", "type": "", "uuid": "43ad078e-29c3-4160-8ae9-9aee8ece771a", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "3e4dbacd-fac6-45ff-b421-3ed67339585f"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "90eae399-bcd0-4793-9d75-397af979d01f"}, "edge_type": "inherent", "type": "", "uuid": "2647dcd7-4ae1-439e-b26f-b2695b51ac49", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "729e2b77-93c8-4a80-861f-486983f68cfe"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "6880afa7-7a72-452b-b5bb-9b6321ccd930"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2d07af0_runbook", "uuid": "08fe1064-8629-40b1-84b8-72356d4ca6ee"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "f6859094-c94e-4844-8286-8c60b438f1e5"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "22428294_runbook", "uuid": "de943f5f-693e-4a9c-9642-5f51b1e2e081"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "2b7ba8fa-53b5-464c-803e-5de342fcc0e9"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__uninstall_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "8acf3f85-5155-48b8-b8de-a5fe74733282"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "90eae399-bcd0-4793-9d75-397af979d01f"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "05e6b137-bddf-4644-ae7e-55a055af3289"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "729e2b77-93c8-4a80-861f-486983f68cfe"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "3e4dbacd-fac6-45ff-b421-3ed67339585f"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "6880afa7-7a72-452b-b5bb-9b6321ccd930"}, "message_list": [], "variable_list": [], "uuid": "4113bc2e-1a7c-4221-aa34-2d3a6d38a131"}, "message_list": [], "name": "action_delete"}, {"description": "System action for scaleout", "type": "system", "uuid": "684b459b-d732-4fc3-8362-d0e3bdd0519e", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Deployment_Scaleout_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "81264f42-26b0-4778-939e-9b8861fbb5e6"}], "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "5b905994-5810-49a7-a9a3-92dc5e386e75"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Deployment_Scaleout_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"scaling_count": "@@{scaling_count}@@", "type": "", "scaling_type": "SCALEOUT"}, "timeout_secs": "0", "type": "SCALING", "variable_list": [], "uuid": "81264f42-26b0-4778-939e-9b8861fbb5e6"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "5b905994-5810-49a7-a9a3-92dc5e386e75"}, "message_list": [], "variable_list": [{"val_type": "STRING", "description": "", "name": "scaling_count", "type": "LOCAL", "value": "0", "label": "", "state": "NOT_VALIDATED", "attrs": {}, "editables": {"value": true}, "message_list": [], "uuid": "85b95d76-d4c7-4830-a07a-37285cd54f25"}], "uuid": "1cabbc8c-e178-4c72-9077-53f33e8900be"}, "message_list": [], "name": "action_scaleout"}, {"description": "System action for scalein", "type": "system", "uuid": "3867ba0a-4d39-46c3-be9d-d72a5937c21d", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Deployment_Scalein_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "699a8f25-599c-4d18-90c6-e87b8b89bfec"}], "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "fc584c68-8d3c-4a13-a90a-5e59ef5c4d72"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Deployment_Scalein_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"scaling_count": "@@{scaling_count}@@", "type": "", "scaling_type": "SCALEIN"}, "timeout_secs": "0", "type": "SCALING", "variable_list": [], "uuid": "699a8f25-599c-4d18-90c6-e87b8b89bfec"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "fc584c68-8d3c-4a13-a90a-5e59ef5c4d72"}, "message_list": [], "variable_list": [{"val_type": "STRING", "description": "", "name": "scaling_count", "type": "LOCAL", "value": "0", "label": "", "state": "NOT_VALIDATED", "attrs": {}, "editables": {"value": true}, "message_list": [], "uuid": "fc5fc866-c17e-49f6-84ac-260ea3e5b89b"}], "uuid": "a17e8468-2bd2-4109-8f6a-4f144687f174"}, "message_list": [], "name": "action_scalein"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "f53b16c4-96a1-4613-b9c0-a614da9eec7d", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "8739a1d3-0fd0-4f04-85c3-ebbfc6835c36"}, {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "40b57f35-5ca3-42a8-a2fc-68cf3f71930f"}, {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "9d4a1f69-0416-4328-b83f-d3aa754e1fb2"}, {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "b5d65b56-8876-41bd-b584-a55faf0cfa6b"}], "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "8739a1d3-0fd0-4f04-85c3-ebbfc6835c36"}, "edge_type": "inherent", "type": "", "uuid": "3e0d45f7-7165-41a8-8283-7086f7f7700c", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "40b57f35-5ca3-42a8-a2fc-68cf3f71930f"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "9d4a1f69-0416-4328-b83f-d3aa754e1fb2"}, "edge_type": "inherent", "type": "", "uuid": "9253afc3-c528-4e4c-851a-1ae22e2a4f64", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "b5d65b56-8876-41bd-b584-a55faf0cfa6b"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "40b57f35-5ca3-42a8-a2fc-68cf3f71930f"}, "edge_type": "inherent", "type": "", "uuid": "1d7c9b7e-97dd-4ddd-a715-a0c99dc584d9", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "9d4a1f69-0416-4328-b83f-d3aa754e1fb2"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "74845889-59f2-480f-81e9-8bfc2df5a760"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "d24a316a-2dee-4081-9d10-b5986a67ad23"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "8739a1d3-0fd0-4f04-85c3-ebbfc6835c36"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Package_Element_Delete_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "40b57f35-5ca3-42a8-a2fc-68cf3f71930f"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "143f12fb-5bd4-489a-bf10-759f2cbeb491"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "9d4a1f69-0416-4328-b83f-d3aa754e1fb2"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Soft_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "b5d65b56-8876-41bd-b584-a55faf0cfa6b"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "74845889-59f2-480f-81e9-8bfc2df5a760"}, "message_list": [], "variable_list": [], "uuid": "c5466d13-5c65-4ae6-ba02-6d1e163f4b34"}, "message_list": [], "name": "action_soft_delete"}], "message_list": [], "editables": {}, "name": "c693df12_deployment", "state": "ACTIVE", "max_replicas": "2", "package_local_reference_list": [{"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}], "substrate_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "min_replicas": "2", "variable_list": [], "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, {"type": "GREENFIELD", "description": "", "action_list": [{"description": "System action for creating an application", "type": "system", "uuid": "b40e1329-0c45-4c69-8d3d-665ed79ab23f", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__DE_Provision_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "feba22d6-cc35-4f96-a795-a11a501980b5"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "6956b461-4d2e-4e86-90b6-4fdda0204b96"}, {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "1f779bc7-df43-429f-805e-269c9d20f92f"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "9af1a98b-1d8a-43e2-8143-f3b1ef036c6d"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "0ba34bc9-6564-4562-943b-1215f72b7a7a"}], "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "9af1a98b-1d8a-43e2-8143-f3b1ef036c6d"}, "edge_type": "inherent", "type": "", "uuid": "76d33a99-7639-4e21-8051-217402accb62", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "0ba34bc9-6564-4562-943b-1215f72b7a7a"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "1f779bc7-df43-429f-805e-269c9d20f92f"}, "edge_type": "inherent", "type": "", "uuid": "a57f187d-856f-4a39-bfcf-4adf662310dd", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "9af1a98b-1d8a-43e2-8143-f3b1ef036c6d"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Provision_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "feba22d6-cc35-4f96-a795-a11a501980b5"}, "edge_type": "inherent", "type": "", "uuid": "0cf14bf8-ed1b-4c30-83b6-437c3071c46d", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "6956b461-4d2e-4e86-90b6-4fdda0204b96"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "6956b461-4d2e-4e86-90b6-4fdda0204b96"}, "edge_type": "inherent", "type": "", "uuid": "6909074e-6800-4c26-be32-7ce0b59a794e", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "1f779bc7-df43-429f-805e-269c9d20f92f"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "bdd77af5-9740-4574-bbd4-ba097cced068"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Provision_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "CREATE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "feba22d6-cc35-4f96-a795-a11a501980b5"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "2900a2a1-75c9-4d53-95a5-4a6d369efb07"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "6956b461-4d2e-4e86-90b6-4fdda0204b96"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__install_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "09787d82-8351-424f-bfc9-8b2ff98d3c18"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "1f779bc7-df43-429f-805e-269c9d20f92f"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "21430fdc_runbook", "uuid": "8557edb6-20cf-45bb-a7cc-c73043b6fcc2"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "9af1a98b-1d8a-43e2-8143-f3b1ef036c6d"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "fee4dd3c_runbook", "uuid": "83470714-cc17-4920-b14e-157565f1ef8c"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "0ba34bc9-6564-4562-943b-1215f72b7a7a"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "bdd77af5-9740-4574-bbd4-ba097cced068"}, "message_list": [], "variable_list": [], "uuid": "cf091e21-810b-4cf7-a88f-a3861a06ab0a"}, "message_list": [], "name": "action_create"}, {"description": "System action for starting an application", "type": "system", "uuid": "0e90627a-6808-4555-af1d-cb4344f515ef", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "f489aa13-5035-4840-b7cb-86fe5b93b41e"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "532020eb-81b3-4371-b6fb-cdd1bd4a89c0"}], "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "f489aa13-5035-4840-b7cb-86fe5b93b41e"}, "edge_type": "inherent", "type": "", "uuid": "816365b3-8b49-4a2d-879b-577ec7dfce3e", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "532020eb-81b3-4371-b6fb-cdd1bd4a89c0"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "83e1f6d5-902b-4a57-a406-92a651d66844"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "9bbbbf2f-1f21-4d04-9623-3135957b2fad"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "f489aa13-5035-4840-b7cb-86fe5b93b41e"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "fee4dd3c_runbook", "uuid": "83470714-cc17-4920-b14e-157565f1ef8c"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "532020eb-81b3-4371-b6fb-cdd1bd4a89c0"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "83e1f6d5-902b-4a57-a406-92a651d66844"}, "message_list": [], "variable_list": [], "uuid": "793f399e-5e06-421e-add0-5549ba6a0aef"}, "message_list": [], "name": "action_start"}, {"description": "System action for restarting an application", "type": "system", "uuid": "15d72737-b30e-4cb6-a189-288c608589f8", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "251999d0-365a-4623-943d-67692241a960"}, {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "35e3cad4-36fd-4e5a-a9e0-1c4eefeac316"}], "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "251999d0-365a-4623-943d-67692241a960"}, "edge_type": "inherent", "type": "", "uuid": "62a53ee6-e48a-43ef-a8b3-3f817fb05a6c", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "35e3cad4-36fd-4e5a-a9e0-1c4eefeac316"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "624b8a38-5bdd-4da6-ae19-1298baa1d905"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "e6b20569-d7a8-4e35-8c21-5b0c0140c508"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "251999d0-365a-4623-943d-67692241a960"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "e915c064_runbook", "uuid": "f0f54133-4e14-4a5b-9eab-fa5ae1759743"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "35e3cad4-36fd-4e5a-a9e0-1c4eefeac316"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "624b8a38-5bdd-4da6-ae19-1298baa1d905"}, "message_list": [], "variable_list": [], "uuid": "146421b2-00c2-4ae9-a923-799ed93a13cf"}, "message_list": [], "name": "action_restart"}, {"description": "System action for stopping an application", "type": "system", "uuid": "f19f7f32-3735-42ff-846c-b32dd524d5cd", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "24905066-740b-43a7-9359-e3d5f7fbefb5"}, {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "ae20d7ae-e132-4f39-8c36-74431e10949f"}], "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "24905066-740b-43a7-9359-e3d5f7fbefb5"}, "edge_type": "inherent", "type": "", "uuid": "9f1b42da-2889-48ed-88f4-f77d51577fc5", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "ae20d7ae-e132-4f39-8c36-74431e10949f"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "0e12d9e6-da4d-4ebb-b8f2-b979ef6a5319"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2eeaf76_runbook", "uuid": "aa98207f-7711-44a6-ae33-fbc55df5fd61"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "24905066-740b-43a7-9359-e3d5f7fbefb5"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "db2ca98d-0811-4feb-bad9-5778d88d919c"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "ae20d7ae-e132-4f39-8c36-74431e10949f"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "0e12d9e6-da4d-4ebb-b8f2-b979ef6a5319"}, "message_list": [], "variable_list": [], "uuid": "35e7c20a-a8cc-4ac7-aff6-2f18190d8a8e"}, "message_list": [], "name": "action_stop"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "72266ccc-3fdc-4b56-9297-2867bfad1162", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "1068927f-d922-4234-9ff9-926b219c657a"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "c9733b7a-ea70-4e1b-8d6f-d214bef3e642"}, {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "e4386c25-e371-4f1b-88ba-320e006bf87c"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "95c3c72d-ae62-4b4c-b7a5-0be7529bc89e"}, {"kind": "app_task", "name": "SYS_GEN__DE_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "301faef1-5a38-48b9-b101-c1ec040265f0"}], "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "1068927f-d922-4234-9ff9-926b219c657a"}, "edge_type": "inherent", "type": "", "uuid": "d4152fe7-a0af-4f78-949c-7c626c3aa788", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "c9733b7a-ea70-4e1b-8d6f-d214bef3e642"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "c9733b7a-ea70-4e1b-8d6f-d214bef3e642"}, "edge_type": "inherent", "type": "", "uuid": "e405f5a0-2e1d-467e-9de3-4c39db0a77cc", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "e4386c25-e371-4f1b-88ba-320e006bf87c"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "95c3c72d-ae62-4b4c-b7a5-0be7529bc89e"}, "edge_type": "inherent", "type": "", "uuid": "46ad4d5c-47cc-4a14-b077-bde39c2092dd", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "301faef1-5a38-48b9-b101-c1ec040265f0"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "e4386c25-e371-4f1b-88ba-320e006bf87c"}, "edge_type": "inherent", "type": "", "uuid": "3e1c3192-4138-47be-9cd4-b6c6c5a70253", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "95c3c72d-ae62-4b4c-b7a5-0be7529bc89e"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "5a551b8b-ae59-4309-91ed-e65e92a381e6"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2eeaf76_runbook", "uuid": "aa98207f-7711-44a6-ae33-fbc55df5fd61"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "1068927f-d922-4234-9ff9-926b219c657a"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "6c029928_runbook", "uuid": "276d66be-0577-4634-8153-df5bc8239935"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "c9733b7a-ea70-4e1b-8d6f-d214bef3e642"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__uninstall_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "f74dfb01-c68d-4172-9066-e596ca3f30df"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "e4386c25-e371-4f1b-88ba-320e006bf87c"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "4b7968fe-611d-464c-aba4-c976bc5809a7"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "95c3c72d-ae62-4b4c-b7a5-0be7529bc89e"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "301faef1-5a38-48b9-b101-c1ec040265f0"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "5a551b8b-ae59-4309-91ed-e65e92a381e6"}, "message_list": [], "variable_list": [], "uuid": "d8e11c07-ff31-4ff7-a284-fe6f4ea38401"}, "message_list": [], "name": "action_delete"}, {"description": "System action for scaleout", "type": "system", "uuid": "eabfb4e8-b55f-4b79-aa9c-53fa02590e4c", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Deployment_Scaleout_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "79a0d38e-ed63-4d0d-a2f6-ec46e9c7dce9"}], "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "4320b557-31ab-4482-91be-aa17cf3dc4f8"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Deployment_Scaleout_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"scaling_count": "@@{scaling_count}@@", "type": "", "scaling_type": "SCALEOUT"}, "timeout_secs": "0", "type": "SCALING", "variable_list": [], "uuid": "79a0d38e-ed63-4d0d-a2f6-ec46e9c7dce9"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "4320b557-31ab-4482-91be-aa17cf3dc4f8"}, "message_list": [], "variable_list": [{"val_type": "STRING", "description": "", "name": "scaling_count", "type": "LOCAL", "value": "0", "label": "", "state": "NOT_VALIDATED", "attrs": {}, "editables": {"value": true}, "message_list": [], "uuid": "e8115c8a-38c9-43e6-8626-a71cf4b6cdf8"}], "uuid": "974f0d4b-c9c4-43b3-81ce-3abfea407faa"}, "message_list": [], "name": "action_scaleout"}, {"description": "System action for scalein", "type": "system", "uuid": "6c570ce3-8999-4b96-8aa8-7549aebd3d7b", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__Deployment_Scalein_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "326a1ad1-4261-47d1-bc20-914cc962f6fb"}], "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"edges": [], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "ea309b6a-58ed-41c9-ad69-99830de1099d"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Deployment_Scalein_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"scaling_count": "@@{scaling_count}@@", "type": "", "scaling_type": "SCALEIN"}, "timeout_secs": "0", "type": "SCALING", "variable_list": [], "uuid": "326a1ad1-4261-47d1-bc20-914cc962f6fb"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "ea309b6a-58ed-41c9-ad69-99830de1099d"}, "message_list": [], "variable_list": [{"val_type": "STRING", "description": "", "name": "scaling_count", "type": "LOCAL", "value": "0", "label": "", "state": "NOT_VALIDATED", "attrs": {}, "editables": {"value": true}, "message_list": [], "uuid": "af5f814b-8e67-468c-a332-0675518f4fb3"}], "uuid": "4b24f566-d0f0-4292-a40e-2345b9e593b5"}, "message_list": [], "name": "action_scalein"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "7a0a483c-1562-4439-b49b-aa8ce6d50f0f", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "6b966121-5a16-4082-9869-d5ffd5d432c2"}, {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "161f205b-2b35-40bd-b0aa-182d70de6315"}, {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "10d90790-fdf4-4c2b-afbe-3983f79dc9ca"}, {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "2e86bd2d-f980-46f7-b7cf-9f318ed0cb6c"}], "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "6b966121-5a16-4082-9869-d5ffd5d432c2"}, "edge_type": "inherent", "type": "", "uuid": "62bf2fa4-be8e-4389-91c1-79cdde50fca6", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "161f205b-2b35-40bd-b0aa-182d70de6315"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "10d90790-fdf4-4c2b-afbe-3983f79dc9ca"}, "edge_type": "inherent", "type": "", "uuid": "165fcc12-65f0-48e6-b9a9-a4ce47896423", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "2e86bd2d-f980-46f7-b7cf-9f318ed0cb6c"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "161f205b-2b35-40bd-b0aa-182d70de6315"}, "edge_type": "inherent", "type": "", "uuid": "e3167059-adb7-455f-8304-dbaf091b0920", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "10d90790-fdf4-4c2b-afbe-3983f79dc9ca"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "105459c8-e3ca-44c9-aeb3-11fe1d98a2ac"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "d9fc0a1b-0e74-4859-b976-81868939f10b"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "6b966121-5a16-4082-9869-d5ffd5d432c2"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Package_Element_Delete_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "161f205b-2b35-40bd-b0aa-182d70de6315"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "3509fb5f-6233-4c80-ba35-2ab5bda51f3d"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "10d90790-fdf4-4c2b-afbe-3983f79dc9ca"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Soft_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "2e86bd2d-f980-46f7-b7cf-9f318ed0cb6c"}], "description": "", "name": "SYS_GEN__Runbook_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Deployment_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "105459c8-e3ca-44c9-aeb3-11fe1d98a2ac"}, "message_list": [], "variable_list": [], "uuid": "a6421319-3aeb-48b8-99aa-e94e9ea9851a"}, "message_list": [], "name": "action_soft_delete"}], "message_list": [], "editables": {"min_replicas": true, "max_replicas": true}, "name": "fc5a5e8b_deployment", "state": "ACTIVE", "max_replicas": "2", "package_local_reference_list": [{"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}], "substrate_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "min_replicas": "2", "variable_list": [], "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}], "description": "", "action_list": [{"description": "System action for creating an application", "type": "system", "uuid": "0cb7667e-4265-4105-856a-817089d2059a", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_profile", "name": "Nutanix", "uuid": "900d8387-064c-419e-8301-4420f95dfa6b"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__DE_Provision_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "17e13df9-9eb3-4736-8b4c-51f01eb7d023"}, {"kind": "app_task", "name": "SYS_GEN__DE_Provision_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "9cc93f75-9579-47a5-92f0-870b5fa7304a"}, {"kind": "app_task", "name": "SYS_GEN__DE_Provision_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "d52b3dbf-61ae-4f15-b30b-28e90fa6b1b6"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "03b969b7-1036-4482-bbfb-31d83e181d05"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "b564b19c-bc25-4f9e-89f5-3113c542246f"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "7002ee49-4694-452e-88da-afcde559a355"}, {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "09d1e375-dcfe-42db-926b-6f9c6e96c862"}, {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "9835f9ee-eec5-4187-8bda-9c589b058845"}, {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "1e3978b1-bd19-43d1-947a-2a9045f5854d"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "2a8a1eaa-f19e-4832-965c-7691c8532d20"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "6a293170-8fec-4e1e-a7b7-2ff22bbf64f1"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "fbfcbf64-7033-4344-86a8-cd7b01284384"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "ff69968f-4ff7-48e8-97ef-c03a28f04f46"}, {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "8f22fcec-af07-4f23-a2e9-6f80f65842ff"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "8c9a23c8-ee2b-4075-90b3-3d8f62d748a6"}], "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "fbfcbf64-7033-4344-86a8-cd7b01284384"}, "edge_type": "inherent", "type": "", "uuid": "219b6a0a-ed8c-4979-9681-e924616958ec", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "ff69968f-4ff7-48e8-97ef-c03a28f04f46"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "9835f9ee-eec5-4187-8bda-9c589b058845"}, "edge_type": "inherent", "type": "", "uuid": "20bb311f-e48b-481d-9df2-c74013af6a6b", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "fbfcbf64-7033-4344-86a8-cd7b01284384"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Provision_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "9cc93f75-9579-47a5-92f0-870b5fa7304a"}, "edge_type": "inherent", "type": "", "uuid": "5d8c2dde-b247-47ce-a355-6140b6fde954", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "b564b19c-bc25-4f9e-89f5-3113c542246f"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "b564b19c-bc25-4f9e-89f5-3113c542246f"}, "edge_type": "inherent", "type": "", "uuid": "378619bc-817e-4c38-a6d2-f5b2a8a2c286", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "9835f9ee-eec5-4187-8bda-9c589b058845"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "8f22fcec-af07-4f23-a2e9-6f80f65842ff"}, "edge_type": "inherent", "type": "", "uuid": "7324edd5-704d-4fb0-b771-14f1a454e5fb", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "8c9a23c8-ee2b-4075-90b3-3d8f62d748a6"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "09d1e375-dcfe-42db-926b-6f9c6e96c862"}, "edge_type": "inherent", "type": "", "uuid": "f4a32c52-abfd-4bd8-9216-45195a5f2c2e", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "8f22fcec-af07-4f23-a2e9-6f80f65842ff"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Provision_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "17e13df9-9eb3-4736-8b4c-51f01eb7d023"}, "edge_type": "inherent", "type": "", "uuid": "a5223bc2-f598-46c9-ba93-d9b3fab57241", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "03b969b7-1036-4482-bbfb-31d83e181d05"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "03b969b7-1036-4482-bbfb-31d83e181d05"}, "edge_type": "inherent", "type": "", "uuid": "fb5bbd63-afb5-427a-88c5-a64c04deac10", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "09d1e375-dcfe-42db-926b-6f9c6e96c862"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "2a8a1eaa-f19e-4832-965c-7691c8532d20"}, "edge_type": "inherent", "type": "", "uuid": "530c439d-1274-49ed-8562-69613fef2d3d", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "6a293170-8fec-4e1e-a7b7-2ff22bbf64f1"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "1e3978b1-bd19-43d1-947a-2a9045f5854d"}, "edge_type": "inherent", "type": "", "uuid": "716dbaea-299d-4ccf-866f-72d66cdb8317", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "2a8a1eaa-f19e-4832-965c-7691c8532d20"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Provision_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "d52b3dbf-61ae-4f15-b30b-28e90fa6b1b6"}, "edge_type": "inherent", "type": "", "uuid": "cf2ddc7a-c6ab-48cc-8625-791e2bcbd718", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "7002ee49-4694-452e-88da-afcde559a355"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "7002ee49-4694-452e-88da-afcde559a355"}, "edge_type": "inherent", "type": "", "uuid": "b4136a4f-f663-4152-ae3a-ed9f57003895", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__install_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "1e3978b1-bd19-43d1-947a-2a9045f5854d"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "6a293170-8fec-4e1e-a7b7-2ff22bbf64f1"}, "edge_type": "dependency", "type": "", "uuid": "3d6f91f3-c14e-4714-adc0-4977701a375e", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "fbfcbf64-7033-4344-86a8-cd7b01284384"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "ff69968f-4ff7-48e8-97ef-c03a28f04f46"}, "edge_type": "dependency", "type": "", "uuid": "d09448c3-c924-4fcb-8dff-ac39b3e33ceb", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "8f22fcec-af07-4f23-a2e9-6f80f65842ff"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "038ece55-2943-48b5-8764-369efb674f32"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Provision_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "CREATE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "17e13df9-9eb3-4736-8b4c-51f01eb7d023"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Provision_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "CREATE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "9cc93f75-9579-47a5-92f0-870b5fa7304a"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Provision_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "CREATE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "d52b3dbf-61ae-4f15-b30b-28e90fa6b1b6"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "2900a2a1-75c9-4d53-95a5-4a6d369efb07"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "03b969b7-1036-4482-bbfb-31d83e181d05"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "c8107d8b-f026-4f14-9247-d21c84ce263a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "b564b19c-bc25-4f9e-89f5-3113c542246f"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "a8a7ae38-c2b9-470d-8f94-bd981491fd3a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "7002ee49-4694-452e-88da-afcde559a355"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__install_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "09787d82-8351-424f-bfc9-8b2ff98d3c18"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "09d1e375-dcfe-42db-926b-6f9c6e96c862"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__install_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "785d636f-4375-4b31-88a1-4cdd226c2cb8"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "9835f9ee-eec5-4187-8bda-9c589b058845"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__install_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "06b5b79e-c0da-422a-84ef-a7c47bd3fda5"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "1e3978b1-bd19-43d1-947a-2a9045f5854d"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "dade7481_runbook", "uuid": "58135bbb-91b0-4e42-8f9d-8bdfb261eaad"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "2a8a1eaa-f19e-4832-965c-7691c8532d20"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "11876906_runbook", "uuid": "e822e828-353d-4651-ad6a-f7d60355913a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "6a293170-8fec-4e1e-a7b7-2ff22bbf64f1"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "29e91e9c_runbook", "uuid": "042fc435-a86c-4df0-b6f6-4cba2968e264"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "fbfcbf64-7033-4344-86a8-cd7b01284384"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "c1427948_runbook", "uuid": "631cac91-4b75-4c10-84ab-a2b6017c6296"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "ff69968f-4ff7-48e8-97ef-c03a28f04f46"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__create_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "21430fdc_runbook", "uuid": "8557edb6-20cf-45bb-a7cc-c73043b6fcc2"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "8f22fcec-af07-4f23-a2e9-6f80f65842ff"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "fee4dd3c_runbook", "uuid": "83470714-cc17-4920-b14e-157565f1ef8c"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "8c9a23c8-ee2b-4075-90b3-3d8f62d748a6"}], "description": "", "name": "SYS_GEN__Runbook_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "uuid": "038ece55-2943-48b5-8764-369efb674f32"}, "message_list": [], "variable_list": [], "uuid": "dbaeff92-aa94-4f78-9985-c79d56c5ab17"}, "message_list": [], "name": "action_create"}, {"description": "System action for starting an application", "type": "system", "uuid": "a3da2aba-65ab-4817-b70e-711a3e2108fa", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_profile", "name": "Nutanix", "uuid": "900d8387-064c-419e-8301-4420f95dfa6b"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "3ad78869-c80f-435c-8b14-c8079d272792"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "407c31bc-38d5-4339-bf6f-9838df1e2ab5"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "9fb792f1-0bcc-41cd-a3d5-b62b7b3dfca7"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "7bb70de8-ad62-48d0-8062-c19c050087e1"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "6a18551c-3639-4ede-8ddc-405dffdfb584"}, {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "6bd55e9a-5c9d-4596-bb28-4059a7565871"}], "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "407c31bc-38d5-4339-bf6f-9838df1e2ab5"}, "edge_type": "inherent", "type": "", "uuid": "23579cbe-bec4-4d81-803b-e82e911e05d2", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "6a18551c-3639-4ede-8ddc-405dffdfb584"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "3ad78869-c80f-435c-8b14-c8079d272792"}, "edge_type": "inherent", "type": "", "uuid": "c01f34da-0c48-4994-b2cd-39908b30696b", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "6bd55e9a-5c9d-4596-bb28-4059a7565871"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "9fb792f1-0bcc-41cd-a3d5-b62b7b3dfca7"}, "edge_type": "inherent", "type": "", "uuid": "17588208-2295-4d5f-b7e9-74d9963a01ff", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "7bb70de8-ad62-48d0-8062-c19c050087e1"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "7bb70de8-ad62-48d0-8062-c19c050087e1"}, "edge_type": "create_action_edge", "type": "", "uuid": "96a9b232-6884-477d-86dc-635b83df8bfb", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "6a18551c-3639-4ede-8ddc-405dffdfb584"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "6a18551c-3639-4ede-8ddc-405dffdfb584"}, "edge_type": "create_action_edge", "type": "", "uuid": "996b9d06-3641-47a0-a96e-8661595b4d6c", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "6bd55e9a-5c9d-4596-bb28-4059a7565871"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "f5a3cc5a-c097-47ba-8de7-47c88aa80ecd"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "9bbbbf2f-1f21-4d04-9623-3135957b2fad"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "3ad78869-c80f-435c-8b14-c8079d272792"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "2621f4ad-b028-4083-bca6-1626e4496ae1"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "407c31bc-38d5-4339-bf6f-9838df1e2ab5"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "97d4cc68-bdfa-4035-bb8e-4f2b225343f8"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "9fb792f1-0bcc-41cd-a3d5-b62b7b3dfca7"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "11876906_runbook", "uuid": "e822e828-353d-4651-ad6a-f7d60355913a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "7bb70de8-ad62-48d0-8062-c19c050087e1"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "c1427948_runbook", "uuid": "631cac91-4b75-4c10-84ab-a2b6017c6296"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "6a18551c-3639-4ede-8ddc-405dffdfb584"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__start_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "fee4dd3c_runbook", "uuid": "83470714-cc17-4920-b14e-157565f1ef8c"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "6bd55e9a-5c9d-4596-bb28-4059a7565871"}], "description": "", "name": "SYS_GEN__Runbook_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "uuid": "f5a3cc5a-c097-47ba-8de7-47c88aa80ecd"}, "message_list": [], "variable_list": [], "uuid": "132224d1-98b5-460e-b6ea-af7db8c4a219"}, "message_list": [], "name": "action_start"}, {"description": "System action for restarting an application", "type": "system", "uuid": "cd6d00e1-3826-4b17-8517-a4c9f6883962", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_profile", "name": "Nutanix", "uuid": "900d8387-064c-419e-8301-4420f95dfa6b"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "ef10b812-c043-4068-86ea-d7d9a344e9b3"}, {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "df917887-9b1c-49c2-a536-9037a5023668"}, {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "03e45f05-8e1c-4e86-b171-12de27b47c2a"}, {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "8d25f935-c029-4fc8-91f0-c223ec7d83ce"}, {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "3526f137-21aa-4cd3-81b7-bdd6b47ecfc8"}, {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "ee705ec4-1859-4cdc-94d1-aedc216e77be"}], "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "df917887-9b1c-49c2-a536-9037a5023668"}, "edge_type": "inherent", "type": "", "uuid": "468ed5da-6bb8-4053-b99f-292f7f8c6190", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "3526f137-21aa-4cd3-81b7-bdd6b47ecfc8"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "03e45f05-8e1c-4e86-b171-12de27b47c2a"}, "edge_type": "inherent", "type": "", "uuid": "b63276d0-a94f-4258-a47d-5483b9a384e5", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "ee705ec4-1859-4cdc-94d1-aedc216e77be"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "ef10b812-c043-4068-86ea-d7d9a344e9b3"}, "edge_type": "inherent", "type": "", "uuid": "54729141-e095-4b68-9e44-1da211e8c940", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "8d25f935-c029-4fc8-91f0-c223ec7d83ce"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "8d25f935-c029-4fc8-91f0-c223ec7d83ce"}, "edge_type": "create_action_edge", "type": "", "uuid": "aedd7b76-5ec8-4f1f-bdf3-cb95d164ece7", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "3526f137-21aa-4cd3-81b7-bdd6b47ecfc8"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "3526f137-21aa-4cd3-81b7-bdd6b47ecfc8"}, "edge_type": "create_action_edge", "type": "", "uuid": "09cee7f1-9b1c-41a8-bdcd-c34ad3217e82", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__restart_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "ee705ec4-1859-4cdc-94d1-aedc216e77be"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "1d91076d-c3e3-442a-9e31-48813f7e5ac9"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "c220e32d-de12-444a-910f-fd1720e163c8"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "ef10b812-c043-4068-86ea-d7d9a344e9b3"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "c1b079ac-5f44-4f74-916e-228a20c522bf"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "df917887-9b1c-49c2-a536-9037a5023668"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "e6b20569-d7a8-4e35-8c21-5b0c0140c508"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "03e45f05-8e1c-4e86-b171-12de27b47c2a"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "4150545e_runbook", "uuid": "525f4db7-9369-478a-a1c9-99518e03e93e"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "8d25f935-c029-4fc8-91f0-c223ec7d83ce"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "73c06dcc_runbook", "uuid": "9a54b194-21f3-4c63-b3ef-d53d30553649"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "3526f137-21aa-4cd3-81b7-bdd6b47ecfc8"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__restart_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "e915c064_runbook", "uuid": "f0f54133-4e14-4a5b-9eab-fa5ae1759743"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "ee705ec4-1859-4cdc-94d1-aedc216e77be"}], "description": "", "name": "SYS_GEN__Runbook_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "uuid": "1d91076d-c3e3-442a-9e31-48813f7e5ac9"}, "message_list": [], "variable_list": [], "uuid": "d8993b4d-64b4-42b3-b98a-a34c40b36ac1"}, "message_list": [], "name": "action_restart"}, {"description": "System action for stopping an application", "type": "system", "uuid": "b3ad0491-248c-49bf-b1a9-29681ef0be81", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_profile", "name": "Nutanix", "uuid": "900d8387-064c-419e-8301-4420f95dfa6b"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "9a0352cb-59a7-4560-94d6-d7170e8b57a2"}, {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "068b1fb0-20e2-49e5-a316-f2157b1c172e"}, {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "0195f05a-f065-4a4b-af9b-bab07063e15d"}, {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "80de1aa4-b01b-4b0a-83de-29a3265207e7"}, {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "9c08814d-65c5-4f73-9b32-6146ca165448"}, {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "c402a60f-644c-4db4-80bb-eb2cc4f7fd41"}], "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "0195f05a-f065-4a4b-af9b-bab07063e15d"}, "edge_type": "inherent", "type": "", "uuid": "19403e38-68cf-4564-ab50-d3732801f348", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "80de1aa4-b01b-4b0a-83de-29a3265207e7"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "9a0352cb-59a7-4560-94d6-d7170e8b57a2"}, "edge_type": "inherent", "type": "", "uuid": "0507b79e-fac5-48d8-a7cf-5a2fe2f97267", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "068b1fb0-20e2-49e5-a316-f2157b1c172e"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "9c08814d-65c5-4f73-9b32-6146ca165448"}, "edge_type": "inherent", "type": "", "uuid": "d8d7e5af-ff6d-4c83-9d33-574f20f2d8d5", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "c402a60f-644c-4db4-80bb-eb2cc4f7fd41"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "0195f05a-f065-4a4b-af9b-bab07063e15d"}, "edge_type": "create_action_edge", "type": "", "uuid": "be370ce9-d08e-4626-83f5-b847d7f53684", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "9c08814d-65c5-4f73-9b32-6146ca165448"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "9a0352cb-59a7-4560-94d6-d7170e8b57a2"}, "edge_type": "create_action_edge", "type": "", "uuid": "696b794d-5a62-4c8c-9c28-bac8b7c49bfb", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "0195f05a-f065-4a4b-af9b-bab07063e15d"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "712eebcb-714c-4b74-a3d3-f38ff8e3c697"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2eeaf76_runbook", "uuid": "aa98207f-7711-44a6-ae33-fbc55df5fd61"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "9a0352cb-59a7-4560-94d6-d7170e8b57a2"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "db2ca98d-0811-4feb-bad9-5778d88d919c"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "068b1fb0-20e2-49e5-a316-f2157b1c172e"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2d07af0_runbook", "uuid": "08fe1064-8629-40b1-84b8-72356d4ca6ee"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "0195f05a-f065-4a4b-af9b-bab07063e15d"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "facc6151-0ab3-45d6-abdd-4b310c412e00"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "80de1aa4-b01b-4b0a-83de-29a3265207e7"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "d2728354_runbook", "uuid": "2227c943-6a01-4b4f-b5f9-d748009e7ff1"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "9c08814d-65c5-4f73-9b32-6146ca165448"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "3aec85b3-a5af-4c55-8c53-078ca9313d67"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "c402a60f-644c-4db4-80bb-eb2cc4f7fd41"}], "description": "", "name": "SYS_GEN__Runbook_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "uuid": "712eebcb-714c-4b74-a3d3-f38ff8e3c697"}, "message_list": [], "variable_list": [], "uuid": "22c2023b-8a76-4820-8956-ae24af9ee4a0"}, "message_list": [], "name": "action_stop"}, {"description": "System action for deleting an application. Deletes created VMs as well", "type": "system", "uuid": "39680ae5-aedf-4951-b357-78f61c3d83b7", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_profile", "name": "Nutanix", "uuid": "900d8387-064c-419e-8301-4420f95dfa6b"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "d465429c-e74c-4ce6-a469-33d8cf2438e4"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "8e7bdde6-41eb-436e-bea9-31743283c004"}, {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "289a3e0c-b6c4-4b66-9855-592b096c2179"}, {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "aa2a3b73-ed2a-489f-961d-35856d1ab529"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "73024793-e14a-435a-b11f-00487c40f0f6"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "fdb66aec-2552-41e0-9701-067bdeda7497"}, {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "87a959d0-dbbd-4638-a52c-f2779dff9845"}, {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "309f7c88-a951-40ea-b5f5-a511e1792545"}, {"kind": "app_task", "name": "SYS_GEN__DE_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "80537c80-e976-4e16-84c3-af5be86fdedf"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "b2bc0ef1-06ef-46ce-9471-8a26ef1d808f"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "efef8c3e-bf89-4150-b9b4-801767d023aa"}, {"kind": "app_task", "name": "SYS_GEN__DE_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "61dfb90f-8708-498e-9dac-dd5f9cba15fc"}, {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "29ce67df-a7b6-47c5-bcb3-c3c3940ebc23"}, {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "84a09c81-4ceb-4954-a003-36587ac9a07a"}, {"kind": "app_task", "name": "SYS_GEN__DE_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "98cf7e84-ff1b-4b62-8f84-b3885768c9cf"}], "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "aa2a3b73-ed2a-489f-961d-35856d1ab529"}, "edge_type": "inherent", "type": "", "uuid": "42c7021a-c996-49f1-8f97-db26a6c2bae6", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "fdb66aec-2552-41e0-9701-067bdeda7497"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "fdb66aec-2552-41e0-9701-067bdeda7497"}, "edge_type": "inherent", "type": "", "uuid": "6a21a0f9-7ecb-471d-bc76-05399d009afa", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "309f7c88-a951-40ea-b5f5-a511e1792545"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "b2bc0ef1-06ef-46ce-9471-8a26ef1d808f"}, "edge_type": "inherent", "type": "", "uuid": "baf41c7e-235c-4c11-9a88-1081029741d6", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "61dfb90f-8708-498e-9dac-dd5f9cba15fc"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "309f7c88-a951-40ea-b5f5-a511e1792545"}, "edge_type": "inherent", "type": "", "uuid": "63a0674d-90c9-4b90-98ce-b00e65f72dbc", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "b2bc0ef1-06ef-46ce-9471-8a26ef1d808f"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "d465429c-e74c-4ce6-a469-33d8cf2438e4"}, "edge_type": "inherent", "type": "", "uuid": "811a6b83-7244-4c92-9b86-18847b7cee8d", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "8e7bdde6-41eb-436e-bea9-31743283c004"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "8e7bdde6-41eb-436e-bea9-31743283c004"}, "edge_type": "inherent", "type": "", "uuid": "b7de7eec-f2d3-4686-93f2-d05bcd893499", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "289a3e0c-b6c4-4b66-9855-592b096c2179"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "73024793-e14a-435a-b11f-00487c40f0f6"}, "edge_type": "inherent", "type": "", "uuid": "db70f710-ad15-4332-aba5-cee3fdbb9000", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "80537c80-e976-4e16-84c3-af5be86fdedf"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "289a3e0c-b6c4-4b66-9855-592b096c2179"}, "edge_type": "inherent", "type": "", "uuid": "7bc99ccd-dcac-4604-a7a6-cf754f2d3718", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "73024793-e14a-435a-b11f-00487c40f0f6"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "87a959d0-dbbd-4638-a52c-f2779dff9845"}, "edge_type": "inherent", "type": "", "uuid": "e7683be2-5a3b-4c35-ac31-70f3deb24fd5", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "efef8c3e-bf89-4150-b9b4-801767d023aa"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "efef8c3e-bf89-4150-b9b4-801767d023aa"}, "edge_type": "inherent", "type": "", "uuid": "4752c707-78c5-4aa1-8aac-ae0d34fa7719", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "29ce67df-a7b6-47c5-bcb3-c3c3940ebc23"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "84a09c81-4ceb-4954-a003-36587ac9a07a"}, "edge_type": "inherent", "type": "", "uuid": "bb7692d2-0e47-4936-85ce-1a09dbc32eba", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "98cf7e84-ff1b-4b62-8f84-b3885768c9cf"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__uninstall_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "29ce67df-a7b6-47c5-bcb3-c3c3940ebc23"}, "edge_type": "inherent", "type": "", "uuid": "48e26298-a412-421e-990d-0eea2dbcc370", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "84a09c81-4ceb-4954-a003-36587ac9a07a"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "fdb66aec-2552-41e0-9701-067bdeda7497"}, "edge_type": "create_action_edge", "type": "", "uuid": "f2883387-eabc-488f-9c0a-d9c6d613930d", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "87a959d0-dbbd-4638-a52c-f2779dff9845"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "8e7bdde6-41eb-436e-bea9-31743283c004"}, "edge_type": "create_action_edge", "type": "", "uuid": "aa419964-8dc4-471e-b24e-f1c20e4e2f3e", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "aa2a3b73-ed2a-489f-961d-35856d1ab529"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "fa531f1f-e236-4d17-a461-c8051c88ae3e"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2eeaf76_runbook", "uuid": "aa98207f-7711-44a6-ae33-fbc55df5fd61"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "d465429c-e74c-4ce6-a469-33d8cf2438e4"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "6c029928_runbook", "uuid": "276d66be-0577-4634-8153-df5bc8239935"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "8e7bdde6-41eb-436e-bea9-31743283c004"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__uninstall_CRb_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "f74dfb01-c68d-4172-9066-e596ca3f30df"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "289a3e0c-b6c4-4b66-9855-592b096c2179"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "b2d07af0_runbook", "uuid": "08fe1064-8629-40b1-84b8-72356d4ca6ee"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "aa2a3b73-ed2a-489f-961d-35856d1ab529"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "4b7968fe-611d-464c-aba4-c976bc5809a7"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "73024793-e14a-435a-b11f-00487c40f0f6"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "22428294_runbook", "uuid": "de943f5f-693e-4a9c-9642-5f51b1e2e081"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "fdb66aec-2552-41e0-9701-067bdeda7497"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__stop_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "d2728354_runbook", "uuid": "2227c943-6a01-4b4f-b5f9-d748009e7ff1"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "87a959d0-dbbd-4638-a52c-f2779dff9845"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__uninstall_CRb_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "8acf3f85-5155-48b8-b8de-a5fe74733282"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "309f7c88-a951-40ea-b5f5-a511e1792545"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "80537c80-e976-4e16-84c3-af5be86fdedf"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "05e6b137-bddf-4644-ae7e-55a055af3289"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "b2bc0ef1-06ef-46ce-9471-8a26ef1d808f"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "59afb4f4_runbook", "uuid": "ce606f1a-cd67-4456-8823-df98e0d20936"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "efef8c3e-bf89-4150-b9b4-801767d023aa"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "61dfb90f-8708-498e-9dac-dd5f9cba15fc"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__uninstall_CRb_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Package_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "094213a3-cf7f-49cc-a078-cde57059e254"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "29ce67df-a7b6-47c5-bcb3-c3c3940ebc23"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "cc049242-7025-433a-8eb7-46374da90b01"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "84a09c81-4ceb-4954-a003-36587ac9a07a"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "98cf7e84-ff1b-4b62-8f84-b3885768c9cf"}], "description": "", "name": "SYS_GEN__Runbook_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "uuid": "fa531f1f-e236-4d17-a461-c8051c88ae3e"}, "message_list": [], "variable_list": [], "uuid": "68d5026f-3812-4c8a-9f43-2e13a87e6ce4"}, "message_list": [], "name": "action_delete"}, {"description": "System action for deleting an application. Does not delete created VMs", "type": "system", "uuid": "94ce0e29-db07-429b-b67d-d1bfe7206f9c", "state": "ACTIVE", "critical": true, "attrs": {}, "runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_profile", "name": "Nutanix", "uuid": "900d8387-064c-419e-8301-4420f95dfa6b"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "2105b429-8dbb-47e9-9c71-2c5312cfbcd6"}, {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "38012f35-4745-4eaf-91be-44306e6b19c0"}, {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "d2e3a93a-3f51-4cbb-809e-458dc153e33d"}, {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "e9051686-89c1-45a8-a66e-141fd460561a"}, {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "6c93d321-050c-4c7c-9478-c860c915ec7c"}, {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "27f3f598-bffa-4355-82e6-ce5a0fbd7acb"}, {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "79655b66-bdc6-4c8b-9ba7-dc902fa47236"}, {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "b08c2a20-1eec-4de8-bf44-49167226c897"}, {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "0f9fd6f6-df2a-4696-a18e-0770aa9bcc27"}, {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "f0476bda-1ca2-4f99-8f77-2b2640fc97eb"}, {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "dac4c4a4-8a4a-42f0-84a1-1350b2ce433a"}, {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "c9ba317a-d51b-4a01-9a91-2e7550254a26"}], "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "38012f35-4745-4eaf-91be-44306e6b19c0"}, "edge_type": "inherent", "type": "", "uuid": "ef9cecb5-90fb-4a18-a2d8-14103989f3cf", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "6c93d321-050c-4c7c-9478-c860c915ec7c"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "79655b66-bdc6-4c8b-9ba7-dc902fa47236"}, "edge_type": "inherent", "type": "", "uuid": "41c2be20-3109-4416-95ef-ba19fae49186", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "uuid": "f0476bda-1ca2-4f99-8f77-2b2640fc97eb"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_75de5261_70f2_442f_b33c_708f7b2b8844", "uuid": "6c93d321-050c-4c7c-9478-c860c915ec7c"}, "edge_type": "inherent", "type": "", "uuid": "d76ee998-b95d-41fb-a6cb-f58683ed12b9", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "79655b66-bdc6-4c8b-9ba7-dc902fa47236"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "2105b429-8dbb-47e9-9c71-2c5312cfbcd6"}, "edge_type": "inherent", "type": "", "uuid": "d29113f5-b2e8-4e8f-9b50-846e1e398d27", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "d2e3a93a-3f51-4cbb-809e-458dc153e33d"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "27f3f598-bffa-4355-82e6-ce5a0fbd7acb"}, "edge_type": "inherent", "type": "", "uuid": "74546dc5-2e3b-4c3c-84e1-ed650c3942bd", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "uuid": "0f9fd6f6-df2a-4696-a18e-0770aa9bcc27"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "uuid": "d2e3a93a-3f51-4cbb-809e-458dc153e33d"}, "edge_type": "inherent", "type": "", "uuid": "7fea5669-1174-4ccc-9afc-c872cf7d2051", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "27f3f598-bffa-4355-82e6-ce5a0fbd7acb"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "e9051686-89c1-45a8-a66e-141fd460561a"}, "edge_type": "inherent", "type": "", "uuid": "1ea9653e-02cd-41c0-b5c7-24865415f0f6", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "b08c2a20-1eec-4de8-bf44-49167226c897"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "dac4c4a4-8a4a-42f0-84a1-1350b2ce433a"}, "edge_type": "inherent", "type": "", "uuid": "ea9448ae-f265-4c74-8751-f0066e6fc251", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__DE_Soft_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "uuid": "c9ba317a-d51b-4a01-9a91-2e7550254a26"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__Package_Element_Delete_3961925d_16b8_4617_ab92_ed107d08a79d", "uuid": "b08c2a20-1eec-4de8-bf44-49167226c897"}, "edge_type": "inherent", "type": "", "uuid": "62e78f4c-9107-4f39-964c-c28ab45e4e9c", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "dac4c4a4-8a4a-42f0-84a1-1350b2ce433a"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "38012f35-4745-4eaf-91be-44306e6b19c0"}, "edge_type": "create_action_edge", "type": "", "uuid": "bbf84e02-780e-42ed-9ecc-fca8ce1e6ff0", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "e9051686-89c1-45a8-a66e-141fd460561a"}}, {"from_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "2105b429-8dbb-47e9-9c71-2c5312cfbcd6"}, "edge_type": "create_action_edge", "type": "", "uuid": "33da5e5f-b03f-4993-a4f8-35482bfe9f03", "to_task_reference": {"kind": "app_task", "name": "SYS_GEN__soft_delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "38012f35-4745-4eaf-91be-44306e6b19c0"}}], "type": "DAG"}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "uuid": "f5634279-b976-48c7-9731-d0e255af2d4d"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront", "uuid": "4cc17a1e-14d5-486f-b620-821f7b4ad675"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Service_4cc17a1e_14d5_486f_b620_821f7b4ad675", "uuid": "d9fc0a1b-0e74-4859-b976-81868939f10b"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "2105b429-8dbb-47e9-9c71-2c5312cfbcd6"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC", "uuid": "0f4462ba-c05d-49e4-beba-54afe197b4f3"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Service_0f4462ba_c05d_49e4_beba_54afe197b4f3", "uuid": "d24a316a-2dee-4081-9d10-b5986a67ad23"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "38012f35-4745-4eaf-91be-44306e6b19c0"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package", "uuid": "360f400a-1cbe-4c32-99a1-50a6d96e8a80"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Package_Element_Delete_360f400a_1cbe_4c32_99a1_50a6d96e8a80", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "d2e3a93a-3f51-4cbb-809e-458dc153e33d"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL", "uuid": "21d0a248-e036-42d5-9ee5-44e1600069f2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Service_21d0a248_e036_42d5_9ee5_44e1600069f2", "uuid": "0942c9ef-1ecf-4cca-bca2-be37bb12790a"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "e9051686-89c1-45a8-a66e-141fd460561a"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package", "uuid": "75de5261-70f2-442f-b33c-708f7b2b8844"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Package_Element_Delete_75de5261_70f2_442f_b33c_708f7b2b8844", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "6c93d321-050c-4c7c-9478-c860c915ec7c"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront", "uuid": "7566c682-5d05-4aa5-8202-73a2c9bea388"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_7566c682_5d05_4aa5_8202_73a2c9bea388", "uuid": "3509fb5f-6233-4c80-ba35-2ab5bda51f3d"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "27f3f598-bffa-4355-82e6-ce5a0fbd7acb"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_DDC", "uuid": "38ae7975-af4c-4865-b45b-1fb4f1e8c271"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_38ae7975_af4c_4865_b45b_1fb4f1e8c271", "uuid": "143f12fb-5bd4-489a-bf10-759f2cbeb491"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "79655b66-bdc6-4c8b-9ba7-dc902fa47236"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package", "uuid": "3961925d-16b8-4617-ab92-ed107d08a79d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__Package_Element_Delete_3961925d_16b8_4617_ab92_ed107d08a79d", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_ELEMENT", "variable_list": [], "uuid": "b08c2a20-1eec-4de8-bf44-49167226c897"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "fc5a5e8b_deployment", "uuid": "793ee738-079e-4f72-b692-9b5be0238e4d"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Soft_Delete_793ee738_079e_4f72_b692_9b5be0238e4d", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "0f9fd6f6-df2a-4696-a18e-0770aa9bcc27"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "c693df12_deployment", "uuid": "031cc8be-dfcc-4839-b956-a18c9f2c9f77"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Soft_Delete_031cc8be_dfcc_4839_b956_a18c9f2c9f77", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "f0476bda-1ca2-4f99-8f77-2b2640fc97eb"}, {"target_any_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL", "uuid": "f4e0be58-58e7-4758-8202-b350eeb50ed2"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__soft_delete_CRb_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "state": "ACTIVE", "attrs": {"type": "CALL_RUNBOOK", "deployment_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "inarg_list": [], "runbook_reference": {"kind": "app_runbook", "name": "SYS_GEN__Runbook_Substrate_f4e0be58_58e7_4758_8202_b350eeb50ed2", "uuid": "af183eaa-f234-4253-ae56-c76e21d553d2"}}, "timeout_secs": "0", "type": "CALL_RUNBOOK", "variable_list": [], "uuid": "dac4c4a4-8a4a-42f0-84a1-1350b2ce433a"}, {"target_any_local_reference": {"kind": "app_blueprint_deployment", "name": "5aed8000_deployment", "uuid": "5ebed1ee-2890-482c-bc1f-2063f3767ed4"}, "retries": "0", "description": "", "message_list": [], "child_tasks_local_reference_list": [], "name": "SYS_GEN__DE_Soft_Delete_5ebed1ee_2890_482c_bc1f_2063f3767ed4", "state": "ACTIVE", "attrs": {"type": ""}, "timeout_secs": "0", "type": "SOFT_DELETE_DEPLOYMENT_ELEMENT", "variable_list": [], "uuid": "c9ba317a-d51b-4a01-9a91-2e7550254a26"}], "description": "", "name": "SYS_GEN__Runbook_Application_900d8387_064c_419e_8301_4420f95dfa6b", "state": "ACTIVE", "main_task_local_reference": {"kind": "app_task", "name": "SYS_GEN__Composite_DAG_Application_900d8387_064c_419e_8301_4420f95dfa6b", "uuid": "f5634279-b976-48c7-9731-d0e255af2d4d"}, "message_list": [], "variable_list": [], "uuid": "c467c5da-c923-46aa-a433-d77bee62c8c5"}, "message_list": [], "name": "action_soft_delete"}], "name": "Nutanix", "state": "ACTIVE", "message_list": [], "dependency_list": [{"getter_resource_kind": "ServiceCfg", "setter_resource_attr": "address", "setter_resource_kind": "ServiceCfg", "setter_resource_name": "MSSQL", "action_name": "action_create", "action_resource_name": "Nutanix", "getter_resource_name": "DDC", "action_resource_kind": "ApplicationCfg"}, {"getter_resource_kind": "ServiceCfg", "setter_resource_attr": "FQDN", "setter_resource_kind": "ServiceCfg", "setter_resource_name": "DDC", "action_name": "action_create", "action_resource_name": "Nutanix", "getter_resource_name": "StoreFront", "action_resource_kind": "ApplicationCfg"}], "variable_list": [{"val_type": "STRING", "description": "", "name": "DOMAIN", "type": "LOCAL", "value": "nucalm.com", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "1446b4dc-a679-49b7-bfd2-4196641c9ad7"}, {"val_type": "STRING", "description": "", "name": "AD_IP", "type": "LOCAL", "value": "10.15.193.31", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "31ee4207-aed9-41f3-a1b8-a914b4f74438"}, {"val_type": "STRING", "description": "", "name": "PE_IP", "type": "LOCAL", "value": "10.5.67.138", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "f87763c5-f7e0-4be0-b268-a84858ce5fef"}, {"val_type": "STRING", "description": "", "name": "PE_DATA_SERVICE_IP", "type": "LOCAL", "value": "10.5.67.143", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "7b08d487-7837-4b98-a70c-a775e41d275c"}, {"val_type": "STRING", "description": "", "name": "Nutanix_Container_Name", "type": "LOCAL", "value": "default-container-43360047467620", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "f227f90a-042e-4b59-b497-e11b9687919e"}, {"val_type": "STRING", "description": "", "name": "Volume_GroupName", "type": "LOCAL", "value": "SQL_VolumeGroup119", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "365219e5-1b30-4b07-ae62-29458ee574f0"}, {"val_type": "STRING", "description": "", "name": "FAILOVER_CLUSTER_NAME", "type": "LOCAL", "value": "NTNX-CLS119", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "92ebb864-d81c-4494-9150-b40d4f677415"}, {"val_type": "STRING", "description": "", "name": "SQL_CLUSTER_NAME", "type": "LOCAL", "value": "NTNX-SQLCLS119", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "39dbf825-a65e-4a60-b285-47cd129256c3"}, {"val_type": "STRING", "description": "", "name": "FAILOVER_VIP", "type": "LOCAL", "value": "10.5.64.2", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "b1a517a5-3006-44b6-9171-ee046146c675"}, {"val_type": "STRING", "description": "", "name": "MSSQL_VIP", "type": "LOCAL", "value": "10.5.64.3", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "c129fa83-31d2-484f-9687-0b3cd5602598"}, {"val_type": "STRING", "description": "", "name": "NutanixAcropolisPlugin", "type": "LOCAL", "value": "http://10.7.1.7/data1/software/Citrix-XD/NutanixAHV-MCS-XD7.9_or_later_1.1.3.0.msi", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "599c4508-34aa-4858-8850-0679e043d27b"}, {"val_type": "STRING", "description": "", "name": "NutanixAcropolis_Installed_Path", "type": "LOCAL", "value": "C:\\Program Files\\Common Files\\Citrix\\HCLPlugins\\CitrixMachineCreation\\v1.0.0.0", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "827b4b1b-a47f-489d-a838-df23a3088a1e"}, {"val_type": "STRING", "description": "", "name": "XD_SITE_NAME", "type": "LOCAL", "value": "BLR", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "da43d6dc-f20e-4e4b-a8d1-8afad3ab640d"}, {"val_type": "STRING", "description": "", "name": "CVM_NETWORK", "type": "LOCAL", "value": "vlan.0", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "6a2fb02f-cd24-43bd-acba-54ca44c6a7c0"}, {"val_type": "STRING", "description": "", "name": "BPG_RKTOOLS_URL", "type": "LOCAL", "value": "http://download.microsoft.com/download/8/e/c/8ec3a7d8-05b4-440a-a71e-ca3ee25fe057/rktools.exe", "label": "", "state": "ACTIVE", "attrs": {"type": ""}, "editables": {"value": true}, "message_list": [], "uuid": "5ff2d0c8-1702-4669-a24a-3004d8075c2e"}], "uuid": "900d8387-064c-419e-8301-4420f95dfa6b"}], "default_credential_local_reference": {"kind": "app_credential", "name": "LOCAL", "uuid": "6174bdcb-d1de-4e33-bb60-b6eae2a293d4"}, "type": "USER"}, "name": "Xen Desktop"}, "spec": {"description": "", "resources": {"service_definition_list": [{"singleton": false, "name": "MSSQL", "action_list": [{"critical": false, "type": "system", "description": "System action for creating an application", "name": "action_create", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "98f8161b_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "98f8161b_dag"}, "name": "dade7481_runbook"}}, {"critical": false, "type": "system", "description": "System action for deleting an application. Deletes created VMs as well", "name": "action_delete", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "02628fa5_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "02628fa5_dag"}, "name": "59afb4f4_runbook"}}, {"critical": false, "type": "system", "description": "System action for starting an application", "name": "action_start", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "8e5f51b4_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "8e5f51b4_dag"}, "name": "11876906_runbook"}}, {"critical": false, "type": "system", "description": "System action for stopping an application", "name": "action_stop", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "1a17e568_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "1a17e568_dag"}, "name": "d2728354_runbook"}}, {"critical": false, "type": "system", "description": "System action for restarting an application", "name": "action_restart", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "27dfdc04_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "27dfdc04_dag"}, "name": "4150545e_runbook"}}], "description": "", "port_list": [], "tier": "", "variable_list": [{"val_type": "STRING", "description": "", "value": "", "label": "", "attrs": {"type": ""}, "type": "LOCAL", "name": "EXECUTION_MODE"}], "depends_on_list": []}, {"singleton": false, "name": "DDC", "action_list": [{"critical": false, "type": "system", "description": "System action for creating an application", "name": "action_create", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [{"kind": "app_task", "name": "SiteCreation"}, {"kind": "app_task", "name": "EnableLocalMode"}, {"kind": "app_task", "name": "JoinRemainingNodes"}, {"kind": "app_task", "name": "DIsableLocalMode"}, {"kind": "app_task", "name": "CreateResources"}, {"kind": "app_task", "name": "GetFQDN"}, {"kind": "app_task", "name": "EnableLocalMode1"}, {"kind": "app_task", "name": "Post MSSQL tasks"}, {"kind": "app_task", "name": "CreateUsers"}], "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "SiteCreation"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "EnableLocalMode"}}, {"from_task_reference": {"kind": "app_task", "name": "EnableLocalMode"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "JoinRemainingNodes"}}, {"from_task_reference": {"kind": "app_task", "name": "JoinRemainingNodes"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "DIsableLocalMode"}}, {"from_task_reference": {"kind": "app_task", "name": "DIsableLocalMode"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "CreateResources"}}, {"from_task_reference": {"kind": "app_task", "name": "CreateResources"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "GetFQDN"}}, {"from_task_reference": {"kind": "app_task", "name": "GetFQDN"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "EnableLocalMode1"}}, {"from_task_reference": {"kind": "app_task", "name": "EnableLocalMode1"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Post MSSQL tasks"}}, {"from_task_reference": {"kind": "app_task", "name": "Post MSSQL tasks"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "CreateUsers"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "aaa51f8e_dag"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n  echo exiting\n  exit\n}\necho \"@@{MSSQL.address}@@\"\n$DatabaseServer = \"@@{SQL_CLUSTER_NAME}@@\"\n$DatabaseName_Site = \"@@{XD_SITE_NAME}@@\" + \"_Site\"\n$DatabaseName_Logging = \"@@{XD_SITE_NAME}@@\" + \"_Logging\"\n$DatabaseName_Monitor = \"@@{XD_SITE_NAME}@@\" + \"_Monitor\"\n\n# Database user must be sysadmin on db server\n#$DatabaseUser = \"@@{SQL_CREDS.username}@@\"\n$DatabaseUser = \"sqlservice@nucalm.com\"\n$DatabasePassword = \"@@{SQL_CREDS.secret}@@\"\n\n$XD7Site = \"@@{XD_SITE_NAME}@@\"\n\n$DatabasePassword = $DatabasePassword | ConvertTo-SecureString -asPlainText -Force\n$Database_CredObject = New-Object System.Management.Automation.PSCredential($DatabaseUser,$DatabasePassword)\n\nAdd-PSSnapin Citrix.*\nNew-XDDatabase -AdminAddress $env:COMPUTERNAME -SiteName $XD7Site -DataStore Site -DatabaseServer $DatabaseServer -DatabaseName $DatabaseName_Site -DatabaseCredentials $Database_CredObject\nNew-XDDatabase -AdminAddress $env:COMPUTERNAME -SiteName $XD7Site -DataStore Logging -DatabaseServer $DatabaseServer -DatabaseName $DatabaseName_Logging -DatabaseCredentials $Database_CredObject\nNew-XDDatabase -AdminAddress $env:COMPUTERNAME -SiteName $XD7Site -DataStore Monitor -DatabaseServer $DatabaseServer -DatabaseName $DatabaseName_Monitor -DatabaseCredentials $Database_CredObject\n\nNew-XDSite -DatabaseServer $DatabaseServer -LoggingDatabaseName $DatabaseName_Logging -MonitorDatabaseName $DatabaseName_Monitor -SiteDatabaseName $DatabaseName_Site -SiteName $XD7Site -AdminAddress $env:COMPUTERNAME \n\nSet-XDLicensing -LicenseServerAddress $ENV:COMPUTERNAME -LicenseServerPort 27000\n$netbios = \"@@{DOMAIN}@@\".Split(\".\")[0].ToUpper()\n$FullAdminGroup = \"$netbios\\Domain Admins\"\n\nNew-AdminAdministrator -AdminAddress $env:COMPUTERNAME -Name $FullAdminGroup\nAdd-AdminRight -AdminAddress $env:COMPUTERNAME -Administrator $FullAdminGroup -Role 'Full Administrator' -All"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "name": "SiteCreation"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=LOCAL\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "name": "EnableLocalMode"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -eq \"0\"){\n  echo \"exiting\"\n  exit\n}\n$script = {\n\t$DatabaseUser = \"@@{SQL_CREDS.username}@@\"\n\t$DatabasePassword = \"@@{SQL_CREDS.secret}@@\"\n    $DatabasePassword = $DatabasePassword | ConvertTo-SecureString -asPlainText -Force\n    $Database_CredObject = New-Object System.Management.Automation.PSCredential($DatabaseUser,$DatabasePassword)\n\n    Add-XDController -AdminAddress @@{address}@@ -SiteControllerAddress @@{calm_array_address[0]}@@ -DatabaseCredentials $Database_CredObject\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "name": "JoinRemainingNodes"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "name": "DIsableLocalMode"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n  exit\n}\n[string]$ConnectionName = \"NutanixAcropolis\"\n[string]$HostingUnitName = \"NutanixResources\"\n[string]$AHVIP = \"@@{PE_IP}@@\"\n[string]$Username = \"@@{PE_CREDS.username}@@\"\n[string]$Password = \"@@{PE_CREDS.secret}@@\"\n[string]$NetworkId = \"@@{CVM_NETWORK}@@\"\n[string]$ConnectionType = \"Custom\"\n[string]$PluginId = \"AcropolisFactory\"\n\n\n$ErrorActionPreference = \"Stop\"\nAdd-PSSnapin -Name Citrix.*\n\n$connection = Get-Item -Path \"xdhyp:\\Connections\\*\" | Where-Object {$_.PSChildName -eq $ConnectionName}\nif ($connection -eq $null) {\n\n   $connection = New-Item -Path \"xdhyp:\\Connections\" -Name $ConnectionName -ConnectionType $ConnectionType -PluginId $PluginId -HypervisorAddress $AHVIP -UserName $Username -Password $Password -Persist\n\n   New-BrokerHypervisorConnection -HypHypervisorConnectionUid $connection.HypervisorConnectionUid\n\n   $hupath = \"xdhyp:\\HostingUnits\\$HostingUnitName\"\n\n   $rootpath = \"$($connection | select -ExpandProperty FullPath)\" + '\\'\n\n   New-Item -Path $hupath -HypervisorConnectionName $ConnectionName -NetworkPath \"XDHyp:\\Connections\\Nutanix\\$($NetworkId).network\" -RootPath $rootpath\n\n} else {\n    Write-Output \"Connection $ConnectionName already exists\"\n}", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "DOMAIN_CRED"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "name": "CreateResources"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"exit_status": [], "script": "Write-Output \"FQDN=$env:computername.$env:userdnsdomain\"\nWrite-Output \"HOSTNAME=$env:computername\"", "eval_variables": ["FQDN", "HOSTNAME"], "eval_scope": "local", "login_credential_local_reference": {"kind": "app_credential", "name": "DOMAIN_CRED"}, "type": "", "script_type": "sh"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "name": "GetFQDN"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=LOCAL\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "name": "EnableLocalMode1"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n  echo exiting\n  exit\n}\n\n$MSSQL_NODES = \"@@{MSSQL.address}@@\".Split(',')\n\n$script={\n\t\n  if (\"$(Get-ClusterNode | where {$_.Id -eq 1} | select -ExpandProperty Name)\" -ne \"$(hostname)\"){\n      exit\n  }\n  $AGName = '@@{SQL_CLUSTER_NAME}@@' # change listener name\n  $PrimaryNode = $(hostname)\n  $cname = (Get-Cluster -name $PrimaryNode).name\n  $nodes = (get-clusternode -Cluster $cname).name\n\n  New-Item -Path \"C:\\DbShare\" -ItemType \"directory\"\n  New-SmbShare -Name \"DbShare\" -Path \"C:\\DbShare\" -FullAccess \"Everyone\"\n\n  Import-Module SQLASCmdlets,Sqlps,SQLPS\n\n  foreach ($db in @(\"BLR_Site\",\"BLR_Monitor\",\"BLR_Logging\")){\n     Get-ChildItem -Path SQLSERVER:\\SQL\\$PrimaryNode\\DEFAULT\\Databases |\n     Where-Object Name -eq $db |\n     ForEach-Object {\n         $_.RecoveryModel = 'Full'\n         $_.Alter()\n         $_.Refresh()\n     }\n  }\n\n  Backup-SqlDatabase -Database \"BLR_Site\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Site.bak\" -ServerInstance \"$PrimaryNode\"\n  Backup-SqlDatabase -Database \"BLR_Monitor\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Monitor.bak\" -ServerInstance \"$PrimaryNode\"  \n  Backup-SqlDatabase -Database \"BLR_Logging\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Logging.bak\" -ServerInstance \"$PrimaryNode\"  \n\n  Backup-SqlDatabase -Database \"BLR_Site\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Site.log\" -ServerInstance \"$PrimaryNode\" -BackupAction Log \n  Backup-SqlDatabase -Database \"BLR_Monitor\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Monitor.log\" -ServerInstance \"$PrimaryNode\" -BackupAction Log \n  Backup-SqlDatabase -Database \"BLR_Logging\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Logging.log\" -ServerInstance \"$PrimaryNode\" -BackupAction Log \n\n  foreach($node in $nodes)\n  {\n     if ($node -ne $PrimaryNode){\n        Restore-SqlDatabase -Database \"BLR_Site\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Site.bak\" -ServerInstance \"$node\" -NoRecovery \n        Restore-SqlDatabase -Database \"BLR_Monitor\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Monitor.bak\" -ServerInstance \"$node\" -NoRecovery \n        Restore-SqlDatabase -Database \"BLR_Logging\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Logging.bak\" -ServerInstance \"$node\" -NoRecovery \n\n        Restore-SqlDatabase -Database \"BLR_Site\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Site.log\" -ServerInstance \"$node\" -RestoreAction Log -NoRecovery\n        Restore-SqlDatabase -Database \"BLR_Monitor\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Monitor.log\" -ServerInstance \"$node\" -RestoreAction Log -NoRecovery\n        Restore-SqlDatabase -Database \"BLR_Logging\" -BackupFile \"\\\\$PrimaryNode\\DbShare\\BLR_Logging.log\" -ServerInstance \"$node\" -RestoreAction Log -NoRecovery\n     }\n  }\n\n  Add-SqlAvailabilityDatabase -Path \"SQLSERVER:\\SQL\\$PrimaryNode\\DEFAULT\\AvailabilityGroups\\$AGName\" -Database @(\"BLR_Site\",\"BLR_Monitor\",\"BLR_Logging\")\n\n  $nodes | Where-Object {$_ -ne $PrimaryNode} | ForEach-Object {Add-SqlAvailabilityDatabase -Path \"SQLSERVER:\\SQL\\$_\\DEFAULT\\AvailabilityGroups\\$AGName\" -Database @(\"BLR_Site\",\"BLR_Monitor\",\"BLR_Logging\")}\n\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\nforeach($MSSQL_NODE in $MSSQL_NODES)\n{\nInvoke-Command -ComputerName $MSSQL_NODE -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n}"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "name": "Post MSSQL tasks"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "$MSSQL_NODES = \"@@{MSSQL.address}@@\".Split(',')\n\n$script = {\n  if (\"$(Get-ClusterNode | where {$_.Id -eq 1} | select -ExpandProperty Name)\" -eq \"$(hostname)\"){\n  exit\n  }\n  $netbios = \"@@{DOMAIN}@@\".Split(\".\")[0].ToUpper()\n  $hostname=\"@@{HOSTNAME}@@\"\n  $username=\"$($netbios)\\$($hostname)\"\n  $createNodeLogin = \"CREATE LOGIN [$username`$] FROM WINDOWS WITH DEFAULT_DATABASE=[master], DEFAULT_LANGUAGE=[us_english];\"\n\n  Invoke-SqlCmd -Server $(hostname) -Query $createNodeLogin\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nforeach($MSSQL_NODE in $MSSQL_NODES)\n{\nInvoke-Command -ComputerName $MSSQL_NODE -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n}"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "name": "CreateUsers"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "aaa51f8e_dag"}, "name": "29e91e9c_runbook"}}, {"critical": false, "type": "system", "description": "System action for deleting an application. Deletes created VMs as well", "name": "action_delete", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "3cea26c0_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "3cea26c0_dag"}, "name": "22428294_runbook"}}, {"critical": false, "type": "system", "description": "System action for starting an application", "name": "action_start", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "dc2f4c2e_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "dc2f4c2e_dag"}, "name": "c1427948_runbook"}}, {"critical": false, "type": "system", "description": "System action for stopping an application", "name": "action_stop", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "2d568762_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "2d568762_dag"}, "name": "b2d07af0_runbook"}}, {"critical": false, "type": "system", "description": "System action for restarting an application", "name": "action_restart", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "0038d36c_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "0038d36c_dag"}, "name": "73c06dcc_runbook"}}], "description": "", "port_list": [], "tier": "", "variable_list": [{"val_type": "STRING", "description": "", "value": "", "label": "", "attrs": {"type": ""}, "type": "LOCAL", "name": "EXECUTION_MODE"}, {"val_type": "STRING", "description": "", "value": "", "label": "", "attrs": {"type": ""}, "type": "LOCAL", "name": "FQDN"}, {"val_type": "STRING", "description": "", "value": "", "label": "", "attrs": {"type": ""}, "type": "LOCAL", "name": "HOSTNAME"}], "depends_on_list": []}, {"singleton": false, "name": "StoreFront", "action_list": [{"critical": false, "type": "system", "description": "System action for creating an application", "name": "action_create", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "StoreFront"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [{"kind": "app_task", "name": "CreateStore"}, {"kind": "app_task", "name": "EnableLocalMode"}, {"kind": "app_task", "name": "JoinRemainingNodes"}], "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "CreateStore"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "EnableLocalMode"}}, {"from_task_reference": {"kind": "app_task", "name": "EnableLocalMode"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "JoinRemainingNodes"}}], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "52ea23b6_dag"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$FQDN = \"$env:computername.$env:userdnsdomain\"\n$HostbaseUrl = \"http://\" + $FQDN\n$StoreFriendlyName = \"$env:USERDOMAIN\"\n$StoreFriendlyNameWithoutSpaces = $StoreFriendlyName -replace '\\s',''\n$SiteId = 1\n$Farmtype = \"XenDesktop\"\n$FarmServers = \"@@{DDC.FQDN}@@\".Split(',')\n$StoreVirtualPath = \"/Citrix/\" + $StoreFriendlyNameWithoutSpaces\n$LoadbalanceServers = $false\n$Port = 80\n$SSLRelayPort = 443\n$TransportType = \"HTTP\"\n\n$GatewayUrl = \"\"\n$GatewayCallbackUrl = \"\"\n$GatewaySTAUrls = \"\"\n$GatewaySubnetIP = \"\"\n$GatewayName = \"\"\n\nSet-StrictMode -Version 2.0\n\n# Any failure is a terminating failure.\n$ErrorActionPreference = 'Stop'\n$ReportErrorShowStackTrace = $true\n$ReportErrorShowInnerException = $true\n\n# Import StoreFront modules. Required for versions of PowerShell earlier than 3.0 that do not support autoloading\nImport-Module Citrix.StoreFront\nImport-Module Citrix.StoreFront.Stores\nImport-Module Citrix.StoreFront.Authentication\nImport-Module Citrix.StoreFront.WebReceiver\nImport-Module Citrix.StoreFront.Roaming\n\n# Determine the Authentication and Receiver virtual path to use based of the Store\n$authenticationVirtualPath = \"$($StoreVirtualPath.TrimEnd('/'))Auth\"\n$receiverVirtualPath = \"$($StoreVirtualPath.TrimEnd('/'))Web\"\n\n# Determine if the deployment already exists\n$existingDeployment = Get-STFDeployment\n\nif(-not $existingDeployment)\n{\n    # Install the required StoreFront components\n    Add-STFDeployment -HostBaseUrl $HostbaseUrl -SiteId $SiteId -Confirm:$false\n}\nelseif($existingDeployment.HostbaseUrl -eq $HostbaseUrl)\n{\n    # The deployment exists but it is configured to the desired hostbase url\n    Write-Output \"A deployment has already been created with the specified hostbase url on this server and will be used.\"\n}\nelse\n{\n    Write-Error \"A deployment has already been created on this server with a different host base url.\"\n}\n\n# Determine if the authentication service at the specified virtual path exists\n$authentication = Get-STFAuthenticationService -VirtualPath $authenticationVirtualPath\n\nif(-not $authentication)\n{\n    # Add an Authentication service using the IIS path of the Store appended with Auth\n    $authentication = Add-STFAuthenticationService $authenticationVirtualPath\n}\nelse\n{\n    Write-Output \"An Authentication service already exists at the specified virtual path and will be used.\"\n}\n\n# Determine if the store service at the specified virtual path exists\n$store = Get-STFStoreService -VirtualPath $StoreVirtualPath\n\nif(-not $store)\n{\n    # Add a Store that uses the new Authentication service configured to publish resources from the supplied servers\n    $store = Add-STFStoreService -VirtualPath $StoreVirtualPath -AuthenticationService $authentication -FarmName $Farmtype -FarmType $Farmtype -Servers $FarmServers -LoadBalance $LoadbalanceServers `\n        -Port $Port -SSLRelayPort $SSLRelayPort -TransportType $TransportType\n}\nelse\n{\n    Write-Output \"A Store service already exists at the specified virtual path and will be used. Farm and servers will be appended to this store.\"\n    # Get the number of farms configured in the store\n    $farmCount = (Get-STFStoreFarmConfiguration $store).Farms.Count\n\n    # Append the farm to the store with a unique name\n    Add-STFStoreFarm -StoreService $store -FarmName \"Controller$($farmCount + 1)\" -FarmType $Farmtype -Servers $FarmServers -LoadBalance $LoadbalanceServers -Port $Port `\n        -SSLRelayPort $SSLRelayPort -TransportType $TransportType\n}\n\n# Determine if the receiver service at the specified virtual path exists\n$receiver = Get-STFWebReceiverService -VirtualPath $receiverVirtualPath\n\nif(-not $receiver)\n{\n    # Add a Receiver for Web site so users can access the applications and desktops in the published in the Store\n    $receiver = Add-STFWebReceiverService -VirtualPath $receiverVirtualPath -StoreService $store\n}\nelse\n{\n    Write-Output \"A Web Receiver service already exists at the specified virtual path and will be used.\"\n}\n\n# Determine if PNA is configured for the Store service\n$storePnaSettings = Get-STFStorePna -StoreService $store\n\nif(-not $storePnaSettings.PnaEnabled)\n{\n    # Enable XenApp services on the Store and make it the default for this server\n    Enable-STFStorePna -StoreService $store -AllowUserPasswordChange -DefaultPnaService\n}\n\n# Determine the Authentication and Receiver sites based on the Store\n$store = Get-STFStoreService -VirtualPath $StoreVirtualPath\n$authentication = Get-STFAuthenticationService -StoreService $store\n$receiverForWeb = Get-STFWebReceiverService -StoreService $store\n\n# Get the Web Receiver CitrixAGBasic and ExplicitForms authentication method from the supported protocols\n# Included for demonstration purposes as the protocol name can be used directly if known\n$receiverMethods = Get-STFWebReceiverAuthenticationMethodsAvailable | Where-Object { $_ -match \"Explicit\" -or $_ -match \"CitrixAG\" }\n\n# Enable CitrixAGBasic in Receiver for Web (required for remote access)\nSet-STFWebReceiverAuthenticationMethods -WebReceiverService $receiverForWeb -AuthenticationMethods $receiverMethods\n\n# Get the CitrixAGBasic authentication method from the protocols installed.\n# Included for demonstration purposes as the protocol name can be used directly if known\n$citrixAGBasic = Get-STFAuthenticationProtocolsAvailable | Where-Object { $_ -match \"CitrixAGBasic\" }\n\n# Enable CitrixAGBasic in the Authentication service (required for remote access)\nEnable-STFAuthenticationServiceProtocol -AuthenticationService $authentication -Name $citrixAGBasic\n<#\n# Add a new Gateway used to access the new Store remotely\nAdd-STFRoamingGateway -Name $GatewayName -LogonType Domain -Version Version10_0_69_4 -GatewayUrl $GatewayUrl `\n-CallbackUrl $GatewayCallbackUrl -SecureTicketAuthorityUrls $GatewaySTAUrls\n\n# Get the new Gateway from the configuration (Add-STFRoamingGateway will return the new Gateway if -PassThru is supplied as a parameter)\n$gateway = Get-STFRoamingGateway -Name $GatewayName\n\n# If the gateway subnet was provided then set it on the gateway object\nif($GatewaySubnetIP)\n{\n    Set-STFRoamingGateway -Gateway $gateway -SubnetIPAddress $GatewaySubnetIP\n}\n\n# Register the Gateway with the new Store\nRegister-STFStoreGateway -Gateway $gateway -StoreService $store -DefaultGateway\n\nWrite-Host \"Remote Access Deployment complete\"\n#>", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "DOMAIN_CRED"}}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "name": "CreateStore"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=LOCAL\"\n", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "type": "SET_VARIABLE", "variable_list": [], "name": "EnableLocalMode"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -Authentication Credssp -ScriptBlock {\n    if((Test-Path C:\\_CONFIG) -eq 0 ) {\n\t\tmkdir C:\\_CONFIG\n    }\n    $RemotePasscodeScript=\"C:\\_CONFIG\\SFPasscodeScript.ps1\"\n    if((Test-Path $RemotePasscodeScript) -ne 0) {\n\t\tRemove-Item $RemotePasscodeScript\n\t}\n    Add-Content $RemotePasscodeScript \"Import-Module Citrix.StoreFront\"\n    Add-Content $RemotePasscodeScript \"`$status = Start-STFServerGroupJoin -IsAuthorizingServer -Confirm:`$false\"\n    Add-Content $RemotePasscodeScript \"`$Passcode = `$status.Passcode\"\n    Add-Content $RemotePasscodeScript \"`$Passcode.ToString() > C:\\_CONFIG\\Passcode.txt\"\n    Add-Content $RemotePasscodeScript \"Wait-STFServerGroupJoin -Confirm:`$false\"\n    Add-Content $RemotePasscodeScript \"Stop-STFServerGroupJoin\"\n    Add-Content $RemotePasscodeScript \"Publish-STFServerGroupConfiguration -Confirm:`$false\"\n}\n\n$LocalPasscodeScript=\"C:\\_CONFIG\\SFPasscodeScript.ps1\"\nschtasks /Create /F /TN SFPasscodeScript /S @@{address}@@ /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /RU \"SYSTEM\" /TR \"powershell.exe -File $LocalPasscodeScript\" /SC once /ST 23:30\nschtasks /Run /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /TN SFPasscodeScript /S @@{address}@@\nStart-Sleep -seconds 30\n\n$passcode = Invoke-Command -ComputerName @@{address}@@ -Credential $Creds -Authentication Credssp -ScriptBlock {\n\tGet-Content -Path \"C:\\_CONFIG\\Passcode.txt\"\n}\n\nif ($passcode -eq \"\"){\n\tWrite-Output \"Passcode is empty\"\n    exit 1\n}\n\n$fqdn = Invoke-Command -ComputerName @@{address}@@ -Credential $Creds -Authentication Credssp -ScriptBlock {\n\tWrite-Output \"$env:computername.$env:userdnsdomain\"\n}\n\nInvoke-Command -ComputerName @@{calm_array_address[1]}@@ -Credential $Creds -Authentication Credssp -ScriptBlock {\n\tparam($Server,$Passcode)\n    if((Test-Path C:\\_CONFIG) -eq 0 ) {\n\t\tmkdir C:\\_CONFIG\n    }\n    $RemoteSTFServerGroupJoinRem=\"C:\\_CONFIG\\STFServerGroupJoinRem.ps1\"\n    if((Test-Path $RemoteSTFServerGroupJoinRem) -ne 0) {\n\t\tRemove-Item $RemoteSTFServerGroupJoinRem\n\t}\n    Add-Content $RemoteSTFServerGroupJoinRem \"Import-Module Citrix.StoreFront\"\n    Add-Content $RemoteSTFServerGroupJoinRem \"Start-STFServerGroupJoin -AuthorizerHostName $Server -Passcode $Passcode -Confirm:`$false\"\n    Add-Content $RemoteSTFServerGroupJoinRem \"Wait-STFServerGroupJoin\"\n    Add-Content $RemoteSTFServerGroupJoinRem \"Stop-STFServerGroupJoin\"\n    Add-Content $RemoteSTFServerGroupJoinRem \"Wait-STFPublishServerGroupConfiguration\"\n} -ArgumentList $fqdn,$passcode\n\n$LocalSTFServerGroupJoinRem=\"C:\\_CONFIG\\STFServerGroupJoinRem.ps1\"\nschtasks /Create /F /TN STFServerGroupJoinRem /S @@{calm_array_address[1]}@@ /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /RU \"SYSTEM\" /TR \"powershell.exe -File $LocalSTFServerGroupJoinRem\" /SC once /ST 23:30\nschtasks /Run /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /TN STFServerGroupJoinRem /S @@{calm_array_address[1]}@@\n\nschtasks /Delete /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /TN SFPasscodeScript /S @@{address}@@ /F\nschtasks /Delete /U \"@@{DOMAIN_CRED.username}@@\" /P \"@@{DOMAIN_CRED.secret}@@\" /TN STFServerGroupJoinRem /S @@{calm_array_address[1]}@@ /F"}, "timeout_secs": "0", "type": "EXEC", "variable_list": [], "name": "JoinRemainingNodes"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "52ea23b6_dag"}, "name": "21430fdc_runbook"}}, {"critical": false, "type": "system", "description": "System action for deleting an application. Deletes created VMs as well", "name": "action_delete", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "StoreFront"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "6fd63783_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "6fd63783_dag"}, "name": "6c029928_runbook"}}, {"critical": false, "type": "system", "description": "System action for starting an application", "name": "action_start", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "StoreFront"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "a8287d2f_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "a8287d2f_dag"}, "name": "fee4dd3c_runbook"}}, {"critical": false, "type": "system", "description": "System action for stopping an application", "name": "action_stop", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "StoreFront"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "a14c3309_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "a14c3309_dag"}, "name": "b2eeaf76_runbook"}}, {"critical": false, "type": "system", "description": "System action for restarting an application", "name": "action_restart", "runbook": {"variable_list": [], "task_definition_list": [{"target_any_local_reference": {"kind": "app_service", "name": "StoreFront"}, "retries": "0", "description": "", "child_tasks_local_reference_list": [], "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "type": "DAG", "variable_list": [], "name": "b10ebd95_dag"}], "description": "", "main_task_local_reference": {"kind": "app_task", "name": "b10ebd95_dag"}, "name": "e915c064_runbook"}}], "description": "", "port_list": [], "tier": "", "variable_list": [{"val_type": "STRING", "description": "", "value": "", "label": "", "attrs": {"type": ""}, "type": "LOCAL", "name": "EXECUTION_MODE"}], "depends_on_list": []}], "substrate_definition_list": [{"description": "", "action_list": [], "readiness_probe": {"connection_type": "POWERSHELL", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@", "disable_readiness_probe": false, "timeout_secs": "300", "connection_port": 5985}, "editables": {"create_spec": {"resources": {"nic_list": {}, "disk_list": {}}}}, "os_type": "Windows", "type": "AHV_VM", "create_spec": {"name": "MSSQL-@@{calm_application_name}@@-@@{calm_array_index}@@", "categories": "", "availability_zone_reference": null, "backup_policy": null, "type": "", "cluster_reference": null, "resources": {"nic_list": [{"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}, {"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}], "serial_port_list": [], "guest_tools": null, "num_vcpus_per_socket": 1, "num_sockets": 4, "gpu_list": [], "memory_size_mib": 4096, "parent_reference": null, "hardware_clock_timezone": "", "guest_customization": {"cloud_init": null, "type": "", "sysprep": {"install_type": "PREPARED", "unattend_xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false</fDenyTSConnections>\n      </component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0</UserAuthentication>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true</Active>\n               <Profile>all</Profile>\n               <Group>@FirewallAPI.dll,-28752</Group>\n            </FirewallGroup>\n         </FirewallGroups>\n      </component>\n   </settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </AdministratorPassword>\n         </UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </Password>\n            <Enabled>true</Enabled>\n            <Username>Administrator</Username>\n         </AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe /c netsh firewall add portopening TCP 5985 \"Port 5985\"</CommandLine>\n               <Description>Win RM port open</Description>\n               <Order>1</Order>\n               <RequiresUserInput>true</RequiresUserInput>\n            </SynchronousCommand>\n         </FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true</HideEULAPage>\n            <SkipMachineOOBE>true</SkipMachineOOBE>\n         </OOBE>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US</InputLocale>\n         <SystemLocale>en-US</SystemLocale>\n         <UILanguageFallback>en-us</UILanguageFallback>\n         <UILanguage>en-US</UILanguage>\n         <UserLocale>en-US</UserLocale>\n      </component>\n   </settings>\n</unattend>", "type": ""}}, "power_state": "ON", "type": "", "boot_config": {"boot_device": {"type": "", "disk_address": {"adapter_type": "SCSI", "device_index": 0, "type": ""}}, "type": "", "mac_address": ""}, "disk_list": [{"data_source_reference": {"kind": "image", "type": "", "name": "WindowsServer2016-Base", "uuid": "7833ea8b-3bed-4955-9c3c-919b52581ea5"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "device_type": "DISK", "disk_address": {"adapter_type": "SCSI", "device_index": 0, "type": ""}}}, {"data_source_reference": {"kind": "image", "type": "", "name": "SQLServer2014SP2-FullSlipstream-x64-ENU", "uuid": "0be4cd78-184b-4319-96fa-d949c686ccde"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "device_type": "CDROM", "disk_address": {"adapter_type": "IDE", "device_index": 0, "type": ""}}}, {"data_source_reference": null, "type": "", "disk_size_mib": 51200, "device_properties": {"type": "", "device_type": "DISK", "disk_address": {"adapter_type": "SCSI", "device_index": 1, "type": ""}}}, {"data_source_reference": null, "type": "", "disk_size_mib": 153600, "device_properties": {"type": "", "device_type": "DISK", "disk_address": {"adapter_type": "SCSI", "device_index": 2, "type": ""}}}, {"data_source_reference": null, "type": "", "disk_size_mib": 307200, "device_properties": {"type": "", "device_type": "DISK", "disk_address": {"adapter_type": "SCSI", "device_index": 3, "type": ""}}}, {"data_source_reference": null, "type": "", "disk_size_mib": 307200, "device_properties": {"type": "", "device_type": "DISK", "disk_address": {"adapter_type": "SCSI", "device_index": 4, "type": ""}}}, {"data_source_reference": null, "type": "", "disk_size_mib": 102400, "device_properties": {"type": "", "device_type": "DISK", "disk_address": {"adapter_type": "SCSI", "device_index": 5, "type": ""}}}, {"data_source_reference": null, "type": "", "disk_size_mib": 102400, "device_properties": {"type": "", "device_type": "DISK", "disk_address": {"adapter_type": "SCSI", "device_index": 6, "type": ""}}}, {"data_source_reference": null, "type": "", "disk_size_mib": 204800, "device_properties": {"type": "", "device_type": "DISK", "disk_address": {"adapter_type": "SCSI", "device_index": 7, "type": ""}}}, {"data_source_reference": null, "type": "", "disk_size_mib": 204800, "device_properties": {"type": "", "device_type": "DISK", "disk_address": {"adapter_type": "SCSI", "device_index": 8, "type": ""}}}]}}, "variable_list": [], "name": "AHV_MSSQL"}, {"description": "", "action_list": [], "readiness_probe": {"connection_type": "POWERSHELL", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@", "disable_readiness_probe": false, "timeout_secs": "300", "connection_port": 5985}, "editables": {"create_spec": {"resources": {"nic_list": {}, "disk_list": {}}}}, "os_type": "Windows", "type": "AHV_VM", "create_spec": {"name": "DDC-@@{calm_application_name}@@-@@{calm_array_index}@@", "categories": "", "availability_zone_reference": null, "backup_policy": null, "type": "", "cluster_reference": null, "resources": {"nic_list": [{"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}], "serial_port_list": [], "guest_tools": null, "num_vcpus_per_socket": 1, "num_sockets": 4, "gpu_list": [], "memory_size_mib": 4096, "parent_reference": null, "hardware_clock_timezone": "", "guest_customization": {"cloud_init": null, "type": "", "sysprep": {"install_type": "PREPARED", "unattend_xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false</fDenyTSConnections>\n      </component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0</UserAuthentication>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true</Active>\n               <Profile>all</Profile>\n               <Group>@FirewallAPI.dll,-28752</Group>\n            </FirewallGroup>\n         </FirewallGroups>\n      </component>\n   </settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </AdministratorPassword>\n         </UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </Password>\n            <Enabled>true</Enabled>\n            <Username>Administrator</Username>\n         </AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe /c netsh firewall add portopening TCP 5985 \"Port 5985\"</CommandLine>\n               <Description>Win RM port open</Description>\n               <Order>1</Order>\n               <RequiresUserInput>true</RequiresUserInput>\n            </SynchronousCommand>\n         </FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true</HideEULAPage>\n            <SkipMachineOOBE>true</SkipMachineOOBE>\n         </OOBE>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US</InputLocale>\n         <SystemLocale>en-US</SystemLocale>\n         <UILanguageFallback>en-us</UILanguageFallback>\n         <UILanguage>en-US</UILanguage>\n         <UserLocale>en-US</UserLocale>\n      </component>\n   </settings>\n</unattend>", "type": ""}}, "power_state": "ON", "type": "", "boot_config": {"boot_device": {"type": "", "disk_address": {"adapter_type": "SCSI", "device_index": 0, "type": ""}}, "type": "", "mac_address": ""}, "disk_list": [{"data_source_reference": {"kind": "image", "type": "", "name": "WindowsServer2016-Base", "uuid": "7833ea8b-3bed-4955-9c3c-919b52581ea5"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "device_type": "DISK", "disk_address": {"adapter_type": "SCSI", "device_index": 0, "type": ""}}}, {"data_source_reference": {"kind": "image", "type": "", "name": "XenApp_and_XenDesktop_7_16", "uuid": "65cfdbf1-d372-4e90-8aff-9563047e4cd8"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "device_type": "CDROM", "disk_address": {"adapter_type": "IDE", "device_index": 0, "type": ""}}}]}}, "variable_list": [], "name": "AHV_DDC"}, {"description": "", "action_list": [], "readiness_probe": {"connection_type": "POWERSHELL", "address": "@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@", "disable_readiness_probe": false, "timeout_secs": "300", "connection_port": 5985}, "editables": {"create_spec": {"resources": {"nic_list": {}, "disk_list": {}}}}, "os_type": "Windows", "type": "AHV_VM", "create_spec": {"name": "StoreFront-@@{calm_application_name}@@-@@{calm_array_index}@@", "categories": "", "availability_zone_reference": null, "backup_policy": null, "type": "", "cluster_reference": null, "resources": {"nic_list": [{"nic_type": "NORMAL_NIC", "ip_endpoint_list": [], "network_function_chain_reference": null, "network_function_nic_type": "INGRESS", "mac_address": "", "subnet_reference": {"kind": "subnet", "type": "", "name": "", "uuid": "cbc0c43a-5b92-49b2-9851-5a10041b6d1b"}, "type": ""}], "serial_port_list": [], "guest_tools": null, "num_vcpus_per_socket": 1, "num_sockets": 4, "gpu_list": [], "memory_size_mib": 4096, "parent_reference": null, "hardware_clock_timezone": "", "guest_customization": {"cloud_init": null, "type": "", "sysprep": {"install_type": "PREPARED", "unattend_xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false</fDenyTSConnections>\n      </component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0</UserAuthentication>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true</Active>\n               <Profile>all</Profile>\n               <Group>@FirewallAPI.dll,-28752</Group>\n            </FirewallGroup>\n         </FirewallGroups>\n      </component>\n   </settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </AdministratorPassword>\n         </UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>nutanix/4u</Value>\n               <PlainText>true</PlainText>\n            </Password>\n            <Enabled>true</Enabled>\n            <Username>Administrator</Username>\n         </AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe /c netsh firewall add portopening TCP 5985 \"Port 5985\"</CommandLine>\n               <Description>Win RM port open</Description>\n               <Order>1</Order>\n               <RequiresUserInput>true</RequiresUserInput>\n            </SynchronousCommand>\n         </FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true</HideEULAPage>\n            <SkipMachineOOBE>true</SkipMachineOOBE>\n         </OOBE>\n      </component>\n      <component xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US</InputLocale>\n         <SystemLocale>en-US</SystemLocale>\n         <UILanguageFallback>en-us</UILanguageFallback>\n         <UILanguage>en-US</UILanguage>\n         <UserLocale>en-US</UserLocale>\n      </component>\n   </settings>\n</unattend>", "type": ""}}, "power_state": "ON", "type": "", "boot_config": {"boot_device": {"type": "", "disk_address": {"adapter_type": "SCSI", "device_index": 0, "type": ""}}, "type": "", "mac_address": ""}, "disk_list": [{"data_source_reference": {"kind": "image", "type": "", "name": "WindowsServer2016-Base", "uuid": "7833ea8b-3bed-4955-9c3c-919b52581ea5"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "device_type": "DISK", "disk_address": {"adapter_type": "SCSI", "device_index": 0, "type": ""}}}, {"data_source_reference": {"kind": "image", "type": "", "name": "XenApp_and_XenDesktop_7_16", "uuid": "65cfdbf1-d372-4e90-8aff-9563047e4cd8"}, "type": "", "disk_size_mib": 0, "device_properties": {"type": "", "device_type": "CDROM", "disk_address": {"adapter_type": "IDE", "device_index": 0, "type": ""}}}]}}, "variable_list": [], "name": "AHV_StoreFront"}], "credential_definition_list": [{"username": "administrator", "secret": {"attrs": {"is_secret_modified": false, "secret_reference": {}}}, "type": "PASSWORD", "description": "", "name": "LOCAL"}, {"username": "administrator@nucalm.com", "secret": {"attrs": {"is_secret_modified": false, "secret_reference": {}}}, "type": "PASSWORD", "description": "", "name": "DOMAIN_CRED"}, {"username": "admin", "secret": {"attrs": {"is_secret_modified": false, "secret_reference": {}}}, "type": "PASSWORD", "description": "", "name": "PE_CREDS"}, {"username": "nucalm\\administrator", "secret": {"attrs": {"is_secret_modified": false, "secret_reference": {}}}, "type": "PASSWORD", "description": "", "name": "SQL_CREDS"}, {"username": "administrator", "secret": {"attrs": {"is_secret_modified": false, "secret_reference": {}}}, "type": "PASSWORD", "description": "", "name": "KARAN_CRED"}], "package_definition_list": [{"description": "", "action_list": [], "service_local_reference_list": [{"kind": "app_service", "name": "MSSQL"}], "version": "", "type": "DEB", "options": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package"}, "retries": "0", "description": "", "type": "DAG", "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask"}, {"kind": "app_task", "name": "AddToDomain"}, {"kind": "app_task", "name": "Sleep"}, {"kind": "app_task", "name": "Create VG"}, {"kind": "app_task", "name": "Attach VG"}, {"kind": "app_task", "name": "Connect Mount VG"}, {"kind": "app_task", "name": "Install FC"}, {"kind": "app_task", "name": "EnableLocalMode"}, {"kind": "app_task", "name": "Configure WSFC"}, {"kind": "app_task", "name": "Install SQL"}, {"kind": "app_task", "name": "Apply OS BPG"}, {"kind": "app_task", "name": "Apply SQL BPG"}, {"kind": "app_task", "name": "Enable AAG"}, {"kind": "app_task", "name": "Create AAG"}, {"kind": "app_task", "name": "DisableLocalMode"}], "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "AddToDomain"}}, {"from_task_reference": {"kind": "app_task", "name": "AddToDomain"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Sleep"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Create VG"}}, {"from_task_reference": {"kind": "app_task", "name": "Create VG"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Attach VG"}}, {"from_task_reference": {"kind": "app_task", "name": "Attach VG"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Connect Mount VG"}}, {"from_task_reference": {"kind": "app_task", "name": "Connect Mount VG"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Install FC"}}, {"from_task_reference": {"kind": "app_task", "name": "Install FC"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "EnableLocalMode"}}, {"from_task_reference": {"kind": "app_task", "name": "EnableLocalMode"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Configure WSFC"}}, {"from_task_reference": {"kind": "app_task", "name": "Configure WSFC"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Install SQL"}}, {"from_task_reference": {"kind": "app_task", "name": "Install SQL"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Apply OS BPG"}}, {"from_task_reference": {"kind": "app_task", "name": "Apply OS BPG"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Apply SQL BPG"}}, {"from_task_reference": {"kind": "app_task", "name": "Apply SQL BPG"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Enable AAG"}}, {"from_task_reference": {"kind": "app_task", "name": "Enable AAG"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Create AAG"}}, {"from_task_reference": {"kind": "app_task", "name": "Create AAG"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "DisableLocalMode"}}], "type": ""}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "ddaf74d2_dag"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\n# -*- Enabling and starting 'msiscsi'\nSet-Service -Name msiscsi -StartupType Automatic\nStart-Service msiscsi\n# -*- Change first Ehternet adapter name to 'Production'\nGet-NetAdapter -Name \"Ethernet\" | Rename-NetAdapter -NewName \"Production\" -ErrorAction SilentlyContinue\n# -*- Download SQL Updates\n$TempDirectory = \"C:\\Temp\"\nNew-Item -ItemType Directory -Force -Path $TempDirectory\n(New-Object System.Net.WebClient).DownloadFile(\"http://10.7.1.7/data1/ISOs/SQLServer2014-KB4052725-x64.exe\",\"$TempDirectory\\SQLServer2014-KB4052725-x64.exe\")\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "PackageInstallTask"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"MSSQL-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "AddToDomain"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "static", "type": "", "command_line_args": "", "exit_status": [], "script": "#script\nsleep(30)"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Sleep"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$PrismIP = \"@@{PE_IP}@@\"\n$PrismUser = \"@@{PE_CREDS.username}@@\"\n$PrismPass = \"@@{PE_CREDS.secret}@@\"\n\nadd-type @\"\n    using System.Net;\n    using System.Security.Cryptography.X509Certificates;\n    public class TrustAllCertsPolicy : ICertificatePolicy {\n        public bool CheckValidationResult(\n            ServicePoint srvPoint, X509Certificate certificate,\n            WebRequest request, int certificateProblem) {\n            return true;\n        }\n    }\n\"@\n[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy\n\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n\n$BaseURL = \"https://\" + $PrismIP + \":9440/PrismGateway/services/rest/v2.0/\"\n$Header = @{\"Authorization\" = \"Basic \"+[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($PrismUser+\":\"+$PrismPass))}\n$Type = \"application/json\"\n\n$VolumeGroupURL = $BaseURL+\"volume_groups\"\n$ContainerURL = $BaseURL+\"storage_containers\"\n\ntry {\n  $ContainerList = invoke-RestMethod -Uri $ContainerURL -Method Get -TimeoutSec 100 -Headers $Header -ContentType $Type\n  $ContainerUUID = $ContainerList.entities | where { $_.name -eq \"@@{Nutanix_Container_Name}@@\"} | select storage_container_uuid\n  $ContainerUUID = $ContainerUUID.storage_container_uuid\n\n$Body = @\"\n{\n  \"disk_list\": [\n    {\n      \"create_config\": {\n        \"size\": 1073741824,\n\t\"storage_container_uuid\": \"$ContainerUUID\"\n      },\n      \"index\": 0\n    }\n  ],\n  \"is_shared\": true,\n  \"name\": \"@@{Volume_GroupName}@@\"\n}\n\"@\n\n\t$status=Invoke-RestMethod -Uri $VolumeGroupURL -Method Post -TimeoutSec 100 -Headers $Header -ContentType $Type -Body $Body\n}\ncatch {\n    Write-output \"$_\"\n}\n\nif ($status.task_uuid -eq $null) {\n    Write-Output \"Error while creating volume group\"\n    exit 1\n}"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Create VG"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "\n$MsSQL1_iSCSI_IQN = (Get-InitiatorPort).NodeAddress\n\n$PrismIP = \"@@{PE_IP}@@\"\n$PrismUser = \"@@{PE_CREDS.username}@@\"\n$PrismPass = \"@@{PE_CREDS.secret}@@\"\n\nadd-type @\"\n    using System.Net;\n    using System.Security.Cryptography.X509Certificates;\n    public class TrustAllCertsPolicy : ICertificatePolicy {\n        public bool CheckValidationResult(\n            ServicePoint srvPoint, X509Certificate certificate,\n            WebRequest request, int certificateProblem) {\n            return true;\n        }\n    }\n\"@\n[System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy\n\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n\n$BaseURL = \"https://\" + $PrismIP + \":9440/PrismGateway/services/rest/v2.0/\"\n$Header = @{\"Authorization\" = \"Basic \"+[System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($PrismUser+\":\"+$PrismPass))}\n$Type = \"application/json\"\n\n$VolumeGroupURL = $BaseURL+\"volume_groups\"\ntry {\n\t$VolumeGroupList = invoke-RestMethod -Uri $VolumeGroupURL -Method Get -TimeoutSec 100 -Headers $Header -ContentType $Type\n\t$VolumeGroupUUID = $VolumeGroupList.entities | where { $_.name -eq \"@@{Volume_GroupName}@@\"} | select uuid\n\t$VolumeGroupUUID = $VolumeGroupUUID.uuid\n\n\t$VolumeGroupAttachURL = $VolumeGroupURL+\"/$VolumeGroupUUID\"+\"/open\"\n\n$Body = @\"\n{\n  \"iscsi_client\": {\n    \"client_address\": \"$MsSQL1_iSCSI_IQN\"\n  },\n  \"operation\": \"ATTACH\"\n}\n\"@\n\n\t$status=Invoke-RestMethod -Uri $VolumeGroupAttachURL -Method Post -TimeoutSec 100 -Headers $Header -ContentType $Type -Body $Body\n}\ncatch {\n    Write-output \"$_\"\n}\n\nif ($status.value -ne $true) {\n    Write-Output \"Error while attaching volume group \"\n    exit 1\n}\nsleep 3"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Attach VG"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "New-IscsiTargetPortal -TargetPortalAddress @@{PE_DATA_SERVICE_IP}@@\nGet-IscsiTarget | Connect-IscsiTarget -IsPersistent $true\n\n#Initialize Disks\nif (((Get-Disk -Number 1 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\") -and ((Get-Disk -Number 2 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\")) {\n\tGet-Disk -Number 1 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 2 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 3 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 4 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 5 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 6 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 7 | Initialize-Disk -ErrorAction SilentlyContinue\n\tGet-Disk -Number 8 | Initialize-Disk -ErrorAction SilentlyContinue\n\tNew-Partition -DiskNumber 1 -UseMaximumSize -DriveLetter F -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -FileSystem NTFS -NewFileSystemLabel \"SQLINSTALL\" \n\tNew-Partition -DiskNumber 2 -UseMaximumSize -DriveLetter R -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"SQLBCK\"\n\tNew-Partition -DiskNumber 3 -UseMaximumSize -DriveLetter G -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"DATA01\" \n\tNew-Partition -DiskNumber 4 -UseMaximumSize -DriveLetter H -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"DATA02\"\n    New-Partition -DiskNumber 5 -UseMaximumSize -DriveLetter I -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDB01\" \n\tNew-Partition -DiskNumber 6 -UseMaximumSize -DriveLetter J -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDB02\"\n    New-Partition -DiskNumber 7 -UseMaximumSize -DriveLetter T -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"TEMPDBLOG01\" \n\tNew-Partition -DiskNumber 8 -UseMaximumSize -DriveLetter L -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -AllocationUnitSize 65536 -FileSystem NTFS -NewFileSystemLabel \"ULOG01\"\n\n} else {\n\tWrite-Output \"Disks does not exists or not healthy.`nIf you havent added disks please add 8 disk.\"\n\texit 1\n}\n\nif (\"@@{calm_array_index}@@\" -eq \"0\"){\n  if ((Get-Disk -Number 9 -ErrorAction SilentlyContinue).HealthStatus -eq \"Healthy\"){\n      Get-Disk -Number 9 | Initialize-Disk -ErrorAction SilentlyContinue\n      New-Partition -DiskNumber 9 -UseMaximumSize -DriveLetter W -ErrorAction SilentlyContinue | Format-Volume -Confirm:$false -FileSystem NTFS -NewFileSystemLabel \"Witness\" \n  } else {\n      Write-Output \"Witness Disk does not exists or not healthy.`nIf you havent added disks please add a volume group and attach.`n `t - Witness : 1GB\"\n      exit 1\n  }\n}"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Connect Mount VG"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "Install-WindowsFeature -Name Failover-Clustering -IncludeManagementTools\n\nif (-not (get-WindowsFeature -Name Failover-Clustering -ErrorAction SilentlyContinue | select -ExpandProperty Installed)){\n\tWrite-output \"Failover Clustering is not installed\"\n\texit 1\n}"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Install FC"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "SET_VARIABLE", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=LOCAL\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "EnableLocalMode"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"exit_status": [], "script": "if (\"@@{calm_array_index}@@\" -ne \"0\"){\n\texit\n}\n$adminname=\"@@{DOMAIN_CRED.username}@@\"\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n\n$testScript = {\n\t$Nodes=\"@@{calm_array_address}@@\".split(',')\n    if(Test-Cluster -Node $Nodes){\n        Return $True\n    }\n    else\n    {\n        Return $False\n    }\n} \n\n$TestStatus = Invoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $testScript\n\nif ($TestStatus -eq $false){\nWrite-Output \"Failed\"\nExit 1\n}\n\nforeach ( $node in $(\"@@{calm_array_address}@@\".split(',')) ){Test-WSMan $node}\n\n$ClusterCreate = {\n    #Import-Module FailoverClusters\n    $Nodes=\"@@{calm_array_address}@@\".split(',')\n    New-Cluster -Name @@{FAILOVER_CLUSTER_NAME}@@ -Node $Nodes -StaticAddress @@{FAILOVER_VIP}@@\n} \n\n$ClusterStatus = Invoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $ClusterCreate\n\nif (!$ClusterStatus.Name){\n    Write-Output \"Failed creating CLuster\"\n}\n\n$RenameClusterDisks = {\n    #Rename Cluster Disks\n    $ClusterDisks =  Get-CimInstance -ClassName MSCluster_Resource -Namespace root/mscluster -Filter \"type = 'Physical Disk'\"\n    foreach ($Disk in $ClusterDisks) {\n    $DiskResource = Get-CimAssociatedInstance -InputObject $Disk -ResultClass MSCluster_DiskPartition\n        if (-not ($DiskResource.VolumeLabel -eq $Disk.Name)) {\n        Invoke-CimMethod -InputObject $Disk -MethodName Rename -Arguments @{newName = $DiskResource.VolumeLabel}\n        }\n    }\n} \n\nInvoke-Command -ComputerName @@{address}@@ -Credential $credential -Authentication Credssp $RenameClusterDisks", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED"}}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Configure WSFC"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n    Install-WindowsFeature -IncludeAllSubFeature -ErrorAction Stop \"Net-Framework-Core\"\n    $DOMAINNAME=(Get-WmiObject Win32_ComputerSystem).Domain\n    $setupDriveLetter = \"D:\"\n    $setupPath = \"$setupDriveLetter\\setup.exe\"\n\t$silentArgs = \"/IACCEPTSQLSERVERLICENSETERMS /Q /ACTION=install /FEATURES=SQLENGINE,FULLTEXT,SSMS,ADV_SSMS /AGTSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /AGTSVCPASSWORD=@@{SQL_CREDS.secret}@@ /SQLSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /SQLSVCPASSWORD=@@{SQL_CREDS.secret}@@ /SQLSYSADMINACCOUNTS=`\"$DOMAINNAME\\Domain Admins`\" /ISSVCACCOUNT=`\"@@{SQL_CREDS.username}@@`\" /ISSVCPASSWORD=@@{SQL_CREDS.secret}@@ /ASSYSADMINACCOUNTS=`\"@@{SQL_CREDS.username}@@`\" /INSTANCEID=MSSQLSERVER /INSTANCENAME=MSSQLSERVER /UPDATEENABLED=True /UPDATESOURCE=`\"C:\\Temp`\" /INDICATEPROGRESS /TCPENABLED=1 /INSTALLSQLDATADIR=`\"F:\\MSSQL`\" /SQLUSERDBLOGDIR=`\"L:\\MSSQL`\" /SQLTEMPDBLOGDIR=`\"T:\\MSSQL`\"\"\n\t$validExitCodes = @(0)\n\n    $install = Start-Process -FilePath $setupPath -ArgumentList $silentArgs -Wait -NoNewWindow -PassThru\n    $install.WaitForExit()\n    $exitCode = $install.ExitCode\n    $install.Dispose()\n    \n    Write-Output \"SQL Failover Cluster Installation exited with `'$exitCode`'.\"\n      if ($validExitCodes -notcontains $exitCode) {\n          Write-Output \"Running [`\"$setupPath`\" $silentArgs] was not successful. Exit code was '$exitCode'. See log for possible error messages.\"\n\t\t  exit 1\n    }\n\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED"}}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Install SQL"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n  $start_time = Get-Date\n\n  $TempDirectory = \"C:\\Temp\"\n  $RktTemp = \"$TempDirectory\\rktools.2003\"\n\n  $url = \"@@{BPG_RKTOOLS_URL}@@\"\n  $filePath = \"$TempDirectory\\rktools.exe\"\n\n  New-Item -ItemType Directory -Force -Path $TempDirectory\n  (New-Object System.Net.WebClient).DownloadFile($url,$filePath)\n\n  & $filePath /Q /T:\"$RktTemp\" /C\n  \n  Start-Sleep 10\n\n  $PackageName = \"rktools.2003\"\n  $setupPath = \"C:\\Windows\\System32\\msiexec.exe\"\n  $silentArgs = \"/i $RktTemp\\rktools.msi /qn\"\n  $validExitCodes = @(0)\n\n  Write-Output \"Installing $PackageName....\"\n\n  $install = Start-Process -FilePath $setupPath -ArgumentList $silentArgs -Wait -NoNewWindow -PassThru\n  $install.WaitForExit()\n\n  $exitCode = $install.ExitCode\n  $install.Dispose()\n\n  Write-Output \"Command [`\"$setupPath`\" $silentArgs] exited with `'$exitCode`'.\"\n  if ($validExitCodes -notcontains $exitCode) {\n  Write-Output \"Running [`\"$setupPath`\" $silentArgs] was not successful. Exit code was '$exitCode'. See log for possible error messages.\"\n  exit 1\n  }\n\n  # OS related tunning\n  # Set Windows Power Options to High Performance\n  powercfg -s 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c\n\n  #Grant Memory privileges to user \n  $ntrights_cli = \"C:\\Program Files (x86)\\Windows Resource Kits\\Tools\\ntrights.exe\"\n  & $ntrights_cli -u \"NT SERVICE\\MSSQLSERVER\" +r SeLockMemoryPrivilege\n  & $ntrights_cli -u \"NT SERVICE\\MSSQLSERVER\" +r SeManageVolumePrivilege\n\n\n  Write-Output \"Time taken: $((Get-Date).Subtract($start_time).seconds) Second(s)\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED"}}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Apply OS BPG"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n  $start_time = Get-Date\n\n  $TempDirectory = \"C:\\Temp\"\n  $sqladdparms_cli = \"$TempDirectory\\Add-SqlServerStartupParameter.ps1\"\n  $TSQLSCRIPTSDIR = \"$TempDirectory\\TSQL_Scripts\"\n  New-Item -ItemType Directory -Force -Path $TSQLSCRIPTSDIR\n  \n  Set-Content -Path \"$sqladdparms_cli\" -Value '\nparam(\n    ## The parameter you wish to add\n    [Parameter(Mandatory = $true)]\n    $StartupParameter\n)\n\n$hklmRootNode = \"HKLM:\\SOFTWARE\\Microsoft\\Microsoft SQL Server\"\n\n$props = Get-ItemProperty \"$hklmRootNode\\Instance Names\\SQL\"\n$instances = $props.psobject.properties | ?{$_.Value -like \"MSSQL*\"} | select Value\n\n$instances | %{\n    $inst = $_.Value;\n    $regKey = \"$hklmRootNode\\$inst\\MSSQLServer\\Parameters\"\n    $props = Get-ItemProperty $regKey\n    $params = $props.psobject.properties | ?{$_.Name -like \"SQLArg*\"} | select Name, Value\n    #$params | ft -AutoSize\n    $hasFlag = $false\n    foreach ($param in $params) {\n        if($param.Value -eq $StartupParameter) {\n            $hasFlag = $true\n            break;\n        }\n    }\n    if (-not $hasFlag) {\n        \"Adding $StartupParameter\"\n        $newRegProp = \"SQLArg\"+($params.Count)\n        Set-ItemProperty -Path $regKey -Name $newRegProp -Value $StartupParameter\n    } else {\n        \"$StartupParameter already set\"\n    }\n}'\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\01-ChangeTempDB.sql\" -Value \"use master`r`n\ngo`r`n\nAlter database tempdb modify file (name = tempdev, filename = 'I:\\TEMPDB01\\tempdb01.mdf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb modify file (name = templog, filename = 'T:\\TempDB-logs01\\templog01.ldf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev02, filename = 'I:\\TEMPDB01\\tempdb02.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev03, filename = 'J:\\TEMPDB02\\tempdb03.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\nAlter database tempdb ADD file (name = tempdev04, filename = 'J:\\TEMPDB02\\tempdb04.ndf', SIZE = 4096, FILEGROWTH=0)`r`n\ngo`r`n\n`r`n\nALTER DATABASE [tempdb] MODIFY FILE (NAME=N'tempdev', NEWNAME=N'tempdev01')`r`n\nGO`r`n\nALTER DATABASE [tempdb] MODIFY FILE (NAME=N'templog', NEWNAME=N'templog01')`r`n\nGO\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\02-IncreaseTempDB_logs.sql\" -Value \"Use master`r`n\ngo`r`n\nALTER DATABASE tempdb MODIFY FILE (NAME = templog01, filename = 'T:\\TempDB-logs01\\templog01.ldf', SIZE`r`n\n= 8096);`r`n\nGO`r`n\nALTER DATABASE tempdb MODIFY FILE (NAME = templog01, FILENAME = 'T:\\TempDB-logs01\\templog01.ldf', SIZE`r`n\n= 12288);`r`n\nGO\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\03-SQL_set_memory.sql\" -Value \"USE master;`r`n\nexec sp_configure 'show advanced options', 1;`r`n\nRECONFIGURE;`r`n\nGO`r`n\nDECLARE `r`n\n        @total_mem decimal (10,0),`r`n\n\t\t@min int,`r`n\n\t\t@max int`r`n\nSELECT `r`n\n   --SELECT (physical_memory_kb/1024) AS Server_Physical_Memory_MB`r`n\n  @total_mem = (physical_memory_kb/1024)`r`n\nFROM sys.dm_os_sys_info`r`n\n`r`n\nset @min = @total_mem * 0.1`r`n\nset @max = @total_mem * 0.85`r`n\nprint @min`r`n\nprint @max`r`n\n--print @total_mem`r`n\n`r`n\n`r`n\nEXEC sp_configure 'min server memory (MB)',@min`r`n\nEXEC sp_configure 'max server memory (MB)',@max`r`n\nRECONFIGURE\"\n\n  Set-Content -Path \"$TSQLSCRIPTSDIR\\04-SQL-ChangeDefaultPaths.sql\" -Value \"USE [master]`r`n\nGO`r`n\n-- Change default location for data files`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'DefaultData',`r`n\nREG_SZ,`r`n\nN'G:\\SQLDATA01'`r`n\nGO`r`n\n-- Change default location for log files`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'DefaultLog',`r`n\nREG_SZ,`r`n\nN'L:\\UserDB-logs01'`r`n\nGO`r`n\n-- Change default location for backups`r`n\nEXEC xp_instance_regwrite`r`n\nN'HKEY_LOCAL_MACHINE',`r`n\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',`r`n\nN'BackupDirectory',`r`n\nREG_SZ,`r`n\nN'R:\\SQLBACK'`r`n\nGO\"\n\n  #create directories\n  mkdir G:\\SQLDATA01\\\n  mkdir H:\\SQLDATA02\\\n  mkdir I:\\TEMPDB01\\\n  mkdir J:\\TEMPDB02\\\n  mkdir L:\\UserDB-logs01\\\n  mkdir T:\\TempDB-logs01\\\n  mkdir R:\\SQLBACK\n\n  #ADD SQL T parameters \n  #T1117 This parameter forces MS SQL Server to grow all database files uniformly\n  #T1118 This parameter forces MS SQL Server to use full extents only\n  & $sqladdparms_cli '-T1117'\n  & $sqladdparms_cli '-T1118'\n  restart-service MSSQL* -force\n\n  #import powershell SQL module\n  import-module \"sqlps\" -DisableNameChecking\n\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\01-ChangeTempDB.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\02-IncreaseTempDB_logs.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\03-SQL_set_memory.sql\"\n  invoke-sqlcmd -hostname localhost -inputFile \"$TSQLSCRIPTSDIR\\04-SQL-ChangeDefaultPaths.sql\"\n\n  #Delete original SQL temp files\n  stop-service MSSQL* \n  Start-Sleep 5\n  rm \"F:\\MSSQL\\MSSQL12.MSSQLSERVER\\MSSQL\\DATA\\temp*\"\n\n  start-service MSSQL* \n  wmic useraccount get sid\n  Write-Output \"Time taken: $((Get-Date).Subtract($start_time).seconds) Second(s)\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED"}}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Apply SQL BPG"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n\n  #Variable for T-SQL command\n  $netbios = \"@@{DOMAIN}@@\".Split(\".\")[0].ToUpper()\n  $createLogin = \"CREATE LOGIN [$netbios\\sqlservice] FROM WINDOWS; \" \n  $grantConnectPermissions = \"GRANT CONNECT ON ENDPOINT::Endpoint_AG TO [$netbios\\sqlservice];\"\n\n  Enable-SqlAlwaysOn -ServerInstance $(hostname) -Force \n  New-SqlHADREndpoint -Path \"SQLSERVER:\\SQL\\$(hostname)\\DEFAULT\" -Name \"Endpoint_AG\" -Port 5022 -EncryptionAlgorithm Aes -Encryption Required \n  Set-SqlHADREndpoint -Path \"SQLSERVER:\\SQL\\$(hostname)\\DEFAULT\\Endpoints\\Endpoint_AG\" -State Started\n  Invoke-SqlCmd -Server $(hostname) -Query $createLogin\n  Invoke-SqlCmd -Server $(hostname) -Query $grantConnectPermissions\n\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED"}}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Enable AAG"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"exit_status": [], "script": "$Script = {\n  if (\"$(Get-ClusterNode | where {$_.Id -eq 1} | select -ExpandProperty Name)\" -ne \"$(hostname)\"){\n      exit\n  }\n  #Import-Module SQLPS -DisableNameCheckin\n  $AGName = '@@{SQL_CLUSTER_NAME}@@'\n  $PrimaryNode = $(hostname)\n  $IP = '@@{MSSQL_VIP}@@/255.255.240.0'\n  $replicas = @()\n\n  $cname = (Get-Cluster -name $PrimaryNode).name\n  $nodes = (get-clusternode -Cluster $cname).name\n  \n  $sqlperms = @\"\nuse [master];\nGRANT ALTER ANY AVAILABILITY GROUP TO [NT AUTHORITY\\SYSTEM];\nGRANT CONNECT SQL TO [NT AUTHORITY\\SYSTEM];\nGRANT VIEW SERVER STATE TO [NT AUTHORITY\\SYSTEM];\n\"@\n\n  foreach($node in $nodes)\n  {\n      Invoke-Sqlcmd -ServerInstance $node -Database master -Query $sqlperms\n      $replicas += New-SqlAvailabilityReplica -Name $node -EndpointUrl \"TCP://$($node):5022\" -AvailabilityMode \"SynchronousCommit\" -FailoverMode \"Automatic\" -AsTemplate -Version 12 \n  }\n\n\n  New-SqlAvailabilityGroup -Name $AGName -Path \"SQLSERVER:\\SQL\\$PrimaryNode\\DEFAULT\" -AvailabilityReplica $replicas\n  $nodes | Where-Object {$_ -ne $PrimaryNode} | ForEach-Object {Join-SqlAvailabilityGroup -path \"SQLSERVER:\\SQL\\$_\\DEFAULT\" -Name $AGName}\n  New-SqlAvailabilityGroupListener -Name $AGName -staticIP $IP -Port 1433 -Path \"SQLSERVER:\\Sql\\$PrimaryNode\\DEFAULT\\AvailabilityGroups\\$AGName\"\n}\n\n$adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"@@{DOMAIN_CRED.secret}@@\"\n$Creds = New-Object System.Management.Automation.PSCredential(\"@@{DOMAIN_CRED.username}@@\",$adminpassword)\n\nInvoke-Command -ComputerName @@{address}@@ -Credential $Creds -ScriptBlock $Script -Authentication Credssp\n", "script_type": "sh", "type": "", "command_line_args": "", "login_credential_local_reference": {"kind": "app_credential", "name": "KARAN_CRED"}}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Create AAG"}, {"target_any_local_reference": {"kind": "app_service", "name": "MSSQL"}, "retries": "0", "description": "", "type": "SET_VARIABLE", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"exit_status": [], "script": "#script\nprint \"EXECUTION_MODE=\"", "eval_variables": ["EXECUTION_MODE"], "eval_scope": "local", "type": "", "script_type": "static"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "DisableLocalMode"}], "description": "", "state": "ACTIVE", "variable_list": [], "message_list": [], "main_task_local_reference": {"kind": "app_task", "name": "ddaf74d2_dag"}, "name": "0561ade3_runbook"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV MSSQL Package"}, "retries": "0", "description": "", "type": "DAG", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "7bf7eecb_dag"}], "description": "", "state": "ACTIVE", "variable_list": [], "message_list": [], "main_task_local_reference": {"kind": "app_task", "name": "7bf7eecb_dag"}, "name": "f564b0c1_runbook"}}, "variable_list": [], "name": "AHV MSSQL Package"}, {"description": "", "action_list": [], "service_local_reference_list": [{"kind": "app_service", "name": "DDC"}], "version": "", "type": "DEB", "options": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package"}, "retries": "0", "description": "", "type": "DAG", "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask"}, {"kind": "app_task", "name": "AddToDomain"}, {"kind": "app_task", "name": "Sleep"}, {"kind": "app_task", "name": "InstallController"}], "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "AddToDomain"}}, {"from_task_reference": {"kind": "app_task", "name": "AddToDomain"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Sleep"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "InstallController"}}], "type": ""}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "7fcb2293_dag"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "PackageInstallTask"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"DDC-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "AddToDomain"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "static", "type": "", "command_line_args": "", "exit_status": [], "script": "#script\nsleep(30)"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Sleep"}, {"target_any_local_reference": {"kind": "app_service", "name": "DDC"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "<#\nInstalls Xendesktop components.\nFirst instance would be installed with CONTROLLER,DESKTOPSTUDIO,LICENSESERVER.\nAnd remaining instances would be installed with CONTROLLER,DESKTOPSTUDIO.\n#>\n\nfunction InstallCitrixComponents{\n        param(\n        [Parameter(Mandatory=$true)][string] $XenDesktopServerSetup,\n        [Parameter(Mandatory=$true)][string] $Components,\n        [Parameter(Mandatory=$false)][string] $Arguements\n    )\n\n    & \"$XenDesktopServerSetup\" /quiet /nosql /configure_firewall /components $Components $Arguements\n\n}\n$DriveLetter = \"D:\"\n$XenDesktopServerSetup = \"$DriveLetter\\x64\\XenDesktop Setup\\XenDesktopServerSetup.exe\"\n\nif (\"@@{calm_array_index}@@\" -eq \"0\"){\n  InstallCitrixComponents $XenDesktopServerSetup \"CONTROLLER,DESKTOPSTUDIO,LICENSESERVER\"\n}\nelse{\n  InstallCitrixComponents $XenDesktopServerSetup \"CONTROLLER,DESKTOPSTUDIO\"\n}\n\n<#\nDownloads and installs nutanix citrix plugin\n#>\n$TempDirectory = \"C:\\Temp\"\nNew-Item -ItemType Directory -Force -Path $TempDirectory\n$NutanixAcropolisPlugin = \"@@{NutanixAcropolisPlugin}@@\"\n$NutanixAcropolisPluginFilePath = \"$TempDirectory\\NutanixAcropolis.msi\"\n$NutanixAcropolisPluginInstallPath = \"@@{NutanixAcropolis_Installed_Path}@@\"\n\nWrite-Output \"Downloading the pulgin\"\ntry{\n  (New-Object System.Net.WebClient).DownloadFile($NutanixAcropolisPlugin,$NutanixAcropolisPluginFilePath)\n  Write-Output \"Pulgin has been downloaded\"\n\n  msiexec /i $NutanixAcropolisPluginFilePath /qn\n  sleep(40)\n  Rename-Item -LiteralPath C:\\[INSTALLFOLDER] -NewName \"NutanixAcropolis\"\n  Move-Item -Path C:\\NutanixAcropolis -Destination \"$NutanixAcropolisPluginInstallPath\"\n\n  & \"C:\\Program Files\\Common Files\\Citrix\\HCLPlugins\\RegisterPlugins.exe\" -PluginsRoot \"C:\\Program Files\\Common Files\\Citrix\\HCLPlugins\\CitrixMachineCreation\\v1.0.0.0\"\n\n  Restart-Service -Name \"Citrix Host Service\"\n  Restart-Service -Name \"Citrix Broker Service\"\n  Restart-Service -Name \"Citrix Machine Creation Service\"\n}\ncatch\n{\n\tWrite-Output \"$_\"\n    exit 1\n}"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "InstallController"}], "description": "", "state": "ACTIVE", "variable_list": [], "message_list": [], "main_task_local_reference": {"kind": "app_task", "name": "7fcb2293_dag"}, "name": "ff975c07_runbook"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV DDC Package"}, "retries": "0", "description": "", "type": "DAG", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "5d9a3914_dag"}], "description": "", "state": "ACTIVE", "variable_list": [], "message_list": [], "main_task_local_reference": {"kind": "app_task", "name": "5d9a3914_dag"}, "name": "086f090e_runbook"}}, "variable_list": [], "name": "AHV DDC Package"}, {"description": "", "action_list": [], "service_local_reference_list": [{"kind": "app_service", "name": "StoreFront"}], "version": "", "type": "DEB", "options": {"install_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package"}, "retries": "0", "description": "", "type": "DAG", "child_tasks_local_reference_list": [{"kind": "app_task", "name": "PackageInstallTask"}, {"kind": "app_task", "name": "AddToDomain"}, {"kind": "app_task", "name": "Sleep"}, {"kind": "app_task", "name": "InstallStoreFront"}], "state": "ACTIVE", "attrs": {"edges": [{"from_task_reference": {"kind": "app_task", "name": "AddToDomain"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "Sleep"}}, {"from_task_reference": {"kind": "app_task", "name": "Sleep"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "InstallStoreFront"}}, {"from_task_reference": {"kind": "app_task", "name": "PackageInstallTask"}, "edge_type": "user_defined", "type": "", "to_task_reference": {"kind": "app_task", "name": "AddToDomain"}}], "type": ""}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "7f665a14_dag"}, {"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "# -*- Pre-requisite to enable credssp and set 'Server' role\nEnable-WSManCredSSP -Role Server -Force\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "PackageInstallTask"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is used to Change hostname of machines and join to domain.\n##############################################\n$HOSTNAME = \"StoreFront-@@{calm_random}@@\"\n\nfunction Set-Hostname{\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$Hostname\n)\n  if ($Hostname -eq  $(hostname)){\n    Write-Host \"Hostname already set.\"\n  } else{\n    Rename-Computer -NewName $HOSTNAME -ErrorAction Stop\n  }\n}\n\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Host \"Not in domain\"\n    $adminname = \"$DomainName\\$Username\"\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Host \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  } else {\n     Write-Host \"Already in domain\"\n  }\n}\n\nif ($HOSTNAME -ne $Null){\n  Write-Host \"Setting Hostname\"\n  Set-Hostname -Hostname $HOSTNAME\n}\n\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{AD_IP}@@\"\n\nRestart-Computer -Force -AsJob\nexit 0\n"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "AddToDomain"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "static", "type": "", "command_line_args": "", "exit_status": [], "script": "#script\nsleep(30)"}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "Sleep"}, {"target_any_local_reference": {"kind": "app_service", "name": "StoreFront"}, "retries": "0", "description": "", "type": "EXEC", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"script_type": "sh", "type": "", "command_line_args": "", "exit_status": [], "script": "<#\nInstalls Xendesktop components.\nAll the instances would be installed with STOREFRONT.\n#>\nfunction InstallCitrixComponents{\n        param(\n        [Parameter(Mandatory=$true)][string] $XenDesktopServerSetup,\n        [Parameter(Mandatory=$true)][string] $Components,\n        [Parameter(Mandatory=$false)][string] $Arguements\n    )\n\n    & \"$XenDesktopServerSetup\" /quiet /nosql /configure_firewall /components $Components $Arguements\n\n}\n$DriveLetter = \"D:\"\n$XenDesktopServerSetup = \"$DriveLetter\\x64\\XenDesktop Setup\\XenDesktopServerSetup.exe\"\n\nInstallCitrixComponents $XenDesktopServerSetup \"STOREFRONT\""}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "InstallStoreFront"}], "description": "", "state": "ACTIVE", "variable_list": [], "message_list": [], "main_task_local_reference": {"kind": "app_task", "name": "7f665a14_dag"}, "name": "113a7553_runbook"}, "type": "", "uninstall_runbook": {"task_definition_list": [{"target_any_local_reference": {"kind": "app_package", "name": "AHV StoreFront Package"}, "retries": "0", "description": "", "type": "DAG", "child_tasks_local_reference_list": [], "state": "ACTIVE", "attrs": {"edges": [], "type": ""}, "timeout_secs": "0", "message_list": [], "variable_list": [], "name": "6f2933d9_dag"}], "description": "", "state": "ACTIVE", "variable_list": [], "message_list": [], "main_task_local_reference": {"kind": "app_task", "name": "6f2933d9_dag"}, "name": "04e28c7a_runbook"}}, "variable_list": [], "name": "AHV StoreFront Package"}], "app_profile_list": [{"deployment_create_list": [{"description": "", "action_list": [], "package_local_reference_list": [{"kind": "app_package", "name": "AHV MSSQL Package"}], "min_replicas": "2", "max_replicas": "2", "substrate_local_reference": {"kind": "app_substrate", "name": "AHV_MSSQL"}, "type": "GREENFIELD", "variable_list": [], "name": "5aed8000_deployment"}, {"description": "", "action_list": [], "package_local_reference_list": [{"kind": "app_package", "name": "AHV DDC Package"}], "min_replicas": "2", "max_replicas": "2", "substrate_local_reference": {"kind": "app_substrate", "name": "AHV_DDC"}, "type": "GREENFIELD", "variable_list": [], "name": "c693df12_deployment"}, {"name": "fc5a5e8b_deployment", "action_list": [], "package_local_reference_list": [{"kind": "app_package", "name": "AHV StoreFront Package"}], "editables": {"min_replicas": true, "max_replicas": true}, "min_replicas": "2", "max_replicas": "2", "substrate_local_reference": {"kind": "app_substrate", "name": "AHV_StoreFront"}, "type": "GREENFIELD", "variable_list": [], "description": ""}], "variable_list": [{"val_type": "STRING", "description": "", "value": "nucalm.com", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "DOMAIN"}, {"val_type": "STRING", "description": "", "value": "10.15.193.31", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "AD_IP"}, {"val_type": "STRING", "description": "", "value": "10.5.67.138", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "PE_IP"}, {"val_type": "STRING", "description": "", "value": "10.5.67.143", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "PE_DATA_SERVICE_IP"}, {"val_type": "STRING", "description": "", "value": "default-container-43360047467620", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "Nutanix_Container_Name"}, {"val_type": "STRING", "description": "", "value": "SQL_VolumeGroup119", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "Volume_GroupName"}, {"val_type": "STRING", "description": "", "value": "NTNX-CLS119", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "FAILOVER_CLUSTER_NAME"}, {"val_type": "STRING", "description": "", "value": "NTNX-SQLCLS119", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "SQL_CLUSTER_NAME"}, {"val_type": "STRING", "description": "", "value": "10.5.64.2", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "FAILOVER_VIP"}, {"val_type": "STRING", "description": "", "value": "10.5.64.3", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "MSSQL_VIP"}, {"val_type": "STRING", "description": "", "value": "http://10.7.1.7/data1/software/Citrix-XD/NutanixAHV-MCS-XD7.9_or_later_1.1.3.0.msi", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "NutanixAcropolisPlugin"}, {"val_type": "STRING", "description": "", "value": "C:\\Program Files\\Common Files\\Citrix\\HCLPlugins\\CitrixMachineCreation\\v1.0.0.0", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "NutanixAcropolis_Installed_Path"}, {"val_type": "STRING", "description": "", "value": "BLR", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "XD_SITE_NAME"}, {"val_type": "STRING", "description": "", "value": "vlan.0", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "CVM_NETWORK"}, {"val_type": "STRING", "description": "", "value": "http://download.microsoft.com/download/8/e/c/8ec3a7d8-05b4-440a-a71e-ca3ee25fe057/rktools.exe", "label": "", "attrs": {"type": ""}, "editables": {"value": true}, "type": "LOCAL", "name": "BPG_RKTOOLS_URL"}], "description": "", "action_list": [], "name": "Nutanix"}], "default_credential_local_reference": {"kind": "app_credential", "name": "LOCAL"}, "type": "USER", "client_attrs": {"DDC": {"y": 80, "x": 600}, "MSSQL": {"y": 80, "x": 340}, "StoreFront": {"y": 80, "x": 860}}}, "name": "Xen Desktop"}, "api_version": "3.0", "metadata": {"last_update_time": "1532670896487342", "creation_time": "1532335971844975", "kind": "blueprint", "spec_version": 17, "name": "Xen Desktop"}}